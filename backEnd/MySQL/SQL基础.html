<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.0" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.2" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://vuepress-theme-hope-docs-demo.netlify.app/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html"><meta property="og:site_name" content="林光远的个人笔记"><meta property="og:title" content="SQL基础"><meta property="og:description" content="将 SQL 关键字书写为大写形式是一个好的编码习惯 SELECT 语法 ```sql SELECT columns_list FROM table_name; ```关键字 SELECT 后跟着一个或多个数据表的列。; columns_list 可以有多个列，他们之间需要用逗号 , 分隔。; 当要检索数据表中的所有列的时候，使用 SELECT *..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="LGYNB"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"SQL基础","image":[""],"dateModified":null,"author":[{"@type":"Person","name":"LGYNB","url":"/"}]}</script><link rel="icon" href="/my_blog/favicon.ico"><title>SQL基础 | 林光远的个人笔记</title><meta name="description" content="将 SQL 关键字书写为大写形式是一个好的编码习惯 SELECT 语法 ```sql SELECT columns_list FROM table_name; ```关键字 SELECT 后跟着一个或多个数据表的列。; columns_list 可以有多个列，他们之间需要用逗号 , 分隔。; 当要检索数据表中的所有列的时候，使用 SELECT *...">
    <link rel="preload" href="/my_blog/assets/style-ERUp4lUP.css" as="style"><link rel="stylesheet" href="/my_blog/assets/style-ERUp4lUP.css">
    <link rel="modulepreload" href="/my_blog/assets/app-OTaO6_y0.js"><link rel="modulepreload" href="/my_blog/assets/SQL基础.html-6URVc54q.js"><link rel="modulepreload" href="/my_blog/assets/SQL基础.html-2Okd7uEs.js"><link rel="modulepreload" href="/my_blog/assets/plugin-vue_export-helper-x3n3nnut.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/my_blog/"><img class="vp-nav-logo" src="/my_blog/logo.png" alt="林光远的个人笔记"><!----><span class="vp-site-name hide-in-pad">林光远的个人笔记</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="后端技术" class="vp-link nav-link active nav-link active" href="/my_blog/backEnd/"><span class="font-icon icon iconfont icon-back-stage" style=""></span>后端技术<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="Web开发" class="vp-link nav-link nav-link" href="/my_blog/webDevelop/"><span class="font-icon icon iconfont icon-config" style=""></span>Web开发<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="AI技术" class="vp-link nav-link nav-link" href="/my_blog/ai/"><span class="font-icon icon iconfont icon-function" style=""></span>AI技术<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="数据结构与算法" class="vp-link nav-link nav-link" href="/my_blog/coding/"><span class="font-icon icon iconfont icon-calculate" style=""></span>数据结构与算法<!----></a></div><div class="nav-item hide-in-mobile"><a aria-label="项目经历" class="vp-link nav-link nav-link" href="/my_blog/projects/"><span class="font-icon icon iconfont icon-code" style=""></span>项目经历<!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/lgy8888/my_blog.git" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" placeholder="搜索本站" autocomplete="off" spellcheck="false" value><!----></form><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-cache" style=""></span><span class="vp-sidebar-title">Redis</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable active" type="button"><span class="font-icon icon iconfont icon-mysql" style=""></span><span class="vp-sidebar-title">MySQL</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><!--[--><a aria-label="SQL基础" class="vp-link nav-link active vp-sidebar-link vp-sidebar-page active nav-link active vp-sidebar-link vp-sidebar-page active" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html"><span class="font-icon icon iconfont icon-write" style=""></span>SQL基础<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="SELECT" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#select"><!---->SELECT<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="特殊用法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#特殊用法"><!---->特殊用法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="虚拟表 dual" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#虚拟表-dual"><!---->虚拟表 dual<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="WHERE" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#where"><!---->WHERE<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-1"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-1"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="比较运算符" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#比较运算符"><!---->比较运算符<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="AND" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#and"><!---->AND<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-2"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="运算规则" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#运算规则"><!---->运算规则<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-2"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="OR" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#or"><!---->OR<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-3"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="运算规则" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#运算规则-1"><!---->运算规则<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-3"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="运算符优先级" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#运算符优先级"><!---->运算符优先级<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="IN" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#in"><!---->IN<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-4"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="运算规则" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#运算规则-2"><!---->运算规则<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-4"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="NOT IN" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#not-in"><!---->NOT IN<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="BETWEEN" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#between"><!---->BETWEEN<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-6"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="运算规则" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#运算规则-4"><!---->运算规则<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-6"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="LIKE" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#like"><!---->LIKE<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-7"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="运算规则" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#运算规则-5"><!---->运算规则<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-7"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="IS NULL" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#is-null"><!---->IS NULL<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-8"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="运算规则" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#运算规则-6"><!---->运算规则<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-8"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="EXISTS" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#exists"><!---->EXISTS<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-9"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-9"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="特殊用法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#特殊用法-1"><!---->特殊用法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="ORDER BY" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#order-by"><!---->ORDER BY<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="用法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#用法"><!---->用法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="排序规则" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#排序规则"><!---->排序规则<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-10"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="自定义排序规则" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#自定义排序规则"><!---->自定义排序规则<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="LIMIT" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#limit"><!---->LIMIT<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-10"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="LIMIT 和 ORDER BY" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#limit-和-order-by"><!---->LIMIT 和 ORDER BY<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-11"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="分页查询" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#分页查询"><!---->分页查询<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="DISTINCT" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#distinct"><!---->DISTINCT<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-11"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-12"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="JOIN" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#join"><!---->JOIN<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="连接类型" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#连接类型"><!---->连接类型<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="交叉连接" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#交叉连接"><!---->交叉连接<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="内连接" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#内连接"><!---->内连接<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="左连接" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#左连接"><!---->左连接<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="右连接" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#右连接"><!---->右连接<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="USING" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#using"><!---->USING<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="GROUP BY" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#group-by"><!---->GROUP BY<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-12"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-13"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="UNION" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#union"><!---->UNION<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-13"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-14"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="别名" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#别名"><!---->别名<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="别名种类" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#别名种类"><!---->别名种类<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="列别名" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#列别名"><!---->列别名<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="表别名" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#表别名"><!---->表别名<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="派生表别名" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#派生表别名"><!---->派生表别名<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="子查询" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#子查询"><!---->子查询<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="子查询和IN" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#子查询和in"><!---->子查询和IN<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="派生表" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#派生表"><!---->派生表<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="INSERT" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#insert"><!---->INSERT<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-14"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="INSERT 修饰符" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#insert-修饰符"><!---->INSERT 修饰符<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="INSERT 限制" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#insert-限制"><!---->INSERT 限制<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="DELETE" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#delete"><!---->DELETE<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="单表删除语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#单表删除语法"><!---->单表删除语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-15"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="DELETE 修饰符" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#delete-修饰符"><!---->DELETE 修饰符<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="UPDATE" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#update"><!---->UPDATE<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-15"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="实例" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#实例-16"><!---->实例<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="UPDATE 修饰符" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#update-修饰符"><!---->UPDATE 修饰符<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="REPLACE" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#replace"><!---->REPLACE<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="语法" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#语法-16"><!---->语法<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="函数" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#函数"><!---->函数<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="数字函数" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#数字函数"><!---->数字函数<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="字符串函数" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#字符串函数"><!---->字符串函数<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="时间函数" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#时间函数"><!---->时间函数<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="IFNULL  |  COALESCE" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#ifnull-coalesce"><!---->IFNULL  |  COALESCE<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="IF 函数" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#if-函数"><!---->IF 函数<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="CASE 运算符" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#case-运算符"><!---->CASE 运算符<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="视图" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#视图"><!---->视图<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="视图的作用" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#视图的作用"><!---->视图的作用<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="使用视图" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#使用视图"><!---->使用视图<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="视图更新" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#视图更新"><!---->视图更新<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="存储过程" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#存储过程"><!---->存储过程<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="触发器" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#触发器"><!---->触发器<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="什么是触发器" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#什么是触发器"><!---->什么是触发器<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="创建触发器" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#创建触发器"><!---->创建触发器<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="删除触发器" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#删除触发器"><!---->删除触发器<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="查看触发器" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#查看触发器"><!---->查看触发器<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="使用触发器记录修改记录" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#使用触发器记录修改记录"><!---->使用触发器记录修改记录<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="事件" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#事件"><!---->事件<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="什么是事件" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#什么是事件"><!---->什么是事件<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="创建事件" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#创建事件"><!---->创建事件<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="操作事件" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#操作事件"><!---->操作事件<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="事务" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#事务"><!---->事务<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="事务的定义" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#事务的定义"><!---->事务的定义<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="事务的操作" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#事务的操作"><!---->事务的操作<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="事务并发" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#事务并发"><!---->事务并发<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="死锁" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#死锁"><!---->死锁<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="主键和外键" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#主键和外键"><!---->主键和外键<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="主键" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#主键"><!---->主键<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="外键" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#外键"><!---->外键<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="操作数据库" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#操作数据库"><!---->操作数据库<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="创建数据库" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#创建数据库"><!---->创建数据库<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="删除数据库" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#删除数据库"><!---->删除数据库<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="选择数据库" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#选择数据库"><!---->选择数据库<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="操作表" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#操作表"><!---->操作表<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="创建表" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#创建表"><!---->创建表<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="删除表" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#删除表"><!---->删除表<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="修改表" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#修改表"><!---->修改表<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="清空表" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#清空表"><!---->清空表<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="表锁" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#表锁"><!---->表锁<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="生成列" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#生成列"><!---->生成列<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="约束" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#约束"><!---->约束<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="UNIQUE" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#unique"><!---->UNIQUE<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="NOT NULL" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#not-null"><!---->NOT NULL<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="CHECK" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#check"><!---->CHECK<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="索引" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#索引"><!---->索引<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="索引基础" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#索引基础"><!---->索引基础<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="操作索引" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#操作索引"><!---->操作索引<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="索引基数" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#索引基数"><!---->索引基数<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="索引顺序" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#索引顺序"><!---->索引顺序<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="唯一索引" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#唯一索引"><!---->唯一索引<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="复合索引" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#复合索引"><!---->复合索引<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="聚集索引" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#聚集索引"><!---->聚集索引<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="字符串前缀索引" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#字符串前缀索引"><!---->字符串前缀索引<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li><li class="vp-sidebar-sub-header"><a aria-label="数据库管理" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#数据库管理"><!---->数据库管理<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="启动/停止" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#启动-停止"><!---->启动/停止<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="用户管理" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#用户管理"><!---->用户管理<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="权限管理" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#权限管理"><!---->权限管理<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="维护数据库" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#维护数据库"><!---->维护数据库<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="备份数据库" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#备份数据库"><!---->备份数据库<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="恢复数据库" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/my_blog/backEnd/MySQL/SQL%E5%9F%BA%E7%A1%80.html#恢复数据库"><!---->恢复数据库<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a aria-label="SQL原理" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/my_blog/backEnd/MySQL/SQL%E5%8E%9F%E7%90%86.html"><span class="font-icon icon iconfont icon-write" style=""></span>SQL原理<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="数据类型" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/my_blog/backEnd/MySQL/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B.html"><span class="font-icon icon iconfont icon-write" style=""></span>数据类型<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="数据库设计" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/my_blog/backEnd/MySQL/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1.html"><span class="font-icon icon iconfont icon-write" style=""></span>数据库设计<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="逻辑架构" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/my_blog/backEnd/MySQL/%E9%80%BB%E8%BE%91%E6%9E%B6%E6%9E%84.html"><span class="font-icon icon iconfont icon-write" style=""></span>逻辑架构<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="存储引擎" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/my_blog/backEnd/MySQL/%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E.html"><span class="font-icon icon iconfont icon-write" style=""></span>存储引擎<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="索引" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/my_blog/backEnd/MySQL/%E7%B4%A2%E5%BC%95.html"><span class="font-icon icon iconfont icon-write" style=""></span>索引<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="事务" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/my_blog/backEnd/MySQL/%E4%BA%8B%E5%8A%A1.html"><span class="font-icon icon iconfont icon-write" style=""></span>事务<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="日志" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/my_blog/backEnd/MySQL/%E6%97%A5%E5%BF%97.html"><span class="font-icon icon iconfont icon-write" style=""></span>日志<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="锁" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/my_blog/backEnd/MySQL/%E9%94%81.html"><span class="font-icon icon iconfont icon-write" style=""></span>锁<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="性能调优" class="vp-link nav-link vp-sidebar-link vp-sidebar-page nav-link vp-sidebar-link vp-sidebar-page" href="/my_blog/backEnd/MySQL/%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98.html"><span class="font-icon icon iconfont icon-write" style=""></span>性能调优<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-java" style=""></span><span class="vp-sidebar-title">Java</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-OS" style=""></span><span class="vp-sidebar-title">OS</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->SQL基础</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="/" target="_blank" rel="noopener noreferrer">LGYNB</a></span><span property="author" content="LGYNB"></span></span><!----><!----><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 98 分钟</span><meta property="timeRequired" content="PT98M"></span><!----><!----></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#select">SELECT</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例">实例</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#特殊用法">特殊用法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#虚拟表-dual">虚拟表 dual</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#where">WHERE</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-1">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-1">实例</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#比较运算符">比较运算符</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#and">AND</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-2">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#运算规则">运算规则</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-2">实例</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#or">OR</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-3">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#运算规则-1">运算规则</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-3">实例</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#运算符优先级">运算符优先级</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#in">IN</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-4">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#运算规则-2">运算规则</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-4">实例</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#not-in">NOT IN</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#between">BETWEEN</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-6">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#运算规则-4">运算规则</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-6">实例</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#like">LIKE</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-7">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#运算规则-5">运算规则</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-7">实例</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#is-null">IS NULL</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-8">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#运算规则-6">运算规则</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-8">实例</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#exists">EXISTS</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-9">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-9">实例</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#特殊用法-1">特殊用法</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#order-by">ORDER BY</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#用法">用法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#排序规则">排序规则</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-10">实例</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#自定义排序规则">自定义排序规则</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#limit">LIMIT</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-10">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#limit-和-order-by">LIMIT 和 ORDER BY</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-11">实例</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#分页查询">分页查询</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#distinct">DISTINCT</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-11">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-12">实例</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#join">JOIN</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#连接类型">连接类型</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#交叉连接">交叉连接</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#内连接">内连接</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#左连接">左连接</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#右连接">右连接</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#using">USING</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#group-by">GROUP BY</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-12">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-13">实例</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#union">UNION</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-13">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-14">实例</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#别名">别名</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#别名种类">别名种类</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#列别名">列别名</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#表别名">表别名</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#派生表别名">派生表别名</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#子查询">子查询</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#子查询和in">子查询和IN</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#派生表">派生表</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#insert">INSERT</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-14">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#insert-修饰符">INSERT 修饰符</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#insert-限制">INSERT 限制</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#delete">DELETE</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#单表删除语法">单表删除语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-15">实例</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#delete-修饰符">DELETE 修饰符</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#update">UPDATE</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-15">语法</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#实例-16">实例</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#update-修饰符">UPDATE 修饰符</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#replace">REPLACE</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#语法-16">语法</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#函数">函数</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#数字函数">数字函数</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#字符串函数">字符串函数</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#时间函数">时间函数</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#ifnull-coalesce">IFNULL  |  COALESCE</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#if-函数">IF 函数</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#case-运算符">CASE 运算符</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#视图">视图</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#视图的作用">视图的作用</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#使用视图">使用视图</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#视图更新">视图更新</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#存储过程">存储过程</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#触发器">触发器</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#什么是触发器">什么是触发器</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#创建触发器">创建触发器</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#删除触发器">删除触发器</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#查看触发器">查看触发器</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#使用触发器记录修改记录">使用触发器记录修改记录</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#事件">事件</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#什么是事件">什么是事件</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#创建事件">创建事件</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#操作事件">操作事件</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#事务">事务</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#事务的定义">事务的定义</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#事务的操作">事务的操作</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#事务并发">事务并发</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#死锁">死锁</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#主键和外键">主键和外键</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#主键">主键</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#外键">外键</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#操作数据库">操作数据库</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#创建数据库">创建数据库</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#删除数据库">删除数据库</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#选择数据库">选择数据库</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#操作表">操作表</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#创建表">创建表</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#删除表">删除表</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#修改表">修改表</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#清空表">清空表</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#表锁">表锁</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#生成列">生成列</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#约束">约束</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#unique">UNIQUE</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#not-null">NOT NULL</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#check">CHECK</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#索引">索引</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#索引基础">索引基础</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#操作索引">操作索引</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#索引基数">索引基数</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#索引顺序">索引顺序</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#唯一索引">唯一索引</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#复合索引">复合索引</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#聚集索引">聚集索引</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#字符串前缀索引">字符串前缀索引</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="#数据库管理">数据库管理</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#启动-停止">启动/停止</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#用户管理">用户管理</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#权限管理">权限管理</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#维护数据库">维护数据库</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#备份数据库">备份数据库</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="#恢复数据库">恢复数据库</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h1 id="sql基础" tabindex="-1"><a class="header-anchor" href="#sql基础" aria-hidden="true">#</a> SQL基础</h1><blockquote><p>将 SQL 关键字书写为<u>大写</u>形式是一个好的编码习惯</p></blockquote><h2 id="select" tabindex="-1"><a class="header-anchor" href="#select" aria-hidden="true">#</a> SELECT</h2><h3 id="语法" tabindex="-1"><a class="header-anchor" href="#语法" aria-hidden="true">#</a> 语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> 
	columns_list
<span class="token keyword">FROM</span> 
	table_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>关键字 <code>SELECT</code> 后跟着<strong>一个或多个数据表的列</strong>。</li><li><code>columns_list</code> 可以有<strong>多个列</strong>，他们之间需要<strong>用逗号</strong> <code>,</code> 分隔。</li><li>当要检索数据表中的<strong>所有列</strong>的时候，使用 <code>SELECT * FROM table_name</code> 。</li><li>关键字 <code>FROM</code> <strong>后跟</strong>着要从中检索数据的<strong>表名</strong>。</li><li>分号 <code>;</code> 表示语句的结束，它是可选的。如果有两条或更多条语句，则需要使用分号 <code>;</code> 将它们分开，以便 MySQL 单独执行每条语句</li></ul><ul><li><code>SELECT</code> 语句的正确语义应是 <code>FROM table_name SELECT columns_list</code>，即：从某个表检索某几列数据。MySQL 解析 <code>SELECT</code> 语句的时候，会首先评估 <code>FROM</code> 子句，再评估 <code>SELECT</code> 子句。</li></ul><blockquote><p><strong><code>SELECT *</code> 与 <code>SELECT column_name</code> 有什么区别呢？</strong></p></blockquote><p>就一般而言，两者的性能差不多。就区别而言，有如下不同：</p><ol><li>写出明确的字段，更容易理解你的 SQL 的查询意图</li><li>某些大字段不适合直接查询出来，因为直接查询会占用更多的开销</li><li><code>SELECT *</code> 更适合在命令行或者测试场景下使用</li></ol><h3 id="实例" tabindex="-1"><a class="header-anchor" href="#实例" aria-hidden="true">#</a> 实例</h3><p><strong>使用 SELECT 语句查询一个字段</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    last_name
<span class="token keyword">FROM</span>
    actor<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>使用 SELECT 语句查询多个字段</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    first_name<span class="token punctuation">,</span> last_name
<span class="token keyword">FROM</span>
    actor<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>使用 SELECT 语句查询所有字段</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    <span class="token operator">*</span>
<span class="token keyword">FROM</span>
    actor
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="特殊用法" tabindex="-1"><a class="header-anchor" href="#特殊用法" aria-hidden="true">#</a> 特殊用法</h3><blockquote><p>没有FROM的SELECT</p></blockquote><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> expression_list
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><p><strong>查询系统时间</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code>+---------------------+
| NOW()               |
+---------------------+
| 2021-09-07 22:45:33 |
+---------------------+
1 row in set (0.00 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>数值计算</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token number">1</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code>+-----+
| 1+2 |
+-----+
|   3 |
+-----+
1 row in set (0.00 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="虚拟表-dual" tabindex="-1"><a class="header-anchor" href="#虚拟表-dual" aria-hidden="true">#</a> 虚拟表 dual</h3><p>没有 <code>FROM</code> 子句的情况，可以添加一个虚拟表 <code>dual</code>。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> dual<span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token number">1</span><span class="token operator">+</span><span class="token number">2</span> <span class="token keyword">FROM</span> dual<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>运算结果和上面完全相同。</p><p><code>dual</code> 表是一个虚拟表，完全可以忽略。它**<u>存在的目的只是让你的 SQL 看起来更加工整</u>**。</p><h2 id="where" tabindex="-1"><a class="header-anchor" href="#where" aria-hidden="true">#</a> WHERE</h2><h3 id="语法-1" tabindex="-1"><a class="header-anchor" href="#语法-1" aria-hidden="true">#</a> 语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    columns_list
<span class="token keyword">FROM</span>
    table_name
<span class="token keyword">WHERE</span>
    query_condition<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>query_condition</code> 就是<strong>查询条件</strong>，它的<strong>结果是一个布尔值</strong>，其值可能为 <code>TRUE</code>， <code>FALSE</code> 或 <code>UNKNOWN</code>。</p><ul><li>查询条件一般用来比较某个字段是否匹配某个值，一般形式如下：</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>column_name <span class="token operator">=</span> <span class="token keyword">value</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>查询条件也可以是使用 <code>AND</code> , <code>OR</code> 和 <code>NOT</code> <strong>逻辑运算符一个或多个表达式的组合</strong>。</li><li>除了用在 <code>SELECT</code> 语句之外， <code>WHERE</code> 子句还可以用在 <code>UPDATE</code> 和 <code>DELETE</code>语句中，用来<strong>指定要更新或删除的行</strong>。</li></ul></li><li><p><code>SELECT</code> 语句<strong>返回的结果集就是满足查询条件结果为 <code>TRUE</code> 的记录</strong>。</p></li></ul><h3 id="实例-1" tabindex="-1"><a class="header-anchor" href="#实例-1" aria-hidden="true">#</a> 实例</h3><p><strong>使用相等比较运算</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    <span class="token operator">*</span>
<span class="token keyword">FROM</span>
    actor
<span class="token keyword">WHERE</span>
    last_name <span class="token operator">=</span> <span class="token string">&#39;ALLEN&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>使用 AND 组合多个条件查询</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    <span class="token operator">*</span>
<span class="token keyword">FROM</span>
    actor
<span class="token keyword">WHERE</span>
    last_name <span class="token operator">=</span> <span class="token string">&#39;DAVIS&#39;</span> <span class="token operator">AND</span> first_name <span class="token operator">=</span> <span class="token string">&#39;SUSAN&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>在这个语句中，查询条件 <code>last_name = &#39;DAVIS&#39; AND first_name = &#39;SUSAN&#39;</code> 的意思是过滤表中 <code>last_name</code> 字段的值为 <code>DAVIS</code>，并且 <code>first_name</code> 字段的值为 <code>SUSAN</code> 的所有记录行。</p></li><li><p><code>last_name = &#39;DAVIS&#39;</code> 是一个条件，<code>first_name = &#39;SUSAN&#39;</code> 也是一个条件，<code>AND</code> 将两者组合在一起，意思是查询的记录行要同时满足这两个条件。</p></li><li><p><code>AND</code> 两边的条件表达式，必须<strong>两个表达式都返回了 <code>TRUE</code>，整个表达式的结果才是 <code>TRUE</code></strong>。</p></li></ul><p><strong>使用 OR 组合多个查询条件</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    <span class="token operator">*</span>
<span class="token keyword">FROM</span>
    actor
<span class="token keyword">WHERE</span>
    last_name <span class="token operator">=</span> <span class="token string">&#39;ALLEN&#39;</span> <span class="token operator">OR</span> last_name <span class="token operator">=</span> <span class="token string">&#39;DAVIS&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>在这个语句中，查询条件 <code>last_name = &#39;ALLEN&#39; OR last_name = &#39;DAVIS&#39;</code> 代表了表中记录行的 <code>last_name</code> 字段的记录值等于 <code>ALLEN</code> 或者 <code>DAVIS</code>。</p></li><li><p><code>OR</code> 两边的条件表达式，<strong>只要一个表达式返回了 <code>TRUE</code>，整个表达式的结果就是 <code>TRUE</code></strong>。</p></li></ul><h3 id="比较运算符" tabindex="-1"><a class="header-anchor" href="#比较运算符" aria-hidden="true">#</a> 比较运算符</h3><blockquote><p>可用于WHERE子句的比较运算符</p></blockquote><table><thead><tr><th>比较运算符</th><th>说明</th><th>举例</th></tr></thead><tbody><tr><td>=</td><td>等于</td><td>age = 18</td></tr><tr><td>&lt;&gt;</td><td>不等于</td><td>age &lt;&gt; 18</td></tr><tr><td>!=</td><td>不等于</td><td>age != 18</td></tr><tr><td>&lt;=&gt;</td><td>结合了=和IS，可用于具体值匹配或NULL值匹配</td><td>age &lt;=&gt; NULL<br>age &lt;=&gt; 18</td></tr><tr><td>&gt;</td><td>大于，通常用于比较数字或者日期</td><td>age &gt; 18</td></tr><tr><td>&gt;=</td><td>大于等于，通常用于比较数字或者和日期</td><td>age &gt;= 18</td></tr><tr><td>&lt;</td><td>小于，通常用于比较数字或者日期</td><td>age &lt; 18</td></tr><tr><td>&lt;=</td><td>小于等于，通常用于比较数字或者日期</td><td>age &lt;= 18</td></tr><tr><td>IN</td><td>判断值是否在一个集合中</td><td>age IN (18, 19)</td></tr><tr><td>NOT IN</td><td>判断值是否不在一个集合中</td><td>age NOT IN (18, 19)</td></tr><tr><td>BWTWEEN ·· AND</td><td>判断值是否介于两数之间</td><td>age BETWEEN 16 AND 18</td></tr><tr><td>LIKE</td><td>模糊匹配</td><td>name LIKE &#39;A%&#39;</td></tr><tr><td>IS NULL</td><td>是否为NULL</td><td>name IS NULL</td></tr><tr><td>IS NOT NULL</td><td>是否不为NULL</td><td>name IS NOT NULL</td></tr></tbody></table><h2 id="and" tabindex="-1"><a class="header-anchor" href="#and" aria-hidden="true">#</a> AND</h2><h3 id="语法-2" tabindex="-1"><a class="header-anchor" href="#语法-2" aria-hidden="true">#</a> 语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>a <span class="token operator">AND</span> b
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><code>AND</code> 运算符是一个双目逻辑运算符，用来组合两个操作数。</li><li>只有当两个操作数都为真时，结果才返回真，否则返回假或者 <code>NULL</code></li><li><code>a</code> 和 <code>b</code> 是 <code>AND</code> 的两个操作数，可以是表达式，也可以是值</li></ul><h3 id="运算规则" tabindex="-1"><a class="header-anchor" href="#运算规则" aria-hidden="true">#</a> 运算规则</h3><ul><li>如果两个操作数都不为 <code>0</code> (<code>FALSE</code>) 并且不为 <code>NULL</code> 时，则 <code>AND</code> 运算的结果为 <code>1</code>。</li><li>如果有一个操作数为 <code>0</code> (<code>FALSE</code>)，则 <code>AND</code> 运算的结果为 <code>0</code>。</li><li>如果两个操作数中有一个为 <code>NULL</code>，且另一个不为 <code>0</code> (<code>FALSE</code>)，则返回 <code>NULL</code>。</li><li>两个操作数的前后顺序不影响 <code>AND</code> 操作符的运算结果。</li></ul><table><thead><tr><th></th><th><strong>1</strong></th><th><strong>0</strong></th><th><strong>NULL</strong></th></tr></thead><tbody><tr><td><strong>1</strong></td><td>1</td><td>0</td><td>NULL</td></tr><tr><td><strong>0</strong></td><td>0</td><td>0</td><td>0</td></tr><tr><td><strong>NULL</strong></td><td>NULL</td><td>0</td><td>NULL</td></tr></tbody></table><h3 id="实例-2" tabindex="-1"><a class="header-anchor" href="#实例-2" aria-hidden="true">#</a> 实例</h3><p>在 <code>WHERE</code> 子句中， <code>AND</code> 连接两个比较条件。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    columns_list
<span class="token keyword">FROM</span>
    table_name
<span class="token keyword">WHERE</span>
    query_condition <span class="token operator">AND</span> query_condition<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>WHERE</code> 子句中的 <code>AND</code> 过滤那些同时满足两个比较条件的记录行。</li><li>也就是说，如果数据表中的记录行，必须同时满足两个条件，才是符合条件的记录行</li></ul><h2 id="or" tabindex="-1"><a class="header-anchor" href="#or" aria-hidden="true">#</a> OR</h2><h3 id="语法-3" tabindex="-1"><a class="header-anchor" href="#语法-3" aria-hidden="true">#</a> 语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>a <span class="token operator">OR</span> b
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><code>OR</code> 运算符是一个双目逻辑运算符，用来组合两个操作数。</li><li>只要两个操作数中的一个为真时，结果就返回真，否则返回假或者 <code>NULL</code>。</li><li>其中，<code>a</code> 和 <code>b</code> 是 <code>OR</code> 的两个操作数，可以是表达式，也可以是值。</li></ul><h3 id="运算规则-1" tabindex="-1"><a class="header-anchor" href="#运算规则-1" aria-hidden="true">#</a> 运算规则</h3><ul><li>如果两个操作数中至少一个操作数为 <code>1</code> (<code>TURE</code>)，则 <code>OR</code> 运算的结果为 <code>1</code>。</li><li>如果两个操作数都为 <code>0</code> (<code>FALSE</code>)，则 <code>OR</code> 运算的结果为 <code>0</code>。</li><li>如果两个操作数有一个为 <code>NULL</code>，另一个为 <code>0</code> (<code>FALSE</code>) 或者 <code>NULL</code>，则 <code>OR</code> 运算的结果为 <code>NULL</code>。</li><li>两个操作数的前后顺序不影响 <code>OR</code> 操作符的运算结果。</li></ul><table><thead><tr><th></th><th><strong>1</strong></th><th><strong>0</strong></th><th><strong>NULL</strong></th></tr></thead><tbody><tr><td><strong>1</strong></td><td>1</td><td>1</td><td>1</td></tr><tr><td><strong>0</strong></td><td>1</td><td>0</td><td>NULL</td></tr><tr><td><strong>NULL</strong></td><td>1</td><td>NULL</td><td>NULL</td></tr></tbody></table><h3 id="实例-3" tabindex="-1"><a class="header-anchor" href="#实例-3" aria-hidden="true">#</a> 实例</h3><p>在 <code>WHERE</code> 子句中， <code>AND</code> 连接两个比较条件。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    columns_list
<span class="token keyword">FROM</span>
    table_name
<span class="token keyword">WHERE</span>
    query_condition <span class="token operator">OR</span> query_condition<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>WHERE</code> 子句中的 <code>OR</code> 过滤那些的记录行，它们只需要满足两个比较条件中的其中一个即可。</li><li>也就是说，如果数据表中的记录行，只要满足一个条件，就是符合条件的记录行</li></ul><h3 id="运算符优先级" tabindex="-1"><a class="header-anchor" href="#运算符优先级" aria-hidden="true">#</a> 运算符优先级</h3><p>当组合表达式同时包含 <code>AND</code> 和 <code>OR</code> 运算符时，MySQL 使用运算符优先级来确定运算符的计算顺序。</p><p>MySQL 首先运算具有更高优先级的运算符。</p><p>由于 <strong><code>AND</code> 运算符的优先级高于 <code>OR</code> 运算符</strong>，因此 MySQL 在 <code>AND</code> 运算符之前评估 <code>OR</code> 运算符。</p><p>可以用括号来改变优先级</p><h2 id="in" tabindex="-1"><a class="header-anchor" href="#in" aria-hidden="true">#</a> IN</h2><h3 id="语法-4" tabindex="-1"><a class="header-anchor" href="#语法-4" aria-hidden="true">#</a> 语法</h3><p><code>IN</code> 是一个双目运算符，它需要 2 个操作数</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>expression <span class="token operator">IN</span> <span class="token punctuation">(</span>value1<span class="token punctuation">,</span> value2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><code>expression</code> 可以是一个字段名、值或其他的表达式（比如函数调用、运算等）。</li><li><code>(value1, value2, ...)</code> 是一个值列表，多个值之间使用 <code>,</code> 分隔，并使用小括号 <code>()</code> 将它们包围起来。</li><li><code>value1</code> 是具体的值，比如：<code>1</code>, <code>2</code>, <code>&#39;A&#39;</code>, <code>&#39;B&#39;</code> 等。</li><li><code>(value1, value2, ...)</code> 最少可以是 1 个值，比如 <code>(1)</code>, <code>(&#39;A&#39;)</code>。</li></ul><h3 id="运算规则-2" tabindex="-1"><a class="header-anchor" href="#运算规则-2" aria-hidden="true">#</a> 运算规则</h3><p><code>IN</code> 运算符当左侧的操作数的值是右侧操作数集合列表中的其中一个时， <code>IN</code> 运算符返回 <code>1</code>。否则 返回 <code>0</code>。</p><ul><li>当左侧和右侧都不是 <code>NULL</code> 时，右侧值列表中包含左侧的值时返回 <code>1</code>，否则返回 <code>0</code>。</li><li>当左侧操作数为 <code>NULL</code>，返回 <code>NULL</code>。</li><li>当右侧值列表含有 <code>NULL</code>，如果包括左侧的非 NULL 值，返回 <code>1</code>，否则返回 <code>NULL</code></li></ul><h3 id="实例-4" tabindex="-1"><a class="header-anchor" href="#实例-4" aria-hidden="true">#</a> 实例</h3><p>在实际开发中，我们会在 <code>SELECT</code>、<code>UPDATE</code>、<code>DELETE</code> 语句中的 WHERE 子句中使用 <code>IN</code> 运算符。</p><p>在 <code>IN</code> 运算符中，除了与值列表比较，还可能与子查询进行比较。</p><p>使用 <code>WHERE</code> 子句查找姓氏为 <code>ALLEN</code> 或 <code>DAVIS</code> 的所有演员</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    <span class="token operator">*</span>
<span class="token keyword">FROM</span>
    actor
<span class="token keyword">WHERE</span>
    last_name <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">&#39;ALLEN&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;DAVIS&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="not-in" tabindex="-1"><a class="header-anchor" href="#not-in" aria-hidden="true">#</a> NOT IN</h3><h4 id="语法-5" tabindex="-1"><a class="header-anchor" href="#语法-5" aria-hidden="true">#</a> 语法</h4><p>只是在 <code>IN</code> 前面添加一个 <code>NOT</code> 关键字，<code>IN</code> 的否定操作符</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>expression <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span>value1<span class="token punctuation">,</span> value2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><code>NOT</code> 是一个否定逻辑运算符。</li><li><code>expression</code> 可以是一个字段名、值或其他的表达式（比如函数调用、运算等）。</li><li><code>(value1, value2, ...)</code> 是一个值列表，多个值之间使用 <code>,</code> 分隔，并使用小括号 <code>()</code> 将它们包围起来。</li><li><code>value1</code> 是具体的值，比如：<code>1</code>, <code>2</code>, <code>&#39;A&#39;</code>, <code>&#39;B&#39;</code> 等。</li><li><code>(value1, value2, ...)</code> 最少可以是 1 个值，比如 <code>(1)</code>, <code>(&#39;A&#39;)</code>。</li></ul><h4 id="运算规则-3" tabindex="-1"><a class="header-anchor" href="#运算规则-3" aria-hidden="true">#</a> 运算规则</h4><p><code>NOT IN</code> 检查一个字段或值是否不包含于一个值列表中，如果值不包含在值列表中，返回 <code>1</code>，否则返回 <code>0</code></p><ul><li>当左侧和右侧都没有 <code>NULL</code> 时，右侧值列表不包含左侧的值时返回 <code>1</code>，否则返回 <code>0</code></li><li>当左侧操作数为 <code>NULL</code>，返回 <code>NULL</code></li><li>当右侧值列表含有 <code>NULL</code>，如果包含左侧的非 NULL 值，返回 <code>0</code>，否则返回 <code>NULL</code></li></ul><h4 id="实例-5" tabindex="-1"><a class="header-anchor" href="#实例-5" aria-hidden="true">#</a> 实例</h4><p>在实际开发中，我们会在 <code>SELECT</code>、<code>UPDATE</code>、<code>DELETE</code> 语句中的 WHERE 子句中使用 <code>NOT IN</code> 运算符。在 <code>NOT IN</code> 运算符中，除了与值列表比较，还可能与子查询进行比较。</p><p>查询使用 <code>WHERE</code> 子句查找不是 <code>French</code> 或 <code>German</code> 的所有影片的语言信息。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token keyword">language</span> <span class="token keyword">WHERE</span> name <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token string">&#39;French&#39;</span> <span class="token punctuation">,</span> <span class="token string">&#39;German&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="between" tabindex="-1"><a class="header-anchor" href="#between" aria-hidden="true">#</a> BETWEEN</h2><h3 id="语法-6" tabindex="-1"><a class="header-anchor" href="#语法-6" aria-hidden="true">#</a> 语法</h3><p><code>BETWEEN</code> 运算符是一个三目运算符，它需要 3 个操作数。下面 <code>BETWEEN</code> 运算符的语法：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>expression <span class="token operator">BETWEEN</span> min <span class="token operator">AND</span> max
expression <span class="token operator">NOT</span> <span class="token operator">BETWEEN</span> min <span class="token operator">AND</span> max
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>expression</code> 可以是一个<strong>字段名、值或其他的表达式</strong>（比如函数调用、运算等）。</li><li><code>min</code> 是范围的<strong>最小值（包含）</strong>。</li><li><code>max</code> 是范围的<strong>最大值（包含）</strong>。</li><li><code>AND</code> 是一个固定的<strong>连接词</strong>，用来连接 <code>min</code> 和 <code>max</code>。</li><li><code>NOT</code> 是<strong>否定运算符</strong>，<code>NOT BETWEEN</code> 表达的含义与 <code>BETWEEN</code> 相反。</li></ul><h3 id="运算规则-4" tabindex="-1"><a class="header-anchor" href="#运算规则-4" aria-hidden="true">#</a> 运算规则</h3><p>当字段的值或者给定的值介于 <code>min</code> 和 <code>max</code> 两个值之间时，<code>BETWEEN</code> 运算符返回 <code>1</code>。否则，返回 <code>0</code>。</p><ul><li>如果左侧的 <code>expression</code> 介于 <code>min</code> 和 <code>max</code> 之间时， <code>BETWEEN</code> 返回 <code>1</code>，否则返回 <code>0</code>。</li><li>如果 <code>expression</code>, <code>min</code>, <code>max</code> 至少有一个 <code>NULL</code> 时， <code>BETWEEN</code> 运算符的返回 <code>NULL</code>。</li></ul><h3 id="实例-6" tabindex="-1"><a class="header-anchor" href="#实例-6" aria-hidden="true">#</a> 实例</h3><p><code>BETWEEN</code> 运算符常用于数字和日期类型的数据之间的比较</p><p>使用 <code>BETWEEN</code> 运算符检索影片赔偿价格介于 <code>1</code> 和 <code>10</code> 之间的影片</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    film_id<span class="token punctuation">,</span> title<span class="token punctuation">,</span> replacement_cost
<span class="token keyword">FROM</span>
    film
<span class="token keyword">WHERE</span>
    replacement_cost <span class="token operator">BETWEEN</span> <span class="token number">1</span> <span class="token operator">AND</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 <code>BETWEEN</code> 运算符检索影片赔偿价格不介于 <code>1</code> 和 <code>10</code> 之间的影片：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    film_id<span class="token punctuation">,</span> title<span class="token punctuation">,</span> replacement_cost
<span class="token keyword">FROM</span>
    film
<span class="token keyword">WHERE</span>
    replacement_cost <span class="token operator">NOT</span> <span class="token operator">BETWEEN</span> <span class="token number">10</span> <span class="token operator">AND</span> <span class="token number">50</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="like" tabindex="-1"><a class="header-anchor" href="#like" aria-hidden="true">#</a> LIKE</h2><h3 id="语法-7" tabindex="-1"><a class="header-anchor" href="#语法-7" aria-hidden="true">#</a> 语法</h3><p><code>LIKE</code> 运算符是一个双目比较运算符，需要两个操作数。 <code>LIKE</code> 运算符语法如下：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>expression <span class="token operator">LIKE</span> pattern
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><code>expression</code> 可以是一个<strong>字段名、值或其他的表达式</strong>（比如函数调用、运算等）。</li><li><code>pattern</code>是一个<strong>字符串模式</strong>。MySQL 字符串模式支持<strong>两个通配符</strong>： <code>%</code> 和 <code>_</code><ul><li><code>%</code> 匹配零或多个任意字符。</li><li><code>_</code> 匹配单个任意字符。</li><li>如果需要匹配通配符，则需要使用 <code>\</code> 转义字符，如 <code>\%</code> 和 <code>\_</code>。</li><li>使用通配符匹配文本时，不区分字母大小写。</li></ul></li><li>如果 <code>expression</code> 与 <code>pattern</code> 匹配，<code>LIKE</code> 运算符返回 <code>1</code>，否则返回 <code>0</code>。</li></ul><blockquote><p><strong>pattern示例</strong></p></blockquote><ul><li><code>a%</code> 匹配以字符 <code>a</code> 开头的任意长度的字符串。</li><li><code>%a</code> 匹配以字符 <code>a</code> 结尾的任意长度的字符串。</li><li><code>%a%</code> 匹配包含字符 <code>a</code> 的任意长度的字符串。</li><li><code>%a%b%</code> 匹配同时包含字符 <code>a</code> 和 <code>b</code> 且 <code>a</code> 在 <code>b</code> 前面的任意长度的字符串。</li><li><code>a_</code> 匹配以字符 <code>a</code> 开头长度为 2 字符串。</li><li><code>_a</code> 匹配以字符 <code>a</code> 结尾长度为 2 字符串。</li></ul><h3 id="运算规则-5" tabindex="-1"><a class="header-anchor" href="#运算规则-5" aria-hidden="true">#</a> 运算规则</h3><ul><li>当 <code>LIKE</code> 运算符左侧的操作数与右侧的模式匹配时，返回 <code>1</code>。否则，返回 <code>0</code>。</li><li>如果 <code>LIKE</code> 运算符的两个操作数中任意一个为 NULL 时，返回 NULL。</li></ul><h3 id="实例-7" tabindex="-1"><a class="header-anchor" href="#实例-7" aria-hidden="true">#</a> 实例</h3><p>在实际开发中，我们会在 <code>SELECT</code>、<code>UPDATE</code>、<code>DELETE</code> 语句中的 WHERE 子句中使用 <code>LIKE</code> 运算符。</p><p>使用 <code>LIKE</code> 运算符匹配 <code>first_name</code> 以字符 <code>P</code> 开头的所有演员。比如： <code>PARKER</code>。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> actor <span class="token keyword">WHERE</span> first_name <span class="token operator">LIKE</span> <span class="token string">&#39;P%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>使用 <code>NOT</code> 运算符与 <code>LIKE</code> 运算符从 <code>category</code> 表中检索那些名字不以 <code>A</code> 开头的分类。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> category <span class="token keyword">WHERE</span> name <span class="token operator">NOT</span> <span class="token operator">LIKE</span> <span class="token string">&#39;A%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="is-null" tabindex="-1"><a class="header-anchor" href="#is-null" aria-hidden="true">#</a> IS NULL</h2><h3 id="语法-8" tabindex="-1"><a class="header-anchor" href="#语法-8" aria-hidden="true">#</a> 语法</h3><p><code>IS NULL</code> 是一个单目比较运算符，只需要一个操作数。<code>IS NULL</code> 运算符的语法是：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>expression <span class="token operator">IS</span> <span class="token boolean">NULL</span>
expression <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>expression</code> 可以是一<strong>个字段名、一个值或者一个表达式</strong>。</li><li><code>IS NOT NULL</code> 是 <code>IS NULL</code> 的否定运算。</li></ul><p><code>IS NULL</code> 和 <code>IS NOT NULL</code> 可以用在 <code>SELECT</code>子句或者 <code>WHERE</code>子句中。</p><h3 id="运算规则-6" tabindex="-1"><a class="header-anchor" href="#运算规则-6" aria-hidden="true">#</a> 运算规则</h3><ul><li>当 <code>IS NULL</code> 运算符左侧的操作数是 <code>NULL</code> 时，<code>IS NULL</code> 运算符返回 <code>1</code>，否则返回 <code>0</code>。</li><li><code>IS NOT NULL</code> 是 <code>IS NULL</code> 的否定运算 <ul><li>如果 <code>IS NOT NULL</code> 左侧的操作数不是 <code>NULL</code> 时，<code>IS NOT NULL</code> 运算符返回 <code>1</code>，否则返回 <code>0</code></li></ul></li></ul><h3 id="实例-8" tabindex="-1"><a class="header-anchor" href="#实例-8" aria-hidden="true">#</a> 实例</h3><p>使用 <code>IS NULL</code> 查询 <code>staff</code> 表中的那些没有设置密码的职员。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    first_name<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> password
<span class="token keyword">FROM</span>
    staff
<span class="token keyword">WHERE</span>
    password <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>查询 <code>staff</code> 表中的那些设置了密码的职员</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    first_name<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> password
<span class="token keyword">FROM</span>
    staff
<span class="token keyword">WHERE</span>
    password <span class="token operator">IS</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="exists" tabindex="-1"><a class="header-anchor" href="#exists" aria-hidden="true">#</a> EXISTS</h2><h3 id="语法-9" tabindex="-1"><a class="header-anchor" href="#语法-9" aria-hidden="true">#</a> 语法</h3><p><code>EXISTS</code> 操作符是一个单目操作符，它需要一个子查询作为参数。<code>EXISTS</code> 操作符的语法如下：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name
<span class="token keyword">FROM</span> table_name
<span class="token keyword">WHERE</span> <span class="token keyword">EXISTS</span><span class="token punctuation">(</span>subquery<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>EXISTS</code> 一般用在 <code>WHERE</code> 子句中。</li><li><code>EXISTS</code> 是一个单目操作符，它需要一个<strong>子查询</strong> <code>subquery</code> <strong>作为参数</strong>。</li><li>如果子查询 <code>subquery</code> <strong>返回了至少一个数据行，则 <code>EXISTS</code> 的计算结果为 <code>TRUE</code>，否则计算结果为 <code>FALSE</code></strong>。</li><li><code>EXISTS</code> 运算时，一旦子查询找到一个匹配的行，<code>EXISTS</code> 运算就会返回。这对提高查询性能很有帮助。</li><li><code>EXISTS</code> <strong>不关心子查询中的列的数量或者名称，它只在乎子查询是否返回数据行</strong><ul><li>所以在 <code>EXISTS</code> 的子查询中，无论你是使用 <code>SELECT 1</code> 还是 <code>SELECT *</code>，亦或是 <code>SELECT column_list</code>，都不影响 <code>EXISTS</code> 运算的结果。</li></ul></li><li><code>NOT EXISTS</code> 则是 <code>EXISTS</code> 的否定操作。</li></ul><h3 id="实例-9" tabindex="-1"><a class="header-anchor" href="#实例-9" aria-hidden="true">#</a> 实例</h3><p>查询 <code>language</code> 表的一些语种，该语种在 <code>film</code> 表中存在相关语种的影片</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> <span class="token keyword">language</span>
<span class="token keyword">WHERE</span> <span class="token keyword">EXISTS</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span>
    <span class="token keyword">FROM</span> film
    <span class="token keyword">WHERE</span> film<span class="token punctuation">.</span>language_id <span class="token operator">=</span> <span class="token keyword">language</span><span class="token punctuation">.</span>language_id
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>在 <code>WHERE</code> 子句中使用了 <code>EXISTS</code> 操作符。</li><li>在 <code>EXISTS</code> 的子查询中，从 <code>film</code> 表中检索记录，检索的条件是 <code>film.language_id = language.language_id</code>。</li><li>在检索 <code>language</code> 表的每一行时，只要 <code>film</code> 表存在一行数据具有相同的 <code>language_id</code>， <code>EXISTS</code> 就返回 <code>TRUE</code>。然后进入 <code>language</code> 表的下一行，直到所有行都检索完成，然后返回 <code>language</code> 表中所有匹配成功的行。</li></ul><p>检索了 <code>language</code> 表中的没有影片的行。这只是对上例中 <code>EXISTS</code> 的否定操作，只需要使用 <code>NOT EXISTS</code> 即可</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> <span class="token keyword">language</span>
<span class="token keyword">WHERE</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span>
    <span class="token keyword">FROM</span> film
    <span class="token keyword">WHERE</span> film<span class="token punctuation">.</span>language_id <span class="token operator">=</span> <span class="token keyword">language</span><span class="token punctuation">.</span>language_id
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="特殊用法-1" tabindex="-1"><a class="header-anchor" href="#特殊用法-1" aria-hidden="true">#</a> 特殊用法</h3><h4 id="exists-和-in" tabindex="-1"><a class="header-anchor" href="#exists-和-in" aria-hidden="true">#</a> EXISTS 和 IN</h4><p>有时候 <code>EXISTS</code> 可以使用 <code>IN</code> 来实现。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> <span class="token keyword">language</span>
<span class="token keyword">WHERE</span> <span class="token keyword">EXISTS</span><span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token operator">*</span>
    <span class="token keyword">FROM</span> film
    <span class="token keyword">WHERE</span> film<span class="token punctuation">.</span>language_id <span class="token operator">=</span> <span class="token keyword">language</span><span class="token punctuation">.</span>language_id
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>对应的 <code>IN</code> 操作符的版本是：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> <span class="token keyword">language</span>
<span class="token keyword">WHERE</span> language_id <span class="token operator">IN</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> language_id
    <span class="token keyword">FROM</span> film
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>大多数情况下，使用 <code>EXISTS</code> 的语句的性能比对应的使用 <code>IN</code> 的语句要好。</li></ul><h4 id="table" tabindex="-1"><a class="header-anchor" href="#table" aria-hidden="true">#</a> TABLE</h4><p>在 MySQL 8.0.19 和以后的版本中，我们可以直接在 <code>EXISTS</code> 或 <code>NOT EXISTS</code> 的子查询中使用 <code>TABLE</code> 语句</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column1 <span class="token keyword">FROM</span> t1 <span class="token keyword">WHERE</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span><span class="token keyword">TABLE</span> t2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这相当于在子查询使用不带任何条件的 <code>SELECT *</code>。等同于如下的语句：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column1 <span class="token keyword">FROM</span> t1 <span class="token keyword">WHERE</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> t2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="order-by" tabindex="-1"><a class="header-anchor" href="#order-by" aria-hidden="true">#</a> ORDER BY</h2><h3 id="用法" tabindex="-1"><a class="header-anchor" href="#用法" aria-hidden="true">#</a> 用法</h3><p>在 <code>ORDER BY</code> 子句中，我们可以指定一个或多个排序的字段</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
   column1<span class="token punctuation">,</span> column2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">FROM</span>
   table_name
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> clause<span class="token punctuation">]</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
   column1 <span class="token punctuation">[</span><span class="token keyword">ASC</span><span class="token operator">|</span><span class="token keyword">DESC</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   column2 <span class="token punctuation">[</span><span class="token keyword">ASC</span><span class="token operator">|</span><span class="token keyword">DESC</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>ORDER BY</code> 子句可以<strong>指定一个或多个字段</strong>。</p></li><li><p><code>[ASC|DESC]</code> 代表排序是<strong>升序还是降序</strong>，这是可选的。</p><ul><li><code>ASC</code> 代表升序，<code>DESC</code> 代表降序。</li><li>未指定 <code>[ASC|DESC]</code> 时，默认值是 <code>ASC</code>。即，默认是按指定的字段升序排序。</li></ul></li><li><p>当指定多个列时，<strong>首先按照前面的字段排序，其次按照后面的字段排序</strong>。</p></li><li><p>在 MySQL 中的<strong>升序排序中， <code>NULL</code> 值出现在非 NULL 值之前</strong>。</p></li><li><p>反之，<strong>降序排序中， <code>NULL</code> 值出现在非 NULL 值之后</strong>。</p></li></ul><h3 id="排序规则" tabindex="-1"><a class="header-anchor" href="#排序规则" aria-hidden="true">#</a> 排序规则</h3><ul><li><code>ORDER BY column ASC;</code><ul><li>此 <code>ORDER BY</code> 子句对结果集按 <code>column</code> 字段的值升序排序。</li></ul></li><li><code>ORDER BY column DESC;</code><ul><li>此 <code>ORDER BY</code> 子句对结果集按 <code>column</code> 字段的值降序排序。</li></ul></li><li><code>ORDER BY column;</code><ul><li>此 <code>ORDER BY</code> 子句对结果集按 <code>column</code> 字段的值升序排序。这个语句等效于： <code>ORDER BY column ASC;</code>。</li></ul></li><li><code>ORDER BY column1, column2;</code><ul><li>此 <code>ORDER BY</code> 子句对结果集先按 <code>column1</code> 字段的值升序排序，然后再按 <code>column2</code> 字段的值升序排序。</li><li>也就是说主排序按 <code>column1</code> 字段升序排序，在主排序的基础上，对 <code>column1</code> 字段相同的行，再按 <code>column2</code> 字段升序排序。</li></ul></li><li><code>ORDER BY column1 DESC, column2;</code><ul><li>此 <code>ORDER BY</code> 子句对结果集先按 <code>column1</code> 字段的值降序排序，然后再按按 <code>column2</code> 字段的值升序排序。</li><li>也就是说主排序按 <code>column1</code> 字段降序排序，在主排序的基础上，对 <code>column1</code> 字段相同的行，再按 <code>column2</code> 字段升序排序。</li></ul></li></ul><h3 id="实例-10" tabindex="-1"><a class="header-anchor" href="#实例-10" aria-hidden="true">#</a> 实例</h3><p>使用 <code>ORDER BY</code> 子句按演员姓氏升序进行排序。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    actor_id<span class="token punctuation">,</span> first_name<span class="token punctuation">,</span> last_name
<span class="token keyword">FROM</span>
    actor
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> last_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 <code>ORDER BY</code> 子句按演员姓氏降序进行排序。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    actor_id<span class="token punctuation">,</span> first_name<span class="token punctuation">,</span> last_name
<span class="token keyword">FROM</span>
    actor
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> last_name <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用 <code>ORDER BY</code> 子句先按演员姓氏升序排序，再按演员名字升序排序。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    actor_id<span class="token punctuation">,</span> first_name<span class="token punctuation">,</span> last_name
<span class="token keyword">FROM</span>
    actor
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> last_name<span class="token punctuation">,</span> first_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="自定义排序规则" tabindex="-1"><a class="header-anchor" href="#自定义排序规则" aria-hidden="true">#</a> 自定义排序规则</h3><p>按照电影分级 <code>&#39;G&#39;, &#39;PG&#39;, &#39;PG-13&#39;, &#39;R&#39;, &#39;NC-17&#39;</code> 的顺序对影片进行排序。</p><p>对于这样的需求，它可以理解为按照列表中元素的索引位置进行排序。我们分别使用 <code>CASE</code> 子句或 <code>FIELD()</code> 函数实现它。</p><p>假设您要根据影片的等级按照的 <code>&#39;G&#39;, &#39;PG&#39;, &#39;PG-13&#39;, &#39;R&#39;, &#39;NC-17&#39;</code> 顺序对影片进行排序。</p><h4 id="case" tabindex="-1"><a class="header-anchor" href="#case" aria-hidden="true">#</a> CASE</h4><div class="language-SQL line-numbers-mode" data-ext="SQL"><pre class="language-SQL"><code>SELECT
    film_id, title, rating
FROM
    film
ORDER BY CASE rating
    WHEN &#39;G&#39; THEN 1
    WHEN &#39;PG&#39; THEN 2
    WHEN &#39;PG-13&#39; THEN 3
    WHEN &#39;R&#39; THEN 4
    WHEN &#39;NC-17&#39; THEN 5
END;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>使用 <code>CASE</code> 将电影的等级转换为一个索引数字。</li><li>然后使用 <code>ORDER BY</code> 按照这个数字进行排序。</li></ul><h4 id="field" tabindex="-1"><a class="header-anchor" href="#field" aria-hidden="true">#</a> FIELD()</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    <span class="token operator">*</span>
<span class="token keyword">FROM</span>
    film
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> FIELD<span class="token punctuation">(</span>rating<span class="token punctuation">,</span> <span class="token string">&#39;G&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;PG&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;PG-13&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;R&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;NC-17&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>输出结果与上面实例完全相同。</p></li><li><p>使用 <code>FIELD(rating, &#39;G&#39;, &#39;PG&#39;, &#39;PG-13&#39;, &#39;R&#39;, &#39;NC-17&#39;)</code> 作为 <code>ORDER BY</code> 排序的表达式。</p><ul><li>其中 <code>FIELD(value, value1, value2, ...)</code> 函数返回 <code>value</code> 在 <code>value1, value2, ...</code> 列表中的位置</li></ul></li></ul><h2 id="limit" tabindex="-1"><a class="header-anchor" href="#limit" aria-hidden="true">#</a> LIMIT</h2><h3 id="语法-10" tabindex="-1"><a class="header-anchor" href="#语法-10" aria-hidden="true">#</a> 语法</h3><p>该 <code>LIMIT</code> 子句可用于限制 <code>SELECT</code> 语句返回的行数。 <code>LIMIT</code> 接受一个或两个非负数正数作为参数。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">LIMIT</span> <span class="token punctuation">[</span><span class="token keyword">offset</span><span class="token punctuation">,</span><span class="token punctuation">]</span> row_count<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><p><code>offset</code> 指定要<strong>返回的第一行的偏移量</strong></p><ul><li>偏移量是相对于未使用 <code>LIMIT</code> 语句时的原始结果集而言的</li><li><code>offset</code> 可理解为在原始结果集的基础上跳过的行数。</li><li><code>offset</code> 是可选的。当未指定 <code>offset</code> 时，默认的值 <code>offset</code> 为 <code>0</code>。</li></ul></li><li><p><code>row_count</code> 执行要返回的<strong>最大行数</strong>。</p></li><li><p><code>LIMIT</code> 一般位于 <code>SELECT</code> 语句的最后。</p></li></ul><p>例如：</p><ul><li><code>LIMIT 5</code><ul><li>(0, 5]，返回5个结果集</li></ul></li><li><code>LIMIT 2 5</code><ul><li>(2, 5]，返回第3个到第5个结果集</li></ul></li></ul><h3 id="limit-和-order-by" tabindex="-1"><a class="header-anchor" href="#limit-和-order-by" aria-hidden="true">#</a> LIMIT 和 ORDER BY</h3><p><code>LIMIT</code> 子句和 <code>ORDER BY</code> 子句的 SQL 语句</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    select_expression<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">FROM</span>
    table_name
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
    sort_expression<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">LIMIT</span> left_side right_side<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在此 <code>SELECT</code> 语句中， MySQL 会先按照 <code>ORDER BY</code> 指定的规则对排序结果集，再返回 <code>LIMIT</code> 子句指定的行数返回结果集。</p><h3 id="实例-11" tabindex="-1"><a class="header-anchor" href="#实例-11" aria-hidden="true">#</a> 实例</h3><p>返回 <code>film</code> 表中等级为 G 的片长最长的 10 部影片</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    film_id<span class="token punctuation">,</span> title<span class="token punctuation">,</span> length
<span class="token keyword">FROM</span>
    film
<span class="token keyword">WHERE</span>
    rating <span class="token operator">=</span> <span class="token string">&#39;G&#39;</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> length <span class="token keyword">DESC</span>
<span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>返回 <code>film</code> 表中等级为 <code>G</code> 的片长最短的 10 部影片</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
    film_id<span class="token punctuation">,</span> title<span class="token punctuation">,</span> length
<span class="token keyword">FROM</span>
    film
<span class="token keyword">WHERE</span>
    rating <span class="token operator">=</span> <span class="token string">&#39;G&#39;</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> length
<span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="分页查询" tabindex="-1"><a class="header-anchor" href="#分页查询" aria-hidden="true">#</a> 分页查询</h3><p>LIMIT 的一个很重要的应用就是分页查询。对于一些大型的数据表来说，分页查询能很好的减少数据库的消耗和提高用户体验。</p><p><code>film</code> 表中共有 1000 行数据，这个我们可以通过以下的 <code>COUNT(*)</code> 查询得知。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> film<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----------+</span>
<span class="token operator">|</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------+</span>
<span class="token operator">|</span>     <span class="token number">1000</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果没有分页查询，所有数据都显示在页面上，会引入以下的问题：</p><ul><li>增加数据库的性能消耗</li><li>传输过程中的数据量增加</li><li>用户的体验不好，太多的数据对让用户眼花缭乱。</li></ul><p>如果我们引入分页，每页显示 10 行数据，那么 1000 行数据需要 100 (<code>1000 / 10</code>) 页就能显示完全。</p><p>查询第一个页只需限制最多行数为 10 行数据即可</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> film_id<span class="token punctuation">,</span> title <span class="token keyword">FROM</span> film <span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="distinct" tabindex="-1"><a class="header-anchor" href="#distinct" aria-hidden="true">#</a> DISTINCT</h2><h3 id="语法-11" tabindex="-1"><a class="header-anchor" href="#语法-11" aria-hidden="true">#</a> 语法</h3><blockquote><p>DISTINCT认为所有的NULL都是一样的</p></blockquote><p>在 <code>SELECT</code> 语句中使用 <code>DISTINCT</code> 关键字会返回一个没有重复记录行的结果集</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span>
    columns_list
<span class="token keyword">FROM</span>
    table_name
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>DISTINCT</code> 关键字位于 <code>SELECT</code> 关键字的后面。</li><li><code>columns_list</code> 指定要查询的字段列表，也是 <code>DISTINCT</code> <strong>评估记录行是否唯一的字段</strong>。 <ul><li><code>columns_list</code> 可以是一个字段，也可以是多个字段。</li><li><code>columns_list</code> 也可以是 <code>*</code>。</li></ul></li></ul><h3 id="实例-12" tabindex="-1"><a class="header-anchor" href="#实例-12" aria-hidden="true">#</a> 实例</h3><p><strong>DISTINCT 单个字段</strong></p><p>使用 <code>SELECT</code> 语句检索 <code>actor</code> 表中的姓氏</p><ul><li>返回的是<code>actor</code>表中的唯一姓氏表</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> last_name <span class="token keyword">FROM</span> actor<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>姓氏可以重复，名字也可以重复，检索 <code>actor</code> 表中的名字和姓氏</p><ul><li>检索出名字和姓氏组合之后的唯一值 <ul><li>例如：留下 AB 和 AC，AB 和 AB 被筛掉</li></ul></li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">DISTINCT</span> last_name<span class="token punctuation">,</span> first_name <span class="token keyword">FROM</span> actor<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>检索actor中重名的人，并返回改名字下有几个人</p></blockquote><div class="language-SQL line-numbers-mode" data-ext="SQL"><pre class="language-SQL"><code>SELECT last_name, first_name, COUNT(*)
FROM acotr
GROUP BY last_name, first_name
HAVING COUNT(*) &gt; 1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>+-----------+------------+----------+
<span class="token operator">|</span> last_name <span class="token operator">|</span> first_name <span class="token operator">|</span> COUNT<span class="token punctuation">(</span>*<span class="token punctuation">)</span> <span class="token operator">|</span>
+-----------+------------+----------+
<span class="token operator">|</span> DAVIS     <span class="token operator">|</span> SUSAN      <span class="token operator">|</span>        <span class="token number">2</span> <span class="token operator">|</span>
+-----------+------------+----------+
<span class="token number">1</span> row <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="join" tabindex="-1"><a class="header-anchor" href="#join" aria-hidden="true">#</a> JOIN</h2><h3 id="连接类型" tabindex="-1"><a class="header-anchor" href="#连接类型" aria-hidden="true">#</a> 连接类型</h3><p>MySQL 支持以下类型的连接：</p><ul><li>内部联接 (<code>INNER JOIN</code>)</li><li>左连接 (<code>LEFT JOIN</code>)</li><li>右连接 (<code>RIGHT JOIN</code>)</li><li>交叉连接 (<code>CROSS JOIN</code>)</li></ul><blockquote><p>MySQL 目前不支持全连接 <code>FULL OUTER JOIN</code></p></blockquote><h3 id="交叉连接" tabindex="-1"><a class="header-anchor" href="#交叉连接" aria-hidden="true">#</a> 交叉连接</h3><p>交叉连接返回两个集合的笛卡尔积。也就是两个表中的所有的行的所有可能的组合。</p><p>这相当于内连接没有连接条件或者连接条件永远为真。</p><p>如果一个有 <code>m</code> 行的表和另一个有 <code>n</code> 行的表，它们交叉连接将返回 <code>m * n</code> 行数据。</p><p>**显式的交叉连接 **</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  student<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
  student_score<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span>
  student <span class="token keyword">CROSS</span> <span class="token keyword">JOIN</span> student_score<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>隐式的交叉连接</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  student<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
  student_score<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span>
  student<span class="token punctuation">,</span> student_score<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>输出</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>+------------+------+------------+---------+-------+
<span class="token operator">|</span> student_id <span class="token operator">|</span> name <span class="token operator">|</span> student_id <span class="token operator">|</span> subject <span class="token operator">|</span> score <span class="token operator">|</span>
+------------+------+------------+---------+-------+
<span class="token operator">|</span>          <span class="token number">3</span> <span class="token operator">|</span> Lucy <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> English <span class="token operator">|</span>    <span class="token number">90</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> Jim  <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> English <span class="token operator">|</span>    <span class="token number">90</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> Tim  <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> English <span class="token operator">|</span>    <span class="token number">90</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">3</span> <span class="token operator">|</span> Lucy <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> Math    <span class="token operator">|</span>    <span class="token number">80</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> Jim  <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> Math    <span class="token operator">|</span>    <span class="token number">80</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> Tim  <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> Math    <span class="token operator">|</span>    <span class="token number">80</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">3</span> <span class="token operator">|</span> Lucy <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> English <span class="token operator">|</span>    <span class="token number">85</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> Jim  <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> English <span class="token operator">|</span>    <span class="token number">85</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> Tim  <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> English <span class="token operator">|</span>    <span class="token number">85</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">3</span> <span class="token operator">|</span> Lucy <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> Math    <span class="token operator">|</span>    <span class="token number">88</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> Jim  <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> Math    <span class="token operator">|</span>    <span class="token number">88</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> Tim  <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> Math    <span class="token operator">|</span>    <span class="token number">88</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">3</span> <span class="token operator">|</span> Lucy <span class="token operator">|</span>          <span class="token number">5</span> <span class="token operator">|</span> English <span class="token operator">|</span>    <span class="token number">92</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> Jim  <span class="token operator">|</span>          <span class="token number">5</span> <span class="token operator">|</span> English <span class="token operator">|</span>    <span class="token number">92</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> Tim  <span class="token operator">|</span>          <span class="token number">5</span> <span class="token operator">|</span> English <span class="token operator">|</span>    <span class="token number">92</span> <span class="token operator">|</span>
+------------+------+------------+---------+-------+
<span class="token number">15</span> rows <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="内连接" tabindex="-1"><a class="header-anchor" href="#内连接" aria-hidden="true">#</a> 内连接</h3><figure><img src="http://lgy-markdown-img.oss-cn-guangzhou.aliyuncs.com/image/inner-join.png" alt="表示 A 表和 B 表之间的内连接的维恩图" tabindex="0" loading="lazy"><figcaption>表示 A 表和 B 表之间的内连接的维恩图</figcaption></figure><p>内连接基于连接条件组合两个表中的数据。</p><p>内连接相当于加了过滤条件的交叉连接。</p><p>内连接将<strong>第一个表的每一行与第二个表的每一行进行比较，如果满足给定的连接条件，则将两个表的行组合在一起作为结果集中的一行</strong>。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  student<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
  student_score<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span>
  student
  <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> student_score
  <span class="token keyword">ON</span> student<span class="token punctuation">.</span>student_id <span class="token operator">=</span> student_score<span class="token punctuation">.</span>student_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  student<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
  student_score<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span>
  student<span class="token punctuation">,</span> student_score
  <span class="token keyword">WHERE</span> student<span class="token punctuation">.</span>student_id <span class="token operator">=</span> student_score<span class="token punctuation">.</span>student_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>输出</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>+------------+------+------------+---------+-------+
<span class="token operator">|</span> student_id <span class="token operator">|</span> name <span class="token operator">|</span> student_id <span class="token operator">|</span> subject <span class="token operator">|</span> score <span class="token operator">|</span>
+------------+------+------------+---------+-------+
<span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> Tim  <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> English <span class="token operator">|</span>    <span class="token number">90</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> Tim  <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> Math    <span class="token operator">|</span>    <span class="token number">80</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> Jim  <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> English <span class="token operator">|</span>    <span class="token number">85</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> Jim  <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> Math    <span class="token operator">|</span>    <span class="token number">88</span> <span class="token operator">|</span>
+------------+------+------------+---------+-------+
<span class="token number">4</span> rows <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="左连接" tabindex="-1"><a class="header-anchor" href="#左连接" aria-hidden="true">#</a> 左连接</h3><figure><img src="http://lgy-markdown-img.oss-cn-guangzhou.aliyuncs.com/image/left-join.png" alt="表示 A 表和 B 表之间的左连接的维恩图" tabindex="0" loading="lazy"><figcaption>表示 A 表和 B 表之间的左连接的维恩图</figcaption></figure><p>左连接是左外连接的简称，左连接需要连接条件。</p><p>两个表左连接时，<strong>第一个表称为左表</strong>，第二表称为右表。例如 <code>A LEFT JOIN B</code>，<code>A</code> 是左表，<code>B</code> 是右表。</p><p>左连接<strong>以左表的数据行为基础，根据连接匹配右表的每一行</strong></p><ul><li>如果匹配成功则将左表和右表的行组合成新的数据行返回；</li><li>如果匹配不成功则将左表的行和 NULL 值组合成新的数据行返回</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  student<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
  student_score<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span>
  student
  <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> student_score
  <span class="token keyword">ON</span> student<span class="token punctuation">.</span>student_id <span class="token operator">=</span> student_score<span class="token punctuation">.</span>student_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>输出</strong></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>+------------+------+------------+---------+-------+
<span class="token operator">|</span> student_id <span class="token operator">|</span> name <span class="token operator">|</span> student_id <span class="token operator">|</span> subject <span class="token operator">|</span> score <span class="token operator">|</span>
+------------+------+------------+---------+-------+
<span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> Tim  <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> Math    <span class="token operator">|</span>    <span class="token number">80</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> Tim  <span class="token operator">|</span>          <span class="token number">1</span> <span class="token operator">|</span> English <span class="token operator">|</span>    <span class="token number">90</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> Jim  <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> Math    <span class="token operator">|</span>    <span class="token number">88</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> Jim  <span class="token operator">|</span>          <span class="token number">2</span> <span class="token operator">|</span> English <span class="token operator">|</span>    <span class="token number">85</span> <span class="token operator">|</span>
<span class="token operator">|</span>          <span class="token number">3</span> <span class="token operator">|</span> Lucy <span class="token operator">|</span>       NULL <span class="token operator">|</span> NULL    <span class="token operator">|</span>  NULL <span class="token operator">|</span>
+------------+------+------------+---------+-------+
<span class="token number">5</span> rows <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>结果集中包含了 <code>student</code> 表的所有记录行。</li><li><code>student_score</code> 表中不包含 <code>student_id = 3</code> 的记录行，因此结果几种最后一行中来自 <code>student_score</code> 的列的内容为 <code>NULL</code>。</li><li><code>student_score</code> 表存在多条 <code>student_id</code> 为 <code>1</code> 和 <code>2</code> 的记录，因此 <code>student</code> 表也产生了多行数据。</li></ol><h3 id="右连接" tabindex="-1"><a class="header-anchor" href="#右连接" aria-hidden="true">#</a> 右连接</h3><figure><img src="http://lgy-markdown-img.oss-cn-guangzhou.aliyuncs.com/image/right-join.png" alt="表示 A 表和 B 表之间的右连接的维恩图" tabindex="0" loading="lazy"><figcaption>表示 A 表和 B 表之间的右连接的维恩图</figcaption></figure><p>右连接是右外连接的简称，右连接需要连接条件。</p><p>右连接与左连接处理逻辑相反，右连接以右表的数据行为基础，根据条件匹配左表中的数据。如果匹配不到左表中的数据，则左表中的列为 <code>NULL</code> 值。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  student<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
  student_score<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span>
  student
  <span class="token keyword">RIGHT</span> <span class="token keyword">JOIN</span> student_score
  <span class="token keyword">ON</span> student<span class="token punctuation">.</span>student_id <span class="token operator">=</span> student_score<span class="token punctuation">.</span>student_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>右连接其实是左右表交换位置的左连接</strong>，即 <code>A RIGHT JOIN B</code> 就是 <code>B LEFT JOIN A</code>，因此<strong>右连接很少使用</strong>。</p><p>右连接可以转换为下面的左连接：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  student<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
  student_score<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span>
  student_score
  <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> student
  <span class="token keyword">ON</span> student<span class="token punctuation">.</span>student_id <span class="token operator">=</span> student_score<span class="token punctuation">.</span>student_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>输出</strong></p><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code>+------------+------+------------+---------+-------+
| student_id | name | student_id | subject | score |
+------------+------+------------+---------+-------+
|          1 | Tim  |          1 | English |    90 |
|          1 | Tim  |          1 | Math    |    80 |
|          2 | Jim  |          2 | English |    85 |
|          2 | Jim  |          2 | Math    |    88 |
|       NULL | NULL |          5 | English |    92 |
+------------+------+------------+---------+-------+
5 rows in set (0.00 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="using" tabindex="-1"><a class="header-anchor" href="#using" aria-hidden="true">#</a> USING</h3><p>如果两个表之间是等值连接，可以使用USING关键字来替换连接条件</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  student<span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">,</span>
  student_score<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span>
  student
  <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> student_score <span class="token keyword">USING</span><span class="token punctuation">(</span>student_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="group-by" tabindex="-1"><a class="header-anchor" href="#group-by" aria-hidden="true">#</a> GROUP BY</h2><h3 id="语法-12" tabindex="-1"><a class="header-anchor" href="#语法-12" aria-hidden="true">#</a> 语法</h3><p><code>GROUP BY</code> 子句是 <code>SELECT</code>语句的可选子句。 <code>GROUP BY</code> 子句语法如下：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column1<span class="token punctuation">[</span><span class="token punctuation">,</span> column2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> aggregate_function<span class="token punctuation">(</span>ci<span class="token punctuation">)</span>
<span class="token keyword">FROM</span> <span class="token keyword">table</span>
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> clause<span class="token punctuation">]</span>
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> column1<span class="token punctuation">[</span><span class="token punctuation">,</span> column2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token keyword">HAVING</span> clause<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>column1[, column2, ...]</code> 是<strong>分组依据的字段</strong>，至少一个字段，可以多个字段。</li><li><code>aggregate_function(ci)</code> 是<strong>聚合函数</strong>。这是可选的，但是一般都用得到。</li><li><strong><code>SELECT</code> 后的字段必须是分组字段中的字段</strong>。</li><li><code>WHERE</code> 子句是可选的，用来<strong>过滤结果集中的数据</strong>。</li><li><code>HAVING</code> 子句是可选的，用来<strong>过滤分组数据</strong>。</li></ul><p>经常使用的聚合函数主要有：</p><ul><li><code>SUM()</code>: 求总和</li><li><code>AVG()</code>: 求平均值</li><li><code>MAX()</code>: 求最大值</li><li><code>MIN()</code>: 求最小值</li><li><code>COUNT()</code>: 计数</li></ul><h3 id="实例-13" tabindex="-1"><a class="header-anchor" href="#实例-13" aria-hidden="true">#</a> 实例</h3><p><strong>GROUP BY 与聚合函数实例</strong></p><p>查看 <code>actor</code> 表中的姓氏列表以及每个姓氏的次数。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> last_name<span class="token punctuation">,</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span>
<span class="token keyword">FROM</span> actor
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> last_name
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token function">COUNT</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>+--------------+----------+
<span class="token operator">|</span> last_name    <span class="token operator">|</span> COUNT<span class="token punctuation">(</span>*<span class="token punctuation">)</span> <span class="token operator">|</span>
+--------------+----------+
<span class="token operator">|</span> KILMER       <span class="token operator">|</span>        <span class="token number">5</span> <span class="token operator">|</span>
<span class="token operator">|</span> NOLTE        <span class="token operator">|</span>        <span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">|</span> TEMPLE       <span class="token operator">|</span>        <span class="token number">4</span> <span class="token operator">|</span>
<span class="token operator">|</span> AKROYD       <span class="token operator">|</span>        <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> ALLEN        <span class="token operator">|</span>        <span class="token number">3</span> <span class="token operator">|</span>
<span class="token operator">|</span> BERRY        <span class="token operator">|</span>        <span class="token number">3</span> <span class="token operator">|</span>
<span class="token punctuation">..</span>.
<span class="token operator">|</span> WRAY         <span class="token operator">|</span>        <span class="token number">1</span> <span class="token operator">|</span>
+--------------+----------+
<span class="token number">121</span> rows <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行的顺序如下：</p><ol><li>首先使用 <code>GROUP BY</code> 子句按照 <code>last_name</code> 字段对数据进行分组。</li><li>然后使用聚合函数 <code>COUNT(*)</code> 汇总每个姓氏的行数。</li><li>最后使用 <code>ORDER BY</code>子句按照 <code>COUNT(*)</code> 降序排列。</li></ol><p>这样，数量最多的姓氏排在最前面。</p><p><strong>GROUP BY, LIMIT, 聚合函数实例</strong></p><p>查看总消费金额排名前 10 位的客户</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> customer_id<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> total
<span class="token keyword">FROM</span> payment
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> customer_id
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> total <span class="token keyword">DESC</span>
<span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code>+-------------+--------+
| customer_id | total  |
+-------------+--------+
|         526 | 221.55 |
|         148 | 216.54 |
|         144 | 195.58 |
|         137 | 194.61 |
|         178 | 194.61 |
|         459 | 186.62 |
|         469 | 177.60 |
|         468 | 175.61 |
|         236 | 175.58 |
|         181 | 174.66 |
+-------------+--------+
10 rows in set (0.02 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行的顺序如下：</p><ol><li>首先使用 <code>GROUP BY</code> 子句按照 <code>customer_id</code> 字段对数据进行分组。</li><li>然后使用聚合函数 <code>SUM(amount)</code> 汇总每个客户的 <code>amount</code> 字段，并使用 <code>total</code> 作为别名。</li><li>然后使用 <code>ORDER BY</code> 子句按照 <code>total</code> 降序排列。</li><li>最后使用 <code>LIMIT 10</code> 子句返回前 10 个记录行。</li></ol><p><strong>GROUP BY 和 HAVING 实例</strong></p><p>返回总消费金额在 180 以上的客户。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> customer_id<span class="token punctuation">,</span> <span class="token function">SUM</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span> total
<span class="token keyword">FROM</span> payment
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> customer_id
<span class="token keyword">HAVING</span> total <span class="token operator">&gt;</span> <span class="token number">180</span>
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> total <span class="token keyword">DESC</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code>+-------------+--------+
| customer_id | total  |
+-------------+--------+
|         526 | 221.55 |
|         148 | 216.54 |
|         144 | 195.58 |
|         137 | 194.61 |
|         178 | 194.61 |
|         459 | 186.62 |
+-------------+--------+
6 rows in set (0.02 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行的顺序如下：</p><ol><li>首先使用 <code>GROUP BY</code> 子句按照 <code>customer_id</code> 字段对数据进行分组。</li><li>然后使用聚合函数 <code>SUM(amount)</code> 汇总每个客户的 <code>amount</code> 字段，并使用 <code>total</code> 作为别名。</li><li>然后使用 <code>HAVING</code> 过滤结果集中 <code>total</code> 大于 <code>180</code> 的数据行。</li><li>最后使用 <code>ORDER BY</code> 子句按照 <code>total</code> 降序排列。</li></ol><p><code>HAVING</code> 子句用来过滤 <code>GROUP BY</code> 分组的数据，需要使用逻辑表达式作为条件</p><ul><li>其中逻辑表达式中的<strong>字段或表达式只能使用分组使用的字段和聚合函数</strong>。</li></ul><h2 id="union" tabindex="-1"><a class="header-anchor" href="#union" aria-hidden="true">#</a> UNION</h2><h3 id="语法-13" tabindex="-1"><a class="header-anchor" href="#语法-13" aria-hidden="true">#</a> 语法</h3><p><code>UNION</code> 操作符用来合并两个 <code>SELECT</code> 语句的结果集</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> statement
<span class="token keyword">UNION</span> <span class="token punctuation">[</span><span class="token keyword">DISTINCT</span> <span class="token operator">|</span> <span class="token keyword">ALL</span><span class="token punctuation">]</span>
<span class="token keyword">SELECT</span> statement
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>UNION</code> 双目操作符，需要<strong>两个 <code>SELECT</code> 语句作为操作数</strong>。</li><li><code>UNION</code> 中的 <code>SELECT</code> 语句中的<strong>列数、列顺序必须相同</strong>。</li><li><code>UNION</code> 运算包括 <code>UNION DISTINCT</code> 和 <code>UNION ALL</code> 两种算法，其中 <code>UNION DISTINCT</code> 可以简写为 <code>UNION</code>。 <ul><li><code>UNION DISTINCT</code> 或 <code>UNION</code> 将过滤掉结果集中重复记录。</li><li><code>UNION ALL</code> 将返回结果集中的所有记录。</li></ul></li></ul><h3 id="实例-14" tabindex="-1"><a class="header-anchor" href="#实例-14" aria-hidden="true">#</a> 实例</h3><ul><li><p><code>UNION</code>就是将上下两个SELECT语句的结果集放在一起，去重之后返回</p></li><li><p><code>UNION ALL</code>就是将上下两个SELECT语句的结果集放在一起直接返回</p></li><li><p><code>UNION</code> 运算的结果集只要列数一样就可以。返回结果集的列名采用第一个结果集的列名</p></li></ul><h2 id="别名" tabindex="-1"><a class="header-anchor" href="#别名" aria-hidden="true">#</a> 别名</h2><p>SQL 中涉及到多个表，我们需要使用 <code>table_name.column_name</code> 这样的方式来引用每个表的字段，这有时候会让 SQL 变的臃肿和难以阅读。而使用别名，则可以简化 SQL 和提高 SQL 的可读性。</p><h3 id="别名种类" tabindex="-1"><a class="header-anchor" href="#别名种类" aria-hidden="true">#</a> 别名种类</h3><ul><li>列别名</li><li>表别名</li><li>派生表别名</li></ul><h3 id="列别名" tabindex="-1"><a class="header-anchor" href="#列别名" aria-hidden="true">#</a> 列别名</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> column_name <span class="token keyword">AS</span> <span class="token identifier"><span class="token punctuation">`</span>alias<span class="token punctuation">`</span></span>
<span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>AS</code> 关键字后面跟的是列的别名 <code>alias</code></li><li>当别名 <code>alias</code> 中包含空格时，必须使用 ` 将别名引起来，即`alias`。</li><li><code>AS</code> 关键字是可选的。</li><li>除了为字段指定别名，还可以为表达式指定别名。例如： SELECT NOW() `Current Time` FROM dual</li></ul><h3 id="表别名" tabindex="-1"><a class="header-anchor" href="#表别名" aria-hidden="true">#</a> 表别名</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>table_name <span class="token keyword">AS</span> alias
table_name alias
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>其中 <code>AS</code> 关键字是可选的，可以省略它</p><p>当 SQL 语句中涉及到多个表时，使用表别名相当重要。</p><p>特别是当多个表含有相同的字段名时。</p><ul><li>不指定表别名时，为了区分来自不同表的同名字段，只能通过 <code>table_name.column_name</code> 这样的方式来引用每个表的字段。</li><li>当指定了别名时，则可以通过 <code>alias.column_name</code> 引用字段。</li></ul><h3 id="派生表别名" tabindex="-1"><a class="header-anchor" href="#派生表别名" aria-hidden="true">#</a> 派生表别名</h3><p>派生表是一个由表达式生成的表，使用派生表就像使用表一样</p><p>常见的派生表由子查询产生</p><div class="language-SQL line-numbers-mode" data-ext="SQL"><pre class="language-SQL"><code>SELECT
    AVG(t.customer_total) customer_avg
FROM
    (SELECT
        customer_id, SUM(amount) customer_total
    FROM
        payment
    GROUP BY customer_id
    HAVING customer_total &gt; 180) t;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>使用派生表必须指定别名。因为，<code>FROM</code> 子句中的所有表都必须有一个名字</li></ul><h2 id="子查询" tabindex="-1"><a class="header-anchor" href="#子查询" aria-hidden="true">#</a> 子查询</h2><p>子查询是嵌套一个语句中的查询语句，也被称为内部查询。子查询经常用在 <code>WHERE</code>子句中</p><h3 id="子查询和in" tabindex="-1"><a class="header-anchor" href="#子查询和in" aria-hidden="true">#</a> 子查询和IN</h3><ul><li>子查询常常与<code>IN</code>运算符合作 <ul><li>当子查询查询出来的结果集不唯一时，需要用<code>IN</code>运算符连接父查询的条件</li></ul></li></ul><h3 id="派生表" tabindex="-1"><a class="header-anchor" href="#派生表" aria-hidden="true">#</a> 派生表</h3><p>当一个子查询位于<code>FROM</code>子句中的时候，它被称为派生表</p><p>派生表遵循以下规则：</p><ul><li>派生表必须具有别名。 <ul><li>MySQL规定，任何<code>FROM</code>子句中的表都必须具有一个名字</li></ul></li><li>派生表的列名必须是唯一的。</li></ul><p>派生表不是临时表</p><p>使用派生表的情况通常涉及到对数据进行初步处理，以便在主查询中更轻松地进行进一步的操作</p><h2 id="insert" tabindex="-1"><a class="header-anchor" href="#insert" aria-hidden="true">#</a> INSERT</h2><h3 id="语法-14" tabindex="-1"><a class="header-anchor" href="#语法-14" aria-hidden="true">#</a> 语法</h3><p><code>INSERT</code> 语句的插入单行数据语法：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> table_name <span class="token punctuation">(</span>column_1<span class="token punctuation">,</span> column_2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span>value_1<span class="token punctuation">,</span> value_2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>INSERT</code> 语句的插入多行数据语法：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> table_name <span class="token punctuation">(</span>column_1<span class="token punctuation">,</span> column_2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span>value_11<span class="token punctuation">,</span> value_12<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span>value_21<span class="token punctuation">,</span> value_22<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>INSERT INTO</code> 和 <code>VALUES</code> 都是关键字。</li><li><code>INSERT INTO</code> 后跟表名 <code>table_name</code>。</li><li>表名 <code>table_name</code> 后跟<strong>要插入数据的列名列表</strong>。 <ul><li><strong>列名放在小括号中，多个列表使用逗号分隔</strong>。</li></ul></li><li><code>VALUES</code> 关键字之后的小括号中是<strong>值列表</strong>。 <ul><li>值的数量要和字段的<strong>数量相同</strong>。值的位置和列的<strong>位置一一对应</strong>。</li></ul></li><li>当插入多行数据时，<strong>多个值列表之间使用逗号分隔</strong>。</li><li><code>INSERT</code> 语句<strong>返回插入的行数</strong></li></ul><h3 id="insert-修饰符" tabindex="-1"><a class="header-anchor" href="#insert-修饰符" aria-hidden="true">#</a> INSERT 修饰符</h3><p>在 MySQL 中， <code>INSERT</code> 语句支持 4 个修饰符:</p><ul><li><code>LOW_PRIORITY</code>: 如果你指定了 <code>LOW_PRIORITY</code> 修饰符，MySQL 服务器将延迟执行 <code>INSERT</code> 操作直到没有客户端对表进行读操作。 <ul><li><code>LOW_PRIORITY</code> 修饰符影响那些只支持表级锁的存储引擎，比如： <code>MyISAM</code>, <code>MEMORY</code>, 和 <code>MERGE</code>。</li></ul></li><li><code>HIGH_PRIORITY</code>: 如果你指定了 <code>HIGH_PRIORITY</code> 修饰符，它会覆盖掉服务器启动时的 <code>--low-priority-updates</code> 选项。 <ul><li><code>HIGH_PRIORITY</code> 修饰符影响那些只支持表级锁的存储引擎，比如： <code>MyISAM</code>, <code>MEMORY</code>, 和 <code>MERGE</code>。</li></ul></li><li><code>IGNORE</code>: 如果你指定了 <code>IGNORE</code> 修饰符，MySQL 服务器会在执行 <code>INSERT</code> 操作期间忽略那些可忽略的错误。这些错误最终会作为 <code>WARNING</code> 返回。</li><li><code>DELAYED</code>: 这个修饰符已经在 MySQL 5.6 版本中弃用，将来会被删除。在 MySQL 8.0 中，这个修饰符可用但会被忽略。</li></ul><p><strong>用法</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token punctuation">[</span>LOW_PRIORITY <span class="token operator">|</span> <span class="token keyword">DELAYED</span> <span class="token operator">|</span> HIGH_PRIORITY<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">IGNORE</span><span class="token punctuation">]</span>
<span class="token keyword">INTO</span> table_name
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="insert-限制" tabindex="-1"><a class="header-anchor" href="#insert-限制" aria-hidden="true">#</a> INSERT 限制</h3><p>在 MySQL 中，<code>max_allowed_packet</code> 配置了服务器和客户端任何单个消息大小的上限。</p><p>这同样适用于 <code>SELECT</code> 语句。当一个 <code>SELECT</code> 语句的大小超过 <code>max_allowed_packet</code> 值时，服务器就会给出一个错误。</p><p>以下语句显示了当前服务器上的 <code>max_allowed_packet</code> 配置：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">&#39;max_allowed_packet&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code>+--------------------+----------+
| Variable_name      | Value    |
+--------------------+----------+
| max_allowed_packet | 67108864 |
+--------------------+----------+
1 row in set (0.00 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>max_allowed_packet</code> 以字节为单位。并且不同服务器上的值可能不同。</p><h2 id="delete" tabindex="-1"><a class="header-anchor" href="#delete" aria-hidden="true">#</a> DELETE</h2><h3 id="单表删除语法" tabindex="-1"><a class="header-anchor" href="#单表删除语法" aria-hidden="true">#</a> 单表删除语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> table_name
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> clause<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">LIMIT</span> row_count<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>DELETE FROM</code> 后跟的是<strong>要从中删除数据的表</strong>。</li><li><code>WHERE</code> 子句用来过滤需要删除的行。<strong>满足条件的行会被删除</strong>。 <ul><li><code>WHERE</code> 子句是可选的。没有 <code>WHERE</code> 子句时，<code>DELETE</code> 语句将<strong>删除表中的所有行</strong>。</li><li><code>DELETE</code> 语句中的 <code>WHERE</code> 子句非常重要。除非您特意，否则不要省略 <code>WHERE</code> 子句。它会导致删除表中的所有数据。</li></ul></li><li><code>ORDER BY</code> 子句用来<strong>指定删除行的顺序</strong>。它是可选的。</li><li><code>LIMIT</code> 子句用来<strong>指定删除的最大行数</strong>。它是可选的。</li><li><code>DELETE</code> 语句<strong>返回删除的行数</strong>。</li></ul><h3 id="实例-15" tabindex="-1"><a class="header-anchor" href="#实例-15" aria-hidden="true">#</a> 实例</h3><p><strong>限制删除的最大行数</strong></p><p>考虑以下这些需求：</p><ul><li>删除排名最靠后的 5 个成绩</li><li>删除最新注册的 10 名用户</li></ul><p>这时，我们可以结合使用 <code>ORDER BY</code>和 <code>LIMIT</code>子句。</p><p>以下语句用来删除 <code>actor_copy</code> 中 <code>actor_id</code> 最大的 10 行：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> actor_copy
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> actor_id <span class="token keyword">DESC</span>
<span class="token keyword">LIMIT</span> <span class="token number">10</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="language-txt"><code>Query OK, 10 rows affected (0.01 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果单独使用 <code>LIMIT</code> 子句，删除的顺序是不明确的。</p><p>大多数情况下， <code>DELETE</code> 语句中的 <code>LIMIT</code> 子句都应该和 <code>ORDER BY</code> 子句一起使用。</p><p><strong>删除表中所有的行</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> actor_copy<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>只是想清空表，可以使用 <code>TRUNCATE TABLE</code>语句以获得更好的性能。如下：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">TRUNCATE</span> actor_copy<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>多表删除</strong></p><p>在一个 <code>DELETE</code> 语句中指定多个表，以便在一个或多个表中删除符合 <code>WHERE</code> 子句中的条件的行。</p><ul><li><p>删除 <code>t1</code> 和 <code>t2</code> 表中满足条件的行：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DELETE</span> t1<span class="token punctuation">,</span> t2
<span class="token keyword">FROM</span> t1 <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> t2
<span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>id <span class="token operator">=</span> t2<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>删除 <code>t1</code> 表中满足条件的行：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DELETE</span> t1
<span class="token keyword">FROM</span> t1 <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> t2
<span class="token keyword">WHERE</span> t1<span class="token punctuation">.</span>id <span class="token operator">=</span> t2<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>在删除时使用 <code>LEFT JOIN</code>：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DELETE</span> t1
<span class="token keyword">FROM</span>
  t1 <span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> t2 <span class="token keyword">ON</span> t1<span class="token punctuation">.</span>id <span class="token operator">=</span> t2<span class="token punctuation">.</span>id
<span class="token keyword">WHERE</span> t2<span class="token punctuation">.</span>id <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>只要是 <code>SELECT</code> 语句中允许使用的 <code>JOIN</code>类型，多表删除语句都可以使用。</p><p>多表删除语句中不能使用 <code>LIMIT</code> 子句和 <code>ORDER BY</code> 子句。</p><h3 id="delete-修饰符" tabindex="-1"><a class="header-anchor" href="#delete-修饰符" aria-hidden="true">#</a> DELETE 修饰符</h3><p><code>DELETE</code> 语句支持 3 个修饰符:</p><ul><li><code>LOW_PRIORITY</code>: 如果你指定了 <code>LOW_PRIORITY</code> 修饰符，MySQL 服务器将延迟执行 <code>DELETE</code> 操作直到没有客户端对表进行读操作。这个修饰符影响那些只支持表级锁的存储引擎，比如： <code>MyISAM</code>, <code>MEMORY</code>, 和 <code>MERGE</code>。</li><li><code>QUICK</code>: 如果你指定了 <code>QUICK</code> 修饰符，<code>MyISAM</code> 存储引擎不会在 <code>DELETE</code> 操作期间合并索引。这在某种程度上会加快 <code>DELETE</code> 操作。</li><li><code>IGNORE</code>: 如果你指定了 <code>IGNORE</code> 修饰符，MySQL 服务器会在执行 <code>DELETE</code> 操作期间忽略那些可忽略的错误。这些错误最终会作为 <code>WARNING</code> 返回。</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DELETE</span> <span class="token punctuation">[</span>LOW_PRIORITY<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">QUICK</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">IGNORE</span><span class="token punctuation">]</span> <span class="token keyword">FROM</span> table_name
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="update" tabindex="-1"><a class="header-anchor" href="#update" aria-hidden="true">#</a> UPDATE</h2><h3 id="语法-15" tabindex="-1"><a class="header-anchor" href="#语法-15" aria-hidden="true">#</a> 语法</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> <span class="token punctuation">[</span><span class="token keyword">IGNORE</span><span class="token punctuation">]</span> table_name
<span class="token keyword">SET</span>
    column_name1 <span class="token operator">=</span> value1<span class="token punctuation">,</span>
    column_name2 <span class="token operator">=</span> value2<span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span><span class="token keyword">WHERE</span> clause<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>UPDATE</code> 关键字后<strong>指定要更新数据的表名</strong>。</li><li>使用 <code>SET</code> 子句<strong>设置字段的新值</strong>。<strong>多个字段使用逗号分隔</strong>。 <ul><li>字段的值可以是<strong>普通的字面值，也可以是表达式运算，还可以是子查询</strong>。</li></ul></li><li>使用 <code>WHERE</code>子句指定要更新的行。只有<strong>符合 <code>WHERE</code> 条件的行才会被更新</strong>。 <ul><li><code>UPDATE</code> 语句中的 <code>WHERE</code> 子句非常重要。除非您特意，否则不要省略 <code>WHERE</code> 子句。</li></ul></li><li><code>WHERE</code> 子句是可选的。如果不指定 <code>WHERE</code> 子句，则<strong>更新表中的所有行</strong>。</li></ul><h3 id="实例-16" tabindex="-1"><a class="header-anchor" href="#实例-16" aria-hidden="true">#</a> 实例</h3><p><strong>更新单条</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> customer
<span class="token keyword">SET</span> email <span class="token operator">=</span> <span class="token string">&#39;NEW.MARY.SMITH@sakilacustomer.org&#39;</span>
<span class="token keyword">WHERE</span> customer_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Query OK, <span class="token number">1</span> row affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
Rows matched: <span class="token number">1</span>  Changed: <span class="token number">1</span>  Warnings: <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>1 row affected</code> 表示 1 行数据受影响。也就是更新了 1 行数据。</li><li><code>Rows matched: 1</code> 表示匹配的 <code>WHERE</code> 条件的行数是 1。</li><li><code>Changed: 1</code> 表示修改的行数是 1。</li><li><code>Warnings: 0</code> 表示没有需要注意的事项。</li></ul><p><strong>更新多条</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> customer
<span class="token keyword">SET</span> first_name <span class="token operator">=</span> <span class="token string">&#39;Tim&#39;</span><span class="token punctuation">,</span>
    last_name <span class="token operator">=</span> <span class="token string">&#39;Duncan&#39;</span><span class="token punctuation">,</span>
    email <span class="token operator">=</span> <span class="token string">&#39;Tim.Duncan@sakilacustomer.org&#39;</span>
<span class="token keyword">WHERE</span> customer_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>使用表达式更新</strong></p><p>更新所有客户的电子邮件的域名部分：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> customer
<span class="token keyword">SET</span> email <span class="token operator">=</span> <span class="token keyword">REPLACE</span><span class="token punctuation">(</span>email<span class="token punctuation">,</span> <span class="token string">&#39;sakilacustomer.org&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;sjkjc.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>使用子查询更新</strong></p><p>为没有绑定商店的客户绑定一个随机商店。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> customer
<span class="token keyword">SET</span> store_id <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token keyword">SELECT</span> store_id
    <span class="token keyword">FROM</span> store
    <span class="token keyword">ORDER</span> <span class="token keyword">BY</span> RAND<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">LIMIT</span> <span class="token number">1</span>
  <span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> store_id <span class="token operator">IS</span> <span class="token boolean">NULL</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="update-修饰符" tabindex="-1"><a class="header-anchor" href="#update-修饰符" aria-hidden="true">#</a> UPDATE 修饰符</h3><ul><li><p><code>LOW_PRIORITY</code>: 如果你指定了 <code>LOW_PRIORITY</code> 修饰符，MySQL 服务器将延迟执行 <code>UPDATE</code> 操作直到没有客户端对表进行读操作。</p><p><code>LOW_PRIORITY</code> 修饰符影响那些只支持表级锁的存储引擎，比如： <code>MyISAM</code>, <code>MEMORY</code>, 和 <code>MERGE</code>。</p></li><li><p><code>IGNORE</code>: 如果你指定了 <code>IGNORE</code> 修饰符，MySQL 服务器会在执行 <code>UPDATE</code> 操作期间忽略那些可忽略的错误。这些错误最终会作为 <code>WARNING</code> 返回。</p></li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>PDATE <span class="token punctuation">[</span>LOW_PRIORITY<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">IGNORE</span><span class="token punctuation">]</span> table_name <span class="token keyword">SET</span> column_name <span class="token operator">=</span> <span class="token keyword">value</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="replace" tabindex="-1"><a class="header-anchor" href="#replace" aria-hidden="true">#</a> REPLACE</h2><p>在 MySQL 中，如果你想向表中插入数据，除了使用 <code>INSERT</code> 语句，还可以使用 <code>REPLACE</code> 语句。</p><p><code>REPLACE</code> 语句和 <code>INSERT</code> 语句很像，它们的不同之处在于，当插入过程中出现了重复的主键或者重复的唯一索引的时候，<code>INSERT</code> 语句会产生一个错误，而 <code>REPLACE</code> 语句则先删除旧的行，再插入新的行。</p><p><code>REPLACE</code> 语句<strong>不在标准 SQL 的范畴</strong>。</p><h3 id="语法-16" tabindex="-1"><a class="header-anchor" href="#语法-16" aria-hidden="true">#</a> 语法</h3><blockquote><p>插入功能跟INSERT类似</p></blockquote><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">REPLACE</span> <span class="token punctuation">[</span><span class="token keyword">INTO</span><span class="token punctuation">]</span> table_name <span class="token punctuation">(</span>column_1<span class="token punctuation">,</span> column_2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span>value_11<span class="token punctuation">,</span> value_12<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
       <span class="token punctuation">(</span>value_21<span class="token punctuation">,</span> value_22<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>REPLACE INTO</code> 和 <code>VALUES</code> 都是关键字。<strong><code>INTO</code> 可省略。</strong></li><li><code>REPLACE INTO</code> 后跟表名 <code>table_name</code>。</li><li>表名 <code>table_name</code> 后跟<strong>要插入数据的列名列表</strong>。列名放在小括号中，多个列表使用逗号分隔。</li><li><code>VALUES</code> 关键字之后的小括号中是<strong>值列表</strong>。值的数量要和字段的<strong>数量相同</strong>。值的位置和列的位置<strong>一一对应</strong>。</li><li>当插入多行数据时，多个值列表之间使用逗号分隔。</li></ul><blockquote><p>更新功能跟UPDATE类似</p></blockquote><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">REPLACE</span> <span class="token punctuation">[</span><span class="token keyword">INTO</span><span class="token punctuation">]</span> table_name
<span class="token keyword">SET</span> column1 <span class="token operator">=</span> value1<span class="token punctuation">,</span>
    column2 <span class="token operator">=</span> value2<span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>UPDATE</code> 只更新符合条件的行的指定字段的值，未指定的字段保留原值。</li><li><code>REPLACE</code> 则会删掉旧行，再插入新行，<code>REPLACE</code> 语句中未指定的字段则为默认值或者 <code>NULL</code>。</li><li>如果想要正常使用 <code>REPLACE</code>，当前操作的用户必须对表具有 <code>INSERT</code>和 <code>DELETE</code> 权限。</li></ul><h2 id="函数" tabindex="-1"><a class="header-anchor" href="#函数" aria-hidden="true">#</a> 函数</h2><h3 id="数字函数" tabindex="-1"><a class="header-anchor" href="#数字函数" aria-hidden="true">#</a> 数字函数</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token number">5.73</span><span class="token punctuation">)</span>  <span class="token comment">-- 对5.73保留整数的四舍五入，结果为6</span>
<span class="token keyword">SELECT</span> <span class="token function">ROUND</span><span class="token punctuation">(</span><span class="token number">5.73</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">-- 对5.73做保留一位小数的四舍五入，结果为5.7</span>
<span class="token keyword">SELECT</span> <span class="token keyword">TRUNCATE</span><span class="token punctuation">(</span><span class="token number">5.7367</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">--  截取两位小数，结果5.73</span>
<span class="token keyword">SELECT</span> CEILING<span class="token punctuation">(</span><span class="token number">5.7</span><span class="token punctuation">)</span> <span class="token comment">-- 上限函数，向上取整，结果为6</span>
<span class="token keyword">SELECT</span> FLOOR<span class="token punctuation">(</span><span class="token number">5.7</span><span class="token punctuation">)</span> <span class="token comment">-- 向下取整，结果为5</span>
<span class="token keyword">SELECT</span> ABS<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5.7</span><span class="token punctuation">)</span> <span class="token comment">-- 取绝对值，结果为5.7</span>
<span class="token keyword">SELECT</span> RAND<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">-- 生成0-1的随机数</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="字符串函数" tabindex="-1"><a class="header-anchor" href="#字符串函数" aria-hidden="true">#</a> 字符串函数</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> LENGTH<span class="token punctuation">(</span><span class="token string">&#39;SKY&#39;</span><span class="token punctuation">)</span> <span class="token comment">-- 计算字符串长度</span>
<span class="token keyword">SELECT</span> UPPER<span class="token punctuation">(</span><span class="token string">&#39;SKY&#39;</span><span class="token punctuation">)</span> <span class="token comment">-- 转换为大写</span>
<span class="token keyword">SELECT</span> LOWER<span class="token punctuation">(</span><span class="token string">&#39;SKY&#39;</span><span class="token punctuation">)</span> <span class="token comment">-- 转换为小写</span>
<span class="token keyword">SELECT</span> LTRIM<span class="token punctuation">(</span><span class="token string">&#39;   SKY&#39;</span><span class="token punctuation">)</span>  <span class="token comment">-- 去掉字符串最左侧的空格</span>
<span class="token keyword">SELECT</span> RTRIM<span class="token punctuation">(</span><span class="token string">&#39;SKY   &#39;</span><span class="token punctuation">)</span>  <span class="token comment">-- 去掉字符串最右侧的空格</span>
<span class="token keyword">SELECT</span> RTRIM<span class="token punctuation">(</span><span class="token string">&#39;   SKY   &#39;</span><span class="token punctuation">)</span>  <span class="token comment">-- 删除两边的空格</span>
<span class="token keyword">SELECT</span> <span class="token keyword">LEFT</span><span class="token punctuation">(</span><span class="token string">&#39;Kindergarten&#39;</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>  <span class="token comment">-- 从左边开始截取4个字符，返回Kind</span>
<span class="token keyword">SELECT</span> <span class="token keyword">RIGHT</span><span class="token punctuation">(</span><span class="token string">&#39;Kindergarten&#39;</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token comment">-- 返回garten</span>
<span class="token keyword">SELECT</span> SUBSTRING<span class="token punctuation">(</span><span class="token string">&#39;Kindergarten&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>  <span class="token comment">-- 返回nderg</span>
<span class="token keyword">SELECT</span> SUBSTRING<span class="token punctuation">(</span><span class="token string">&#39;Kindergarten&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">-- 返回ndergarten</span>
<span class="token keyword">SELECT</span> LOCATE<span class="token punctuation">(</span><span class="token string">&#39;n&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Kindergarten&#39;</span><span class="token punctuation">)</span> <span class="token comment">-- 查找n的位置，返回3，不区分大小写，查不到则返回0</span>
<span class="token keyword">SELECT</span> LOCATE<span class="token punctuation">(</span><span class="token string">&#39;garten&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Kindergarten&#39;</span><span class="token punctuation">)</span> <span class="token comment">-- 查找左侧字符串在右侧出现的第一个位置索引，返回7</span>
<span class="token keyword">SELECT</span> <span class="token keyword">REPLACE</span><span class="token punctuation">(</span><span class="token string">&#39;Kindergarten&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;garten&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;garden&#39;</span><span class="token punctuation">)</span>  <span class="token comment">-- 替换</span>
<span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span><span class="token string">&#39;first&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;last&#39;</span><span class="token punctuation">)</span> <span class="token comment">-- 合并两个字符串，返回firstlast</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>CONCAT函数的应用</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 拼接customers表中的first_name和last_name字段，中间用空格隔开</span>
<span class="token keyword">SELECT</span> CONCAT<span class="token punctuation">(</span>first_name<span class="token punctuation">,</span> <span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> last_name<span class="token punctuation">)</span> <span class="token keyword">AS</span> full_name
<span class="token keyword">FROM</span> customers
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="时间函数" tabindex="-1"><a class="header-anchor" href="#时间函数" aria-hidden="true">#</a> 时间函数</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> CURDATE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> CURTIME<span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token comment">-- 2019-03-11 12:44:03  2019-03-11  12:44:03</span>
<span class="token keyword">SELECT</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">-- 2019</span>
<span class="token keyword">SELECT</span> <span class="token keyword">MONTH</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DAY</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> <span class="token keyword">HOUR</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> <span class="token keyword">MINUTE</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> <span class="token keyword">SECOND</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> DAYNAME<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">-- Monday</span>
<span class="token keyword">SELECT</span> MONTHNAME<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">SELECT</span> EXTRACT<span class="token punctuation">(</span><span class="token keyword">DAY</span> <span class="token keyword">FROM</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">-- 格式化日期</span>
<span class="token keyword">SELECT</span> DATE_FORMATE<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;%y&#39;</span><span class="token punctuation">)</span>  <span class="token comment">-- 返回当前年的两位，返回19</span>
<span class="token keyword">SELECT</span> DATE_FORMATE<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;%Y&#39;</span><span class="token punctuation">)</span> <span class="token comment">-- 返回四位年份，返回2019</span>
<span class="token keyword">SELECT</span> DATE_FORMATE<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;% %Y&#39;</span><span class="token punctuation">)</span> <span class="token comment">-- 03 2019</span>
<span class="token keyword">SELECT</span> DATE_FORMATE<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;%M %Y&#39;</span><span class="token punctuation">)</span> <span class="token comment">-- March 2019</span>
<span class="token keyword">SELECT</span> DATE_FORMATE<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;%M %d %Y&#39;</span><span class="token punctuation">)</span> <span class="token comment">-- March 11 2019</span>
<span class="token keyword">SELECT</span> TIME_FORMATE<span class="token punctuation">(</span>NOE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;%H:%i&#39;</span><span class="token punctuation">)</span>  <span class="token comment">-- 12:58</span>
<span class="token keyword">SELECT</span> TIME_FORMATE<span class="token punctuation">(</span>NOE<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;%H:%i %P&#39;</span><span class="token punctuation">)</span>  <span class="token comment">-- 12:58 PM</span>
<span class="token comment">-- 计算时间和日期</span>
<span class="token comment">-- 添加天/年，可以指定单位</span>
<span class="token keyword">SELECT</span> DATE_ADD<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">DAY</span><span class="token punctuation">)</span> <span class="token comment">-- 2019-03-12 13:25:40</span>
<span class="token keyword">SELECT</span> DATE_ADD<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">YEAR</span><span class="token punctuation">)</span> <span class="token comment">-- 2020-03-12 13:25:40</span>
<span class="token keyword">SELECT</span> DATE_ADD<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">YEAR</span><span class="token punctuation">)</span> <span class="token comment">-- 2018-03-12 13:25:40</span>
<span class="token comment">-- 减少天/年</span>
<span class="token keyword">SELECT</span> DATE_SUB<span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">YEAR</span><span class="token punctuation">)</span> <span class="token comment">-- 2018-03-12 13:25:40</span>
<span class="token comment">-- 计算两个日期的间隔</span>
<span class="token keyword">SELECT</span> DATEDIFF<span class="token punctuation">(</span><span class="token string">&#39;2019-01-05&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2019-01-01&#39;</span><span class="token punctuation">)</span>  <span class="token comment">-- 返回结果为4</span>
<span class="token keyword">SELECT</span> DATEDIFF<span class="token punctuation">(</span><span class="token string">&#39;2019-01-05 09:00&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2019-01-01 17:00&#39;</span><span class="token punctuation">)</span>  <span class="token comment">-- 返回结果为4</span>
<span class="token keyword">SELECT</span> DATEDIFF<span class="token punctuation">(</span><span class="token string">&#39;2019-01-01&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2019-01-05&#39;</span><span class="token punctuation">)</span>  <span class="token comment">-- 返回结果为-4</span>
<span class="token comment">-- 从午夜起的流逝秒数</span>
<span class="token keyword">SELECT</span> TIME_TO_SEC<span class="token punctuation">(</span><span class="token string">&#39;09:00&#39;</span><span class="token punctuation">)</span>  <span class="token comment">-- 返回结果为32400</span>
<span class="token keyword">SELECT</span> TIME_TO_SEC<span class="token punctuation">(</span><span class="token string">&#39;09:00&#39;</span><span class="token punctuation">)</span> <span class="token operator">-</span> TIME_TO_SEC<span class="token punctuation">(</span><span class="token string">&#39;09:02&#39;</span><span class="token punctuation">)</span> <span class="token comment">-- 返回结果为-2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ifnull-coalesce" tabindex="-1"><a class="header-anchor" href="#ifnull-coalesce" aria-hidden="true">#</a> IFNULL | COALESCE</h3><p><strong>IFNULL</strong></p><div class="language-SQL line-numbers-mode" data-ext="SQL"><pre class="language-SQL"><code>SELECT order_id, IFNULL(shipper_id, &#39;Not assigned&#39;) AS shipper
FROM orders
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>如果<code>shipper_id</code>为NULL，那么返回将NULL替换为<code>Not assigned</code>，这里直接把IFNULL替换为COALESCE也能实现相同效果</p><p><strong>COALESCE</strong></p><div class="language-SQL line-numbers-mode" data-ext="SQL"><pre class="language-SQL"><code>SELECT order_id, COALESCE(shipper_id, comments, &#39;Not assigned&#39;) AS shipper
FROM orders
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>如果<code>shipper_id</code>为NULL，就返回该行记录对应注释列的值，如果注释列为NULL，就返回<code>Not assigned</code>，其中<code>comment</code>为注释列列名</p><h3 id="if-函数" tabindex="-1"><a class="header-anchor" href="#if-函数" aria-hidden="true">#</a> IF 函数</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> order_id<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> 
      	<span class="token keyword">IF</span><span class="token punctuation">(</span>
          <span class="token keyword">YEAR</span><span class="token punctuation">(</span>ORDER_DATE<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">YEAR</span><span class="token punctuation">(</span><span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;Active&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Archived&#39;</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> category
        <span class="token punctuation">)</span>
<span class="token keyword">FROM</span> orders
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="case-运算符" tabindex="-1"><a class="header-anchor" href="#case-运算符" aria-hidden="true">#</a> CASE 运算符</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> student<span class="token punctuation">.</span>stu_id       <span class="token keyword">as</span> stuId<span class="token punctuation">,</span>
       stu_name             <span class="token keyword">as</span> name<span class="token punctuation">,</span>
       <span class="token keyword">case</span>
           <span class="token keyword">when</span> stu_sex <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">then</span> <span class="token string">&#39;男&#39;</span>
           <span class="token keyword">when</span> stu_sex <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">then</span> <span class="token string">&#39;女&#39;</span>
           <span class="token keyword">end</span>              <span class="token keyword">as</span> sexString<span class="token punctuation">,</span>
       stu_grade            <span class="token keyword">as</span> grade<span class="token punctuation">,</span>
       category_name        <span class="token keyword">as</span> category<span class="token punctuation">,</span>
       student<span class="token punctuation">.</span>category_id  <span class="token keyword">as</span> categoryId<span class="token punctuation">,</span>
       ranking<span class="token punctuation">,</span>
       gaokao_final_score   <span class="token keyword">as</span> gaokaoFinalScore<span class="token punctuation">,</span>
       freshman_final_score <span class="token keyword">as</span> freshmanFinalScore<span class="token punctuation">,</span>
       final_score          <span class="token keyword">as</span> finalScore<span class="token punctuation">,</span>
       <span class="token keyword">case</span>
           <span class="token keyword">when</span> sci_lib <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">then</span> <span class="token string">&#39;理科&#39;</span>
           <span class="token keyword">when</span> sci_lib <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">then</span> <span class="token string">&#39;文科&#39;</span>
           <span class="token keyword">end</span>              <span class="token keyword">as</span> sciLib
<span class="token keyword">FROM</span> student
         <span class="token keyword">JOIN</span> division_result <span class="token keyword">USING</span> <span class="token punctuation">(</span>stu_id<span class="token punctuation">)</span>
         <span class="token keyword">JOIN</span> gaokao <span class="token keyword">USING</span> <span class="token punctuation">(</span>stu_id<span class="token punctuation">)</span>
         <span class="token keyword">JOIN</span> category <span class="token keyword">USING</span> <span class="token punctuation">(</span>category_id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="视图" tabindex="-1"><a class="header-anchor" href="#视图" aria-hidden="true">#</a> 视图</h2><h3 id="视图的作用" tabindex="-1"><a class="header-anchor" href="#视图的作用" aria-hidden="true">#</a> 视图的作用</h3><blockquote><p>视图本身不包含数据，而是用来查看存储在别处数据的一种措施</p></blockquote><p>如果有查询很复杂，使用了多个连接和子查询，就可以把这个查询结果存到视图里面。视图是虚拟的表。与包含数据的表不一样，视图只包含使用时动态检索数据的查询。</p><ul><li><strong>重用SQL语句</strong></li><li>简化复杂的SQL操作，生成虚拟表之后，<strong>不用知道怎么筛选出这些数据，只需要对这个表执行查询</strong>即可</li><li><strong>保护数据</strong>。可以给<strong>用户授予表的特定部分的访问权限，而不是整个表</strong>。</li></ul><p><strong>视图的使用场景：</strong></p><ul><li><strong>保存</strong>复杂的表连接和子查询的<strong>查询结果</strong></li><li>使用<strong>视图重新格式化检索出的数据</strong></li><li>使用<strong>视图列出计算字段</strong>，比如由<code>count * price</code>生成新的<code>sum</code>字段</li></ul><h3 id="使用视图" tabindex="-1"><a class="header-anchor" href="#使用视图" aria-hidden="true">#</a> 使用视图</h3><h4 id="创建视图" tabindex="-1"><a class="header-anchor" href="#创建视图" aria-hidden="true">#</a> 创建视图</h4><p>隐藏复杂的SQL，通常涉及联结。</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code><span class="token keyword">create</span> <span class="token keyword">view</span> stu_rank <span class="token keyword">as</span>
<span class="token keyword">select</span> student<span class="token punctuation">.</span>stu_id       <span class="token keyword">as</span> <span class="token string">&#39;学号&#39;</span><span class="token punctuation">,</span>
       stu_name             <span class="token keyword">as</span> <span class="token string">&#39;姓名&#39;</span><span class="token punctuation">,</span>
       <span class="token keyword">case</span>
           <span class="token keyword">when</span> sci_lib <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">then</span> <span class="token string">&#39;理科&#39;</span>
           <span class="token keyword">when</span> sci_lib <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">then</span> <span class="token string">&#39;文科&#39;</span>
           <span class="token keyword">end</span>              <span class="token keyword">as</span> <span class="token string">&#39;科类&#39;</span><span class="token punctuation">,</span>
       stu_score            <span class="token keyword">as</span> <span class="token string">&#39;总绩点&#39;</span><span class="token punctuation">,</span>
       gaokao_final_score   <span class="token keyword">as</span> <span class="token string">&#39;高考折算成绩&#39;</span><span class="token punctuation">,</span>
       freshman_final_score <span class="token keyword">as</span> <span class="token string">&#39;大一课程折算成绩&#39;</span><span class="token punctuation">,</span>
       final_score          <span class="token keyword">as</span> <span class="token string">&#39;综合成绩&#39;</span><span class="token punctuation">,</span>
       ranking              <span class="token keyword">as</span> <span class="token string">&#39;排名&#39;</span>
<span class="token keyword">from</span> student<span class="token punctuation">,</span>
     division_result<span class="token punctuation">,</span>
     gaokao
<span class="token keyword">where</span> student<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> division_result<span class="token punctuation">.</span>stu_id
  <span class="token keyword">AND</span> student<span class="token punctuation">.</span>stu_id <span class="token operator">=</span> gaokao<span class="token punctuation">.</span>stu_id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="格式化数据" tabindex="-1"><a class="header-anchor" href="#格式化数据" aria-hidden="true">#</a> 格式化数据</h4><ul><li><code>Concat</code>：将两个以上的字符串串联在一起 <ul><li>Concat(&#39;hello&#39;, &#39; &#39; ,&#39;world&#39;)</li></ul></li><li><code>RTrim(vend_name)</code>：去除vend_name列中的空格</li></ul><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code><span class="token keyword">SELECT</span> Concat<span class="token punctuation">(</span>RTrim<span class="token punctuation">(</span>vend_name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;(&#39;</span><span class="token punctuation">,</span> RTirm<span class="token punctuation">(</span>vend_country<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&#39;)&#39;</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> vend_title
<span class="token keyword">FROM</span> vendors
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> vend_name
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code><span class="token keyword">CREATE</span> <span class="token keyword">VIEW</span> vendorlocations <span class="token keyword">AS</span>
<span class="token keyword">SELECT</span> Concat<span class="token punctuation">(</span>RTrim<span class="token punctuation">(</span>vend_name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;(&#39;</span><span class="token punctuation">,</span> RTirm<span class="token punctuation">(</span>vend_country<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">&#39;)&#39;</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> vend_title
<span class="token keyword">FROM</span> vendors
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span> vend_name
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="视图更新" tabindex="-1"><a class="header-anchor" href="#视图更新" aria-hidden="true">#</a> 视图更新</h3><p>视图是<strong>可更新</strong>的，可以对视图使用<code>INSERT, UPDATE, DELETE</code>，更新一个视图将会<strong>更新在其基表</strong>上。 但是，如果MySQL不能正确的确定被更新的基数据，那么则不允许更新，包括插入和删除。 如果视图定义中有以下操作，则不能进行更新视图</p><ul><li>分组(GROUP BY , HAVING)</li><li>联结</li><li>子查询</li><li>并</li><li>聚合函数(MIN(), COUNT(), SUM())</li><li>DISTINCT</li><li>计算列</li></ul><h3 id="存储过程" tabindex="-1"><a class="header-anchor" href="#存储过程" aria-hidden="true">#</a> 存储过程</h3><blockquote><p>指的是存储一段SQL的执行过程</p></blockquote><h4 id="创建存储过程" tabindex="-1"><a class="header-anchor" href="#创建存储过程" aria-hidden="true">#</a> 创建存储过程</h4><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>DELIMITER $$  <span class="token comment">-- 修改默认分隔符为$$，执行的时候就会将$$包裹的部分执行</span>
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> get_clients<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>	
	<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> clients<span class="token punctuation">;</span> <span class="token comment">-- 存储过程中的每句SQL都要使用;分开</span>
<span class="token keyword">END</span>$$
DELIMITER <span class="token punctuation">;</span> <span class="token comment">-- 把默认分隔符改回分号，避免语法错误</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="执行存储过程" tabindex="-1"><a class="header-anchor" href="#执行存储过程" aria-hidden="true">#</a> 执行存储过程</h4><ul><li>图形化界面：可以进入<code>Stored Procedures</code>点击创建的存储过程，即可执行</li><li>命令行：<code>CALL get_clients()</code></li></ul><h4 id="删除存储过程" tabindex="-1"><a class="header-anchor" href="#删除存储过程" aria-hidden="true">#</a> 删除存储过程</h4><p>这里不使用<code>IF EXISTS</code>也可以，但是如果删除一个不存才的存储过程会报错，所以加上会更加安全</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code><span class="token keyword">DROP</span> <span class="token keyword">PROCEDURE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> get_clients
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="在存储过程中添加参数" tabindex="-1"><a class="header-anchor" href="#在存储过程中添加参数" aria-hidden="true">#</a> 在存储过程中添加参数</h4><ul><li>如果创建了需要参数的存储过程，并且没有指定默认的参数，那么这些参数都是必填的</li><li>参数需要指定类型，就和创建表的时候写的格式一致</li><li>因为传入的参数为了见名知意，会与列名一致，可以在参数前面添加前缀p_在使用中对列和参数进行区分，也可以添加_parm后缀 <ul><li>如果觉得这样的方式很麻烦，也可以使用给表添加别名的方式，这样通过表名调用列名，就可以将列名表名进行区分</li></ul></li><li>参数默认值可加可不加，当</li><li>传入的参数值为NULL，才会使用默认值 <ul><li>也可以不使用<code>IF</code>语句，直接在<code>WHERE</code>子句中，使用<code>IFNULL(state， c.state)</code>，那么实际执行的SQL就是<code>WHERE c.state = state</code></li></ul></li></ul><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>DELIMITER $$
<span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> get_invoices_by_client
<span class="token punctuation">(</span>
  client_id <span class="token keyword">INT</span>
<span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span> 
	<span class="token keyword">IF</span> state <span class="token keyword">IS</span> <span class="token keyword">NULL</span> <span class="token keyword">THEN</span>
    <span class="token keyword">SET</span> state <span class="token operator">=</span> <span class="token string">&#39;CA&#39;</span><span class="token punctuation">;</span>
  <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>

	<span class="token keyword">SELECT</span> <span class="token operator">*</span> 
  <span class="token keyword">FROM</span> invoices i <span class="token comment">-- 给表添加别名</span>
  <span class="token keyword">WHERE</span> i<span class="token punctuation">.</span>client_id <span class="token operator">=</span> client_id
<span class="token keyword">END</span>
DELIMITER <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="参数验证" tabindex="-1"><a class="header-anchor" href="#参数验证" aria-hidden="true">#</a> 参数验证</h4><p>需要在存储过程中判断传递的参数是否符合要求，如果是的话，那么就可以抛出异常，抛出异常需要指定异常类型，也可以指定异常描述信息。这里的异常类型并不是具体的异常名称，而是对应的异常编号。 但如果有太多的校验逻辑，会导致代码变得难以维护，可以把参数校验放在代码中，而不是在数据库中执行参数的校验</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> make_payment<span class="token punctuation">(</span>
  invoce_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
  payment_amount DECIMAL<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
  payment_date <span class="token keyword">DATE</span>
<span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span> 
	<span class="token keyword">IF</span> payment_amount <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token keyword">THEN</span>
    SIGNAL <span class="token keyword">SQLSTATE</span> <span class="token string">&#39;22003&#39;</span>
      <span class="token keyword">SET</span> MESSAGE_TEXT <span class="token operator">=</span> <span class="token string">&#39;Invalid payment amount&#39;</span><span class="token punctuation">;</span>
  <span class="token keyword">END</span> <span class="token keyword">IF</span><span class="token punctuation">;</span>

  <span class="token keyword">UPDATE</span> invoces i 
  <span class="token keyword">SET</span> 
  i<span class="token punctuation">.</span>paymeng_amout <span class="token operator">=</span> paymeng_amout<span class="token punctuation">,</span>
  i<span class="token punctuation">.</span>payment_date <span class="token operator">=</span> payment_date
  <span class="token keyword">WHERE</span> i<span class="token punctuation">.</span>invoce_id <span class="token operator">=</span> invoce_id
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="触发器" tabindex="-1"><a class="header-anchor" href="#触发器" aria-hidden="true">#</a> 触发器</h2><h3 id="什么是触发器" tabindex="-1"><a class="header-anchor" href="#什么是触发器" aria-hidden="true">#</a> 什么是触发器</h3><p>触发器是执行增删改语句之前，自动执行的一条sql语句。通常会使用触发器来加强数据一致性，或者是为了审计的目的而记录对数据库的修改。 注意：</p><ul><li>只有INSERT DELETE UPDATE三种sql语句支持使用触发器</li><li>只有表才支持触发器。视图不支持触发器，临时表也不支持。</li><li>每个表每个事件每次只允许一个触发器。因此，每个表最多支持6个触发器，及 DELETE UPDATE INSERT 前后</li><li>单一触发器不能与多个事件或多个表关联</li><li>如果BEFORE触发器失败，那么MySQL将不再执行请求的操作</li><li>如果BEFORE触发器或者语句本身失败，MySQL将不执行AFTER触发器</li></ul><h3 id="创建触发器" tabindex="-1"><a class="header-anchor" href="#创建触发器" aria-hidden="true">#</a> 创建触发器</h3><blockquote><p>FRO EACH ROW的意思是这个触发器会作用于每个受影响的行，比如插入5行就执行5次</p></blockquote><p>创建触发器时需要指定</p><ol><li>唯一的触发器名 <ul><li>命名规范：<code>[tableName][after/before][insert/update/delete]</code></li></ul></li><li>触发器关联的闭包</li><li>触发器应该响应的活动(INSERT DELETE UPDATE)</li><li>触发器什么时候执行(处理之前或之后)</li></ol><p>说明：</p><ul><li>创建了一个名为<code>newproduct</code>的触发器</li><li>此触发器将在INSERT语句执行后执行</li></ul><blockquote><p>创建products表后执行以下代码报：Not allowed to return a result set from a trigger</p></blockquote><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code><span class="token keyword">CREATE</span> TRIGGER newproduct AFTER <span class="token keyword">INSERT</span> <span class="token keyword">ON</span> products
<span class="token keyword">FOR</span> EACH <span class="token keyword">ROW</span> <span class="token keyword">SELECT</span> <span class="token string">&#39;Product added&#39;</span><span class="token punctuation">;</span> <span class="token comment">-- 简单地返回字符串&#39;Product added&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>DELIMITER $$
<span class="token keyword">CREATE</span> TRIGGER payment_after_insert
	AFTER <span class="token keyword">INSERT</span> <span class="token keyword">ON</span> payments
	<span class="token keyword">FOR</span> EACH <span class="token keyword">ROW</span>
<span class="token keyword">BEGIN</span> 
	<span class="token keyword">UPDATE</span> invoices
  <span class="token comment">-- 这里的NEW关键字指代的是插入的新记录</span>
  <span class="token comment">-- 使用OLD关键字，可以在删除或更新操作的时候获取原来的记录</span>
  <span class="token keyword">SET</span> payment_total <span class="token operator">=</span> payment_total <span class="token operator">+</span> <span class="token keyword">NEW</span><span class="token punctuation">.</span>amout
	<span class="token keyword">WHERE</span> invoice_id <span class="token operator">=</span> <span class="token keyword">NEW</span><span class="token punctuation">.</span>invoice_id<span class="token punctuation">;</span>
<span class="token keyword">END</span> $$
DELIMITER <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="删除触发器" tabindex="-1"><a class="header-anchor" href="#删除触发器" aria-hidden="true">#</a> 删除触发器</h3><p>触发器不能修改，想要修改必须先删除后创建</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code><span class="token keyword">DROP</span> TRIGGER newproduct
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="查看触发器" tabindex="-1"><a class="header-anchor" href="#查看触发器" aria-hidden="true">#</a> 查看触发器</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> TRIGGERS
<span class="token comment">-- 或者要查看指定的触发器</span>
<span class="token keyword">SHOW</span> TRIGGERS <span class="token operator">LIKE</span> <span class="token string">&#39;payements%&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="http://lgy-markdown-img.oss-cn-guangzhou.aliyuncs.com/image/image-20231206153350554.png" alt="image-20231206153350554" tabindex="0" loading="lazy"><figcaption>image-20231206153350554</figcaption></figure><h3 id="使用触发器记录修改记录" tabindex="-1"><a class="header-anchor" href="#使用触发器记录修改记录" aria-hidden="true">#</a> 使用触发器记录修改记录</h3><p>创建一张&quot;审计表&quot;，用来记录用户的修改记录</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> payments_audit 
<span class="token punctuation">(</span>
  client_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
  <span class="token keyword">date</span> <span class="token keyword">DATE</span><span class="token punctuation">,</span>
  amount DECIMAL<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  action_type VARCHAR<span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  action_date DATETIME
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行完插入之后，就在审计表中添加一条用户的修改记录</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>DELIMITER $$
<span class="token keyword">CREATE</span> TRIGGER payment_after_insert
	AFTER <span class="token keyword">INSERT</span> <span class="token keyword">ON</span> payments
	<span class="token keyword">FOR</span> EACH <span class="token keyword">ROW</span>
<span class="token keyword">BEGIN</span> 
	<span class="token keyword">UPDATE</span> invoices
	<span class="token keyword">SET</span> payment_total <span class="token operator">=</span> payment_total <span class="token operator">+</span> <span class="token keyword">NEW</span><span class="token punctuation">.</span>amout
	<span class="token keyword">WHERE</span> invoice_id <span class="token operator">=</span> <span class="token keyword">NEW</span><span class="token punctuation">.</span>invoice_id<span class="token punctuation">;</span>
	
	<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> payments_audit
	<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token keyword">NEW</span><span class="token punctuation">.</span>client_id<span class="token punctuation">,</span> <span class="token keyword">NEW</span><span class="token punctuation">.</span><span class="token keyword">date</span><span class="token punctuation">,</span> <span class="token keyword">NEW</span><span class="token punctuation">.</span>amout<span class="token punctuation">,</span> <span class="token string">&#39;Insert&#39;</span><span class="token punctuation">,</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> $$
DELIMITER <span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="事件" tabindex="-1"><a class="header-anchor" href="#事件" aria-hidden="true">#</a> 事件</h2><h3 id="什么是事件" tabindex="-1"><a class="header-anchor" href="#什么是事件" aria-hidden="true">#</a> 什么是事件</h3><p>事件是更具计划执行的任务或一堆SQL代码，可以只执行一次，也可以按照某种规律执行，比如每天早上十点或者每月一次。 所以通过事件，可以自动化数据库维护任务，比如</p><ul><li>删除已经过期的数据</li><li>把一张表复制到存档表</li><li>汇总数据生成报告</li></ul><h3 id="创建事件" tabindex="-1"><a class="header-anchor" href="#创建事件" aria-hidden="true">#</a> 创建事件</h3><ol><li>打开MySQL的事件调度器</li></ol><p>这是一个后台程序，每时每刻都在寻找需要执行的事件。可以执行以下操作查看事件管理器是否已经被打开。</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code> SHOW VARIABLES<span class="token punctuation">;</span> <span class="token comment">-- 展示MySQL中所有的系统变量</span>
 SHOW VARIABLES <span class="token keyword">LIKE</span> <span class="token string">&#39;event%&#39;</span> <span class="token comment">-- 查找事件管理器变量</span>
 <span class="token keyword">SET</span> CLOBAL event_scheduler <span class="token operator">=</span> <span class="token keyword">ON</span>  
 <span class="token comment">-- 打开事件管理器(关闭设置为OFF，关闭可以节省系统资源)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="http://lgy-markdown-img.oss-cn-guangzhou.aliyuncs.com/image/image-20231206221318383.png" alt="image-20231206221318383" tabindex="0" loading="lazy"><figcaption>image-20231206221318383</figcaption></figure><ol start="2"><li>创建事件</li></ol><p>事件命名规范：频率_后面见名知意</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>DELIMITER $$
<span class="token keyword">CREATE</span> EVENT yearly_delete_stale_audit_rows
<span class="token keyword">ON</span> SCHEDULE
	<span class="token comment">-- AT &#39;2019-05-01&#39; 如果事件只用执行一次</span>
  EVERY <span class="token number">1</span> <span class="token keyword">YEAR</span> <span class="token keyword">START</span> <span class="token string">&#39;2019-01-01&#39;</span> <span class="token keyword">END</span> <span class="token string">&#39;2029-01-01&#39;</span>
DO <span class="token keyword">BEGIN</span>
	<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> payments_audit
  <span class="token comment">-- 当前日期减1年</span>
  <span class="token keyword">WHERE</span> action_date <span class="token operator">&lt;</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">YEAR</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> $$
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="操作事件" tabindex="-1"><a class="header-anchor" href="#操作事件" aria-hidden="true">#</a> 操作事件</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> EVENTS<span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> EVENTS <span class="token operator">LIKE</span> <span class="token string">&#39;yearly%&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">DROP</span> EVENT <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> yearly_delete_stale_audit_rows<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>修改一个事件</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code>DELIMITER $$
<span class="token keyword">ALTER</span> EVENT yearly_delete_stale_audit_rows
<span class="token keyword">ON</span> SCHEDULE
	<span class="token comment">-- AT &#39;2019-05-01&#39; 如果事件只用执行一次</span>
  EVERY <span class="token number">1</span> <span class="token keyword">YEAR</span> <span class="token keyword">START</span> <span class="token string">&#39;2019-01-01&#39;</span> <span class="token keyword">END</span> <span class="token string">&#39;2029-01-01&#39;</span>
DO <span class="token keyword">BEGIN</span>
	<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> payments_audit
  <span class="token comment">-- 当前日期减1年</span>
  <span class="token keyword">WHERE</span> action_date <span class="token operator">&lt;</span> <span class="token function">NOW</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token keyword">INTERVAL</span> <span class="token number">1</span> <span class="token keyword">YEAR</span><span class="token punctuation">;</span>
<span class="token keyword">END</span> $$
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以使用 ALTER EVNET 来暂时启用或者禁用一个事件</p><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code><span class="token keyword">ALTER</span> EVENT yearly_delete_stale_audit_rows DISABLE<span class="token punctuation">;</span> <span class="token comment">-- 禁用</span>
<span class="token keyword">ALTER</span> EVENT yearly_delete_stale_audit_rows ENABLE<span class="token punctuation">;</span> <span class="token comment">-- 启用</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="事务" tabindex="-1"><a class="header-anchor" href="#事务" aria-hidden="true">#</a> 事务</h2><h3 id="事务的定义" tabindex="-1"><a class="header-anchor" href="#事务的定义" aria-hidden="true">#</a> 事务的定义</h3><blockquote><p>自动提交：没有手动开启事务时，我们写的每一句SQL，都会被MySQL放到事务中，如果语句没有返回错误，MySQL就会提交</p></blockquote><p>事务代表单个工作单元的一组SQL语句，所有这些语句都应成功完成，否则事务会运行失败。</p><p>事务的属性**<u>ACID</u>**：</p><ul><li><strong>原子性</strong>Atomicty：事务就像原子一样。每个事务都是一个工作单元，要么事务所有的命令都被成功执行，要么事务被退回去所有更改都被撤销</li><li><strong>一致性</strong>Consistency：使用事务，数据库能够处于一致性的状态。数据库的一致性包括数据约束的一致性，即主键、外键等约束。同时也有根据业务的一致性，比如用户已付款但没有生成对应的订单的情况。</li><li><strong>隔离性</strong>Isolation：事务之间相互隔离，同样的数据被更改时各自受到保护 ，如果多个事务想要修改相同的数据，那么受影响的行会被锁定，因此一次只有一个事务可以更新行，其他事务必须等待正在执行的事务执行完毕</li><li><strong>持久性</strong>Durability：事务一旦被提交，事务产生的更改是永久的</li></ul><h3 id="事务的操作" tabindex="-1"><a class="header-anchor" href="#事务的操作" aria-hidden="true">#</a> 事务的操作</h3><h4 id="开启事务" tabindex="-1"><a class="header-anchor" href="#开启事务" aria-hidden="true">#</a> 开启事务</h4><p>可以使用下边两种语句之一来开启一个事务：</p><ul><li>BEGIN [WORK]; <ul><li>单词 WORK 可有可无</li></ul></li><li>START TRANSACTION; <ul><li>相比BEGIN，它可以在该语句后面跟随修饰符，如果没有指定，默认事务为读写访问模式，修饰符如下</li><li>READ ONLY <ul><li>标识当前事务是只读事务，也就是当前事务只能读数据，不能修改数据。</li><li><strong>注意</strong>，实际上只读事务只是不允许修改哪些其他事务也能访问到的数据，对于临时表来说（适用CREATE TEMPORARY TABLE创建的表），由于它们只能在当前会话可见，因此只读事务可以对临时表进行增删改操作</li></ul></li><li>READ WRITE <ul><li>标识当前事务是一个读写事务，当前事务既可以读，也可以写</li></ul></li><li>WITH CONSISTENT SNAPSHOP <ul><li>启动一致性读</li></ul></li><li>使用示例 <ul><li>START TRANSACTION READ ONLY 开启只读事务</li><li>START TRANSACTION READ WRITE, WITH CONSISTENT SNAPSHOT 开启读写事务和一致性读</li></ul></li></ul></li></ul><blockquote><p><strong>注意</strong></p></blockquote><p>在 MySQL 有两种开启事务的命令，分别是：</p><ul><li>begin/start transaction</li><li>start transaction with consistent snapshot</li></ul><p>这两种开启事务的命令，事务的启动时机是不同的：</p><ul><li>执行了 begin/start transaction 命令后，并不代表事务启动了。只有在执行这个命令后，执行了第一条 select 语句，才是事务真正启动的时机</li><li>执行了 start transaction with consistent snapshot 命令，就会马上启动事务</li></ul><blockquote><p><strong>示例</strong></p></blockquote><div class="language-plsql line-numbers-mode" data-ext="plsql"><pre class="language-plsql"><code><span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span>
 
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> orders <span class="token punctuation">(</span>customer_id<span class="token punctuation">,</span> order_date<span class="token punctuation">,</span> status<span class="token punctuation">)</span>
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;2019-01-01&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> order_items
<span class="token keyword">VALUES</span> <span class="token punctuation">(</span>LAST_INSERT_ID<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">-- LAST_INSERT_ID() 是MySQL自带的函数，用于获取上一次插入记录的id</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
<span class="token keyword">ROLLBACK</span><span class="token punctuation">;</span>  <span class="token comment">-- 手动回退事务</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="自动提交" tabindex="-1"><a class="header-anchor" href="#自动提交" aria-hidden="true">#</a> 自动提交</h4><p>MySQL中有一个系统变量autocommit：</p><ul><li>默认值为ON</li><li>如果不显示使用START TRANSACTION 或者 BEGIN 开启事务，那么每一条语句都算是一个独立的事务，这种特性就是自动提交</li><li>可以将该变量设置为OFF，或者手动开启事务，就可以关闭自动提交的功能</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">&#39;autocommit&#39;</span><span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">---------------+-------+</span>
<span class="token operator">|</span> Variable_name <span class="token operator">|</span> <span class="token keyword">Value</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------+-------+</span>
<span class="token operator">|</span> autocommit    <span class="token operator">|</span>   <span class="token keyword">ON</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------+-------+</span>
<span class="token number">1</span> <span class="token keyword">row</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>

<span class="token comment">-- 关闭手动提交</span>
<span class="token keyword">SET</span> autocommit <span class="token operator">=</span> <span class="token keyword">OFF</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="隐式提交" tabindex="-1"><a class="header-anchor" href="#隐式提交" aria-hidden="true">#</a> 隐式提交</h4><p>将事务设置为不进行自动提交后，输入某些语句，但是没有输入COMMIT提交事务，事务还是会自动提交，就像输入了COMMIT一样。</p><p>因为这些特殊的语句而导致事务提交的情况称为隐式提交，导致事务隐式提交的语句包括：</p><ul><li>定义或修改数据库对象的数据定义语句（Data Definition Language，缩写为：DDL） <ul><li>数据库对象指数据库、表、视图、存储过程等等</li><li>当使用CREATE、ALTER、DROP等语句去修改数据库存储对象，就会隐式提交这些语句上面的事务</li></ul></li><li>隐式使用或修改MySQL数据库中的表 <ul><li>使用ALTER USER 、 CREATE USER 、 DROP USER 、 GRANT 、 RENAME USER 、 REVOKE 、 SET PASSWORD等语句是，也会隐式提交语句上面的所有事务</li></ul></li><li>事务控制或关于锁定的语句 <ul><li>在一个事务还没有提交或者回滚时，又使用用 START TRANSACTION 或者 BEGIN 语句开启了另一个事务时，会隐式的提交上一个事务</li><li>或者当前的autocommit系统变量的值为OFF，手动将其调为ON时，也会隐式提交前边语句所属的事务</li><li>使用LOCK TABLES、UNLOCK TABLES等关于索引的语句也会隐式提交前面语句所属的事务，比如使用LOAD DATA语句来批量往数据库导入数据，也会隐式提交前边语句所属的事务</li></ul></li><li>关于MySQL复制的一些语句 <ul><li>使用 START SLAVE 、 STOP SLAVE 、 RESET SLAVE 、 CHANGE MASTER TO等语句时，也会隐式提交前边的事务</li></ul></li><li>其他的语句 <ul><li>使用ANALYZE TABLE 、 CACHE INDEX 、 CHECK TABLE 、 FLUSH 、 LOAD INDEX INTO CACHE 、 OPTIMIZE TABLE 、 REPAIR TABLE 、 RESET 等语句也会隐式的提交前边语句所属的事务</li></ul></li></ul><h4 id="保存点" tabindex="-1"><a class="header-anchor" href="#保存点" aria-hidden="true">#</a> 保存点</h4><p>开启一个事务，已经进行了很多操作，但是却忽然发现存在错误操作，那么就只能手动回滚来让数据库回到最初的样子，这样前边的操作就都白输入了。</p><p>保存点就是在事务对应的数据库语句打几个点，在执行ROLLBACK语句的时候，可以指定回滚到哪一个保存点，而不是开启事务的地方，语法如下：</p><ul><li>保存保存点</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SAVEPOINT</span> 保存点名称<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>回滚时指定回滚到的保存点</li><li>WORK 和 SAVEPOINT都是可有可无的</li><li>如果没有指定保存点，就会回到开启事务的位置</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ROLLBACK</span> <span class="token punctuation">[</span><span class="token keyword">WORK</span><span class="token punctuation">]</span> <span class="token keyword">TO</span> <span class="token punctuation">[</span><span class="token keyword">SAVEPOINT</span><span class="token punctuation">]</span> 保存点名称<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>删除保存点</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">RELEASE</span> <span class="token keyword">SAVEPOINT</span> 保存点名称<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p><strong>示例</strong></p></blockquote><p>以狗哥向猫爷转账10元的例子展示一下 保存点 的用法，在执行完扣除狗哥账户的钱 10 元的语句之后</p><p>打一个 保存点 ：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> account<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+--------+---------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span>  name  <span class="token operator">|</span> balance <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+--------+---------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span>  狗哥   <span class="token operator">|</span>   <span class="token number">11</span>    <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span>  猫爷   <span class="token operator">|</span>   <span class="token number">2</span>     <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+--------+---------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">BEGIN</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">UPDATE</span> account <span class="token keyword">SET</span> balance <span class="token operator">=</span> balance <span class="token operator">-</span> <span class="token number">10</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.01</span> sec<span class="token punctuation">)</span>
<span class="token keyword">Rows</span> <span class="token keyword">matched</span>: <span class="token number">1</span> Changed: <span class="token number">1</span> <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">SAVEPOINT</span> s1<span class="token punctuation">;</span> <span class="token comment"># 一个保存点</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> account<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+--------+---------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span>  name  <span class="token operator">|</span> balance <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+--------+---------+</span>
<span class="token operator">|</span> <span class="token number">1</span>  <span class="token operator">|</span>   狗哥  <span class="token operator">|</span>       <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">2</span>  <span class="token operator">|</span>   猫爷  <span class="token operator">|</span>       <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+--------+---------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">UPDATE</span> account <span class="token keyword">SET</span> balance <span class="token operator">=</span> balance <span class="token operator">+</span> <span class="token number">1</span> <span class="token keyword">WHERE</span> id <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment"># 更新错了</span>
Query OK<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token keyword">row</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
<span class="token keyword">Rows</span> <span class="token keyword">matched</span>: <span class="token number">1</span> Changed: <span class="token number">1</span> <span class="token keyword">Warnings</span>: <span class="token number">0</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">ROLLBACK</span> <span class="token keyword">TO</span> s1<span class="token punctuation">;</span> <span class="token comment"># 回滚到保存点s1处</span>
Query OK<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token keyword">rows</span> affected <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>

mysql<span class="token operator">&gt;</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> account<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment">----+--------+---------+</span>
<span class="token operator">|</span> id <span class="token operator">|</span>   name <span class="token operator">|</span> balance <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+--------+---------+</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span>    狗哥 <span class="token operator">|</span>       <span class="token number">1</span> <span class="token operator">|</span>
<span class="token operator">|</span>  <span class="token number">2</span> <span class="token operator">|</span>    猫爷 <span class="token operator">|</span>       <span class="token number">2</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+--------+---------+</span>
<span class="token number">2</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="事务并发" tabindex="-1"><a class="header-anchor" href="#事务并发" aria-hidden="true">#</a> 事务并发</h3><p>两个以及更多的用户同时访问相同的数据的情况</p><p>当一个用户修改其他用户正在检索或者修改的数据时，并发可能会成为一个问题</p><p><strong>默认锁定</strong></p><ul><li>如果一个事务试图修改一行或者多行，事务给这些行上了锁，这个锁防止其他事务修改这些行，直到第一个事务完成，被提交或者被退回</li></ul><h4 id="不同的并发问题" tabindex="-1"><a class="header-anchor" href="#不同的并发问题" aria-hidden="true">#</a> 不同的并发问题</h4><h5 id="丢失更新" tabindex="-1"><a class="header-anchor" href="#丢失更新" aria-hidden="true">#</a> 丢失更新</h5><blockquote><p>LostUpdate</p></blockquote><p><strong>问题描述</strong></p><p>当两个事务尝试更新相同的数据，并且没有上锁时，就会发生这种情况</p><p>在这种情况下，较晚提交的事务会覆盖较早事务做的更改</p><figure><img src="http://lgy-markdown-img.oss-cn-guangzhou.aliyuncs.com/image/image-20231206231410603.png" alt="image-20231206231410603" tabindex="0" loading="lazy"><figcaption>image-20231206231410603</figcaption></figure><ul><li>A事务想要将顾客的州改为VA</li><li>B事务想要将顾客的积分改为20</li><li>如果B事务先执行，A事务后执行，没有加锁的话，A事务会覆盖B事务的修改，</li><li>B事务修改积分为20的更新会丢失</li></ul><p><strong>事务默认锁定</strong></p><blockquote><p>事务本身的隔离性就是不允许操作同一行数据，所以不需要为其设计特定的隔离级别</p></blockquote><ul><li>第一个客户端先抢到锁，开启事务后操作该条记录，并且还没有提交事务</li><li>当第二个客户端开启事务，想要修改同一条记录的时候，是没有权限执行的，它必须<strong>等待第一个客户端的事务执行完成</strong>，等待第一个客户端提交事务或者回退事务。</li></ul><h5 id="脏读" tabindex="-1"><a class="header-anchor" href="#脏读" aria-hidden="true">#</a> 脏读</h5><blockquote><p>DirtyReads</p></blockquote><p><strong>问题描述</strong></p><p>一个事务读取了尚未被提交的数据</p><figure><img src="http://lgy-markdown-img.oss-cn-guangzhou.aliyuncs.com/image/image-20231206231350294.png" alt="image-20231206231350294" tabindex="0" loading="lazy"><figcaption>image-20231206231350294</figcaption></figure><ul><li>事务A将顾客的积分改为20</li><li>在事务A提交事务之前，事务B已经读取了这名顾客的记录，并基于这名顾客的积分做了某些决定 <ul><li>比如：每点积分给1块钱折扣</li></ul></li><li>如果事务A在事务B完成之前被退回了，事务B拿到的就是本来就不存在的数据 <ul><li>也就是这名顾客没有得到过20积分，但是却按照20积分的标准给了优惠</li></ul></li></ul><p><strong>READ COMMITED(读已提交)</strong></p><p>当我们对事务使用这个隔离级别时，这个事务就<strong>只能读到已经提交的数据</strong></p><h5 id="不可重复读" tabindex="-1"><a class="header-anchor" href="#不可重复读" aria-hidden="true">#</a> 不可重复读</h5><blockquote><p>Non-repeatingReads</p></blockquote><p><strong>问题描述</strong></p><p>读取某个数据两次，并且读到了不同的结果</p><figure><img src="http://lgy-markdown-img.oss-cn-guangzhou.aliyuncs.com/image/image-20231206232151876.png" alt="image-20231206232151876" tabindex="0" loading="lazy"><figcaption>image-20231206232151876</figcaption></figure><ul><li>事务A读取顾客的积分为10</li><li>之后事务B修改了这个积分为0</li><li>然后事务A又读取了这个顾客的积分，但是这次是0 <ul><li>事务A的这两次读取可能是在同一个SQL里面的（子查询）</li></ul></li></ul><p><strong>REPEATABLE READ(可重复读)</strong></p><p>将它与其他事务隔离，确保数据更改对事务不可见</p><p>事务读取到的数据是可重复和一致的，就算其他的事务修改了数据，事务也只能看到首次读取就创建的快照</p><h5 id="幻读" tabindex="-1"><a class="header-anchor" href="#幻读" aria-hidden="true">#</a> 幻读</h5><blockquote><p>PhantomReads</p></blockquote><p><strong>问题描述</strong></p><p>事务无法读取到突然出现的数据，因为它们是执行查询之后才添加，更新或者删除的</p><figure><img src="http://lgy-markdown-img.oss-cn-guangzhou.aliyuncs.com/image/image-20231206232612347.png" alt="image-20231206232612347" tabindex="0" loading="lazy"><figcaption>image-20231206232612347</figcaption></figure><ul><li>事务A需要查询积分大于10的顾客 <ul><li>可能需要给它们发送特殊的优惠码</li></ul></li><li>但是此时事务B更新了一个顾客的积分为10</li><li>事务A获取的顾客集合就少了一位符合标准的</li></ul><p><strong>SERIALIZABLE(序列化)</strong></p><ul><li>它能保证当有别的事务在更新数据的时候，我们的事务能够知道其变化，如果其他事务修改了可能影响查询结果的数据，我们的事务必须等待它们完成</li></ul><p><strong>序列化实现原理</strong></p><ul><li><p>事务在其启动时获取一个时间戳，并只能看到在该时间戳之前已经存在的数据</p><ul><li>在没有开启&quot;序列化&quot;隔离级别的时候，开启事务之后，AB事务都能够看到该时间戳之前已经存在的数据，并且A无法感知到在这个时间戳之后B对数据的修改</li><li>但是在开启&quot;序列化&quot;隔离级别之后，开启事务，AB事务获取该事件戳之前的数据 <ul><li>B在A查询之前进行修改，并没有提交</li><li>此时<strong>A能够感知到当前获取的数据正在被操作</strong>，因此会<strong>等待操作该数据的事务提交</strong>，来确保读到的数据时序性</li></ul></li></ul></li><li><p>事务按序列化执行，也可以理解为并行变串行</p></li><li><p>事务按顺序执行，就像一个单用户系统一样，如果拥有的用户和并发事务越来越多，等待时间越长 ，会损害性能和扩展性。</p></li></ul><h4 id="事务隔离级别" tabindex="-1"><a class="header-anchor" href="#事务隔离级别" aria-hidden="true">#</a> 事务隔离级别</h4><h5 id="四种隔离级别" tabindex="-1"><a class="header-anchor" href="#四种隔离级别" aria-hidden="true">#</a> 四种隔离级别</h5><table><thead><tr><th></th><th>丢失更新</th><th>脏读</th><th>不可重复读</th><th>幻读</th></tr></thead><tbody><tr><td>读未提交</td><td>能解决</td><td></td><td></td><td></td></tr><tr><td>读已提交</td><td>能解决</td><td>能解决</td><td></td><td></td></tr><tr><td>可重复读</td><td>能解决</td><td>能解决</td><td>能解决</td><td></td></tr><tr><td>序列化</td><td>能解决</td><td>能解决</td><td>能解决</td><td>能解决</td></tr></tbody></table><ul><li>更低级的隔离级别更容易并发，会有更多的用户可以在同一时间接触到同一数据</li><li>更容易并发也就意味着也就会有更高的性能，但是也会带来更多的问题</li><li>低隔离级别需要用以隔离事务的锁更少</li></ul><h5 id="如何选择" tabindex="-1"><a class="header-anchor" href="#如何选择" aria-hidden="true">#</a> 如何选择</h5><blockquote><p><strong>默认的隔离级别是可重复读</strong></p></blockquote><ul><li>因为这个隔离级别可以解决大部分的问题，除了幻读都可以解决，同时性能也比较良好</li><li>如果业务对幻读没有什么限制的必要，那么直接使用默认设置即可，相对安全的同时也有更高的性能。</li></ul><p>不需要精确的一致性的批量报告或者数据不怎么更新的情况下</p><p>可以使用“读未提交”和“读已提交”的隔离级别，同时还可以获得更高的性能</p><h5 id="修改隔离级别" tabindex="-1"><a class="header-anchor" href="#修改隔离级别" aria-hidden="true">#</a> 修改隔离级别</h5><ul><li>如果是使用程序连接MySQL，需要修改隔离级别。</li><li>那么在修改隔离级别的时候，设置为SESSION级别，即该事务隔离级别只对当前会话或连接有效，不会影响别的连接的事务隔离级别</li></ul><p>查看当前的隔离级别</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> VARIABLES <span class="token operator">LIKE</span> <span class="token string">&#39;transaction_isolation&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>设置下一个事务的隔离级别</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token keyword">TRANSACTION</span> <span class="token keyword">ISOLATION</span> <span class="token keyword">LEVEL</span> SERILAIZABLE<span class="token punctuation">;</span>  <span class="token comment">-- 设置隔离级别为序列化</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>session关键字，为当前会话或连接设置隔离级别</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token keyword">SESSION</span> <span class="token keyword">TRANSACTION</span> <span class="token keyword">ISOLATION</span> <span class="token keyword">LEVEL</span> SERILAIZABLE<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>global关键字，为所有会话中的所有新事物设置全局隔离级别</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> CLOBAL <span class="token keyword">SESSION</span> <span class="token keyword">TRANSACTION</span> <span class="token keyword">ISOLATION</span> <span class="token keyword">LEVEL</span> SERILAIZABLE<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="死锁" tabindex="-1"><a class="header-anchor" href="#死锁" aria-hidden="true">#</a> 死锁</h3><h4 id="什么是死锁" tabindex="-1"><a class="header-anchor" href="#什么是死锁" aria-hidden="true">#</a> 什么是死锁</h4><p>死锁就是当不同事务均因握住了别的事务所需要的“锁”而无法完成的情况</p><p>所以有两个事务都一直在等待对方，并且永远无法释放锁。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">USE</span> sql_store<span class="token punctuation">;</span>
<span class="token keyword">START</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>
<span class="token keyword">UPDATE</span> orders <span class="token keyword">SET</span> <span class="token keyword">status</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">WHERE</span> order_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">UPDATE</span> customers <span class="token keyword">SET</span> state <span class="token operator">=</span> <span class="token string">&#39;VA&#39;</span> <span class="token keyword">WHERE</span> customer_id <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">COMMIT</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-SQL line-numbers-mode" data-ext="SQL"><pre class="language-SQL"><code>USE sql_store;
START TRANSACTION;
UPDATE customers SET state = &#39;VA&#39; WHERE customer_id = 1;
UPDATE orders SET status = 1 WHERE order_id = 1;
COMMIT;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="怎么解决" tabindex="-1"><a class="header-anchor" href="#怎么解决" aria-hidden="true">#</a> 怎么解决</h4><h5 id="mysql的解决方案" tabindex="-1"><a class="header-anchor" href="#mysql的解决方案" aria-hidden="true">#</a> MySQL的解决方案</h5><ul><li>如果发现死锁，MySQL会自动报错，然后将事务进行回退。</li></ul><h5 id="业务编码中的解决方案" tabindex="-1"><a class="header-anchor" href="#业务编码中的解决方案" aria-hidden="true">#</a> 业务编码中的解决方案</h5><ul><li>在业务中，编码实现业务时，如果事务因为死锁而被回退，那么可以<strong>自动重新恢复</strong>，或者<strong>给予用户提示，让用户手动再次提交请求</strong>。</li><li>如果经常在两个事务中监测到死锁，可以检查一下事务中的代码，如果事务中的命令以相反的顺序更新记录，那么就很有可能出现死锁的问题，如果想要<strong>减少死锁</strong>，可以在<strong>更新多条记录的时候遵循相同的顺序</strong></li><li>尽量<strong>简化事务</strong>，<strong>缩小事务的运行时长</strong>，减少与其他事务冲突的机会 。</li><li>如果<strong>事务要基于非常大的表来运行</strong>，那么这些事务可能需要很长时间来运行，会有冲突风险，可以<strong>把那些事务安排在非高峰期时段运行，避开大量活跃用户</strong></li></ul><h2 id="主键和外键" tabindex="-1"><a class="header-anchor" href="#主键和外键" aria-hidden="true">#</a> 主键和外键</h2><h3 id="主键" tabindex="-1"><a class="header-anchor" href="#主键" aria-hidden="true">#</a> 主键</h3><ul><li>不强制定义主键，但最多只能由1个主键</li><li>1个主键可包含多个列</li><li>主键值非空且唯一</li></ul><h4 id="定义主键" tabindex="-1"><a class="header-anchor" href="#定义主键" aria-hidden="true">#</a> 定义主键</h4><p><strong>单主键</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span> <span class="token punctuation">(</span>
  id <span class="token keyword">INT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
  name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>复合主键</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span> <span class="token punctuation">(</span>
  com_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
  user_number <span class="token keyword">INT</span><span class="token punctuation">,</span>
  name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>com_id<span class="token punctuation">,</span> user_number<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="添加主键" tabindex="-1"><a class="header-anchor" href="#添加主键" aria-hidden="true">#</a> 添加主键</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span>
<span class="token keyword">ADD</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="删除主键" tabindex="-1"><a class="header-anchor" href="#删除主键" aria-hidden="true">#</a> 删除主键</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span>
<span class="token keyword">DROP</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="主键值" tabindex="-1"><a class="header-anchor" href="#主键值" aria-hidden="true">#</a> 主键值</h4><ol><li>自增 <ul><li>AUTO INCREMENT</li><li>声明为AUTO INCREMENT的字段会自动生成连续的整数值</li></ul></li><li>UUID <ul><li>UUID()：生成一个长度为 36 个字符的字符串并全局唯一</li><li>UUID_SHORT()：生成一个长度为64 位无符号整数并全局唯一</li></ul></li></ol><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> UUID<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>+--------------------------------------+
<span class="token operator">|</span> UUID<span class="token punctuation">(</span><span class="token punctuation">)</span>                               <span class="token operator">|</span>
+--------------------------------------+
<span class="token operator">|</span> 523efe70-29ac-11ec-a78b-6dba5fac4247 <span class="token operator">|</span>
+--------------------------------------+
<span class="token number">1</span> row <span class="token keyword">in</span> <span class="token builtin class-name">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> UUID_SHORT<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+-------------------+
| UUID_SHORT()      |
+-------------------+
| 99469056502923283 |
+-------------------+
1 row in set (0.00 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>UUID()</strong> 适合用在集群环境下。这样即使一个表被分区在多个服务器上，也不会产生相同的主键的记录。</p><blockquote><p><strong>主键和唯一索引</strong></p></blockquote><ul><li>一个表只能定义一个主键，但是可以定义多个唯一索引</li><li>主键中的值不能为NULL，但唯一索引可以</li></ul><h3 id="外键" tabindex="-1"><a class="header-anchor" href="#外键" aria-hidden="true">#</a> 外键</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CONSTRAINT</span> <span class="token identifier"><span class="token punctuation">`</span>fk_city_country<span class="token punctuation">`</span></span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>country_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>
    <span class="token keyword">REFERENCES</span> <span class="token identifier"><span class="token punctuation">`</span>country<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>country_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span> <span class="token comment">-- REFERENCES 后是被引用的表和列</span>
    <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">RESTRICT</span>  <span class="token comment">-- 指定删除策略</span>
    <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span> <span class="token comment">-- 更新策略</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>**ON DELETE **和 <strong>ON UPDATE</strong>指定了删除或更新被引用的表数据时要采用的约束策略</p><ul><li><strong>CASCADE</strong>：如果被引用的表中的一行被删除或更新，该表中匹配行的值会自动删除或更新。</li><li><strong>SET NULL</strong>：如果被引用的表中的一行被删除或更新，该表中匹配行的值设置为 <strong>NULL</strong>。</li><li><strong>RESTRICT</strong>：如果被引用的表中的一行在该表中有匹配的行，试图删除或更新被引用的表中行时会引发 MySQL 错误 <ul><li>这是默认的策略。</li></ul></li></ul><h4 id="添加外键" tabindex="-1"><a class="header-anchor" href="#添加外键" aria-hidden="true">#</a> 添加外键</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> child_table_name
<span class="token keyword">ADD</span> <span class="token punctuation">[</span><span class="token keyword">CONSTRAINT</span> foreign_key_name<span class="token punctuation">]</span>
  <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token keyword">column</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">REFERENCES</span> parent_table_name <span class="token punctuation">(</span><span class="token keyword">column</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="删除外键" tabindex="-1"><a class="header-anchor" href="#删除外键" aria-hidden="true">#</a> 删除外键</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name
<span class="token keyword">DROP</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> foreign_key_name<span class="token punctuation">;</span>  <span class="token comment">-- 外键名</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name
<span class="token keyword">DROP</span> <span class="token keyword">CONSTRAINT</span> constraint_name<span class="token punctuation">;</span> <span class="token comment">-- 约束名，可以删除任何约束，不止外键</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="自引用外键" tabindex="-1"><a class="header-anchor" href="#自引用外键" aria-hidden="true">#</a> 自引用外键</h4><p>子表和父表可能是同一个表。</p><p>这种表中的外键被称为自引用外键。</p><p>通常，自引用外键定义在表示树形数据结构的表中</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> category <span class="token punctuation">(</span>
  category_id <span class="token keyword">INT</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
  category_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  parent_category_id <span class="token keyword">INT</span><span class="token punctuation">,</span>
  <span class="token keyword">CONSTRAINT</span> fk_category <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>parent_category_id<span class="token punctuation">)</span>
    <span class="token keyword">REFERENCES</span> category <span class="token punctuation">(</span>category_id<span class="token punctuation">)</span>
    <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">RESTRICT</span>
    <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这个表实现了一个无限层级的分类树。一个分类可以有多个子分类，一个子分类可以有 0 个或者 1 个父类</p><ul><li>例如：员工表，员工的领导也是员工</li></ul><h4 id="启用或禁用外键约束" tabindex="-1"><a class="header-anchor" href="#启用或禁用外键约束" aria-hidden="true">#</a> 启用或禁用外键约束</h4><p>要禁用外键约束，请使用以下语句：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> foreign_key_checks <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>要启用外键约束，请使用以下语句：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> foreign_key_checks <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p><strong>禁用外键约束在批量导入数据的时候很有用。</strong></p></blockquote><h4 id="外键关联" tabindex="-1"><a class="header-anchor" href="#外键关联" aria-hidden="true">#</a> 外键关联</h4><p>外键就是关联表的主键，一般情况下，主键是不会修改的，也就是当前表引用的外键(主键)不会修改，但是，如果需要修改怎么办？ 有四个选项</p><ul><li>RESTRICT：限制，如果存在引用该主键的外键，那么就会拒绝更新该主键</li><li>CASCADE：级联更新，如果主键改变了，那么引用该主键的外键也随之改变</li><li>SET NULL：如果引用的外简值被改变，则设置为NULL</li><li>NO ACTION： 无操作，和使用RESTRICT可以看作是等效的，都不允许对具有外键引用的列进行更新</li></ul><p>那么，如果具有外键引用的列想要删除数据怎么办？ 选择上面的 RESTRICT 和 NO ACTION 都会拒绝删除有外键引用的主键。更新时使用CASCADE。</p><h2 id="操作数据库" tabindex="-1"><a class="header-anchor" href="#操作数据库" aria-hidden="true">#</a> 操作数据库</h2><h3 id="创建数据库" tabindex="-1"><a class="header-anchor" href="#创建数据库" aria-hidden="true">#</a> 创建数据库</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> {<span class="token keyword">DATABASE</span> <span class="token operator">|</span> <span class="token keyword">SCHEMA</span>} <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> database_name
<span class="token punctuation">[</span><span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> charset_name<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token keyword">COLLATE</span> collation_name<span class="token punctuation">]</span>
<span class="token punctuation">[</span>ENCRYPTION {<span class="token string">&#39;Y&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;N&#39;</span>}<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">DATABASE</span><span class="token punctuation">;</span> <span class="token comment">-- 查看数据库列表</span>
<span class="token keyword">SHOW</span> <span class="token keyword">CREATE</span> <span class="token keyword">DATABASE</span> newdb<span class="token punctuation">;</span> <span class="token comment">-- 查看创建数据库的信息 </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>CREATE DATABASE</strong> 和 <strong>CREATE SCHEMA</strong> 的是一样的。</li><li><strong>CREATE DATABASE</strong> 后指定要创建的数据库的名字。</li><li><strong>IF NOT EXISTS</strong> 表示在指定的数据库不存在的情况下才创建。它是可选的。</li><li><strong>CHARACTER SET charset_name</strong> 指定数据库的字符集。它是可选的。默认使用数据库服务器的配置。</li><li><strong>COLLATE collation_name</strong> 指定数据库的排序规则。它是可选的。默认使用数据库服务器的配置。</li><li><strong>ENCRYPTION</strong> 指定数据库的是否加密。它是可选的。默认使用数据库服务器的配置。</li></ul><p>MySQL <u>数据库命名的要求</u>：</p><ul><li>数据库的名字最长为 64 个字符。名字的长度还取决于操作系统。</li><li>数据库名可以由字母、数字、下划线、美元符号组成。</li></ul><h3 id="删除数据库" tabindex="-1"><a class="header-anchor" href="#删除数据库" aria-hidden="true">#</a> 删除数据库</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> {<span class="token keyword">DATABASE</span> <span class="token operator">|</span> <span class="token keyword">SCHEMA</span>} <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> database_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><strong>DROP DATABASE</strong> 和 <strong>DROP SCHEMA</strong> 是一样的。</li><li><strong>DROP DATABASE</strong> 关键字后指定要删除的数据库的名称。</li><li><strong>IF EXISTS</strong> 选项可以避免删除不存在数据库时发生的错误。它是可选的。</li></ul><p><strong>DROP DATABASE</strong> 语句返回它删除的表数。</p><h3 id="选择数据库" tabindex="-1"><a class="header-anchor" href="#选择数据库" aria-hidden="true">#</a> 选择数据库</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">USE</span> database_name<span class="token punctuation">;</span> <span class="token comment">-- 切换数据库</span>
<span class="token keyword">SELECT</span> <span class="token keyword">DATABASE</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">-- 查看当前数据库</span>
<span class="token keyword">STATUS</span> <span class="token comment">-- 查看当前数据库</span>
mysql <span class="token operator">-</span>u root <span class="token operator">-</span>p <span class="token operator">-</span>D testdb <span class="token comment">-- 登录时指定数据库</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="操作表" tabindex="-1"><a class="header-anchor" href="#操作表" aria-hidden="true">#</a> 操作表</h2><h3 id="创建表" tabindex="-1"><a class="header-anchor" href="#创建表" aria-hidden="true">#</a> 创建表</h3><h4 id="语法-17" tabindex="-1"><a class="header-anchor" href="#语法-17" aria-hidden="true">#</a> 语法</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> table_name <span class="token punctuation">(</span>
   column_name data_type <span class="token punctuation">[</span><span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">DEFAULT</span> expr<span class="token punctuation">]</span><span class="token punctuation">,</span>
   column_name data_type <span class="token punctuation">[</span><span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token keyword">DEFAULT</span> expr<span class="token punctuation">]</span><span class="token punctuation">,</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
   <span class="token punctuation">[</span>table_constraints<span class="token punctuation">]</span>
<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token keyword">ENGINE</span><span class="token operator">=</span>storage_engine<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>CREATE TABLE</strong> 语句创建一个给定名字 <strong>table_name</strong> 的表。 <ul><li>表名可由字母、数字、下划线和美元符号组成，表名长度在 64 个字符以内。</li><li>表名在一个数据库中是唯一的。</li><li>新建的表会在当前默认的数据库中。如果还没有选择数据库，请使用 <strong>db_name.table_name</strong> 格式指定要新建的表所在的数据库。</li></ul></li><li><strong>IF NOT EXISTS</strong> 指示只有给定的表不存在的时候才进行创建。它是可选的。如果你给定一个已经存在的表名，又没有使用 <strong>IF NOT EXISTS</strong> 子句，服务器会返回一个错误。</li><li><strong>column_name data_type [NOT NULL | NULL] [DEFAULT expr] [AUTO_INCREMENT]</strong> 定义了表中的一列。多个列使用逗号分隔。 <ul><li><strong>column_name</strong> 是列的名字 <ul><li>列名可由字母、数字、下划线和美元符号组成</li><li>列名长度在 64 个字符以内。列名在一个表中是唯一的。</li></ul></li><li><strong>data_type</strong> 是数据类型</li><li><strong>[NOT NULL | NULL]</strong> 指示该列是否可以为 <strong>NULL</strong>。 <ul><li>它是可选的。如果不指定该选项，则此列可以为 <strong>NULL</strong>。</li><li>如果设置为 <strong>NOT NULL</strong>，则插入新行时该列必须有值。</li></ul></li><li><strong>[DEFAULT expr]</strong> 指示该列的默认值。它是可选的。 <ul><li>如果不指定该选项，则此列的默认是 <strong>NULL</strong>。</li></ul></li><li><strong>[AUTO_INCREMENT]</strong> 指示该列是否是一个自增列。 <ul><li>如果使用了此选项，则该列的值可有服务器自动产生和填充。</li><li>该列的值从 <strong>1</strong> 开始，每增加一个行就会加 <strong>1</strong>。一个表中只能有一个自增列。</li></ul></li></ul></li><li><strong>[table_constraints]</strong> 位于列定义之后，它定义了表的约束，它是可选的。 <ul><li>表的约束有主键、外键、CHECK、UNIQUE 等。</li></ul></li><li><strong>ENGINE=storage_engine</strong> 子句指定了表使用的存储引擎。它是可选的。 <ul><li>如果不指定此选项，则采用服务器默认的存储引擎。</li><li>自 MySQL 5.5 版以来，服务器默认的引擎是由 MyISAM 变成了 InnoDB。</li><li>当表名或者字段名中含有空格或者其他特殊字字符时，用`包裹起来 <ul><li>比如：`test1`</li></ul></li></ul></li></ul><div class="language-SQL line-numbers-mode" data-ext="SQL"><pre class="language-SQL"><code>CREATE TABLE ... LIKE
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> new_table <span class="token operator">LIKE</span> original_table<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>可以使用CREATE TABLE ... LIKE 语句来克隆另一个表的定义，包含了原表中定义的列属性和索引。</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">SELECT</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> new_table <span class="token punctuation">[</span><span class="token keyword">AS</span><span class="token punctuation">]</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> original_table<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>使用 CREATE TABLE ... SELECT 从另一个表创建一个新表</li><li>该语句依据SELECT子句中的列创建新表，并将SELECT 的结果插到新表中</li></ul><h4 id="实例-17" tabindex="-1"><a class="header-anchor" href="#实例-17" aria-hidden="true">#</a> 实例</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span> <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>name<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>age<span class="token punctuation">`</span></span> <span class="token keyword">INT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>locked<span class="token punctuation">`</span></span> <span class="token keyword">TINYINT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>created_at<span class="token punctuation">`</span></span> <span class="token keyword">DATETIME</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token identifier"><span class="token punctuation">`</span>testdb<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>user_hobby<span class="token punctuation">`</span></span> <span class="token punctuation">(</span>
  <span class="token identifier"><span class="token punctuation">`</span>hobby_id<span class="token punctuation">`</span></span> <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span> <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>hobby<span class="token punctuation">`</span></span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token identifier"><span class="token punctuation">`</span>created_at<span class="token punctuation">`</span></span> <span class="token keyword">DATETIME</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">INDEX</span> <span class="token identifier"><span class="token punctuation">`</span>fk_user_idx<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span> <span class="token keyword">ASC</span><span class="token punctuation">)</span> VISIBLE<span class="token punctuation">,</span> <span class="token comment">-- 创建索引</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>hobby_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
  <span class="token keyword">CONSTRAINT</span> <span class="token identifier"><span class="token punctuation">`</span>fk_user<span class="token punctuation">`</span></span> <span class="token comment">-- 给外键指定名字</span>
    <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>  <span class="token comment">-- 当前表的外键列</span>
    <span class="token keyword">REFERENCES</span> <span class="token identifier"><span class="token punctuation">`</span>testdb<span class="token punctuation">`</span></span><span class="token punctuation">.</span><span class="token identifier"><span class="token punctuation">`</span>user<span class="token punctuation">`</span></span> <span class="token punctuation">(</span><span class="token identifier"><span class="token punctuation">`</span>user_id<span class="token punctuation">`</span></span><span class="token punctuation">)</span>  <span class="token comment">-- 关联的外键</span>
    <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span>  <span class="token comment">-- 级联删除</span>
    <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">RESTRICT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- 拒绝更新有外键引用的列</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>user_hobby 表的约束有：</p><ul><li><code>PRIMARY KEY (hobby_id)</code> 子句表明 <code>hobby_id</code> 列是主键。</li><li><code>INDEX fk_user_idx</code> 设定了在 <code>user_id</code>列上建立索引。</li><li><code>CONSTRAINT fk_user</code> 设定了一个外键。这个外键将 <code>user_id</code> 列引用了 <code>user</code> 表的 <code>user_id</code> 列</li></ul><h3 id="删除表" tabindex="-1"><a class="header-anchor" href="#删除表" aria-hidden="true">#</a> 删除表</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span>
  table_name <span class="token punctuation">[</span><span class="token punctuation">,</span> table_name<span class="token punctuation">]</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>DROP TABLE</strong> 关键字后面是要删除的表名。如果要删除多个表，请使用逗号分隔表名。</li><li><strong>IF EXISTS</strong> 选项避免了删除不存在的表时发生的错误。它是可选的。当要删除的表中有不存在的表时： <ul><li>有 <strong>IF EXISTS</strong> 选项，不会对不存在的表报错。该语句会删除存在的表，并给出不存在的表的提示。</li><li>没有 <strong>IF EXISTS</strong> 选项，该语句运行失败带有一个指示不能移除不存在的表的错误。该语句不会删除任何表。</li></ul></li><li><strong>DROP TABLE</strong> 删除表的定义和表中的数据，以及表上触发器。</li><li>你需要具有要删除的每一个表的 <strong>DROP</strong> 权限。</li></ul><h3 id="修改表" tabindex="-1"><a class="header-anchor" href="#修改表" aria-hidden="true">#</a> 修改表</h3><h4 id="语法-18" tabindex="-1"><a class="header-anchor" href="#语法-18" aria-hidden="true">#</a> 语法</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name
  <span class="token punctuation">[</span>alter_action options<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>其中 <strong>alter_action</strong> 是一个修改动作，包括：</p><ul><li><strong>ADD</strong> 关键字可用来添加列、索引、约束等，包括： <ul><li><strong>ADD [COLUMN]</strong>: 添加列</li><li><strong>ADD INDEX</strong>: 添加索引</li><li><strong>ADD PRIMARY KEY</strong>: 添加主键</li><li><strong>ADD FOREIGN KEY</strong>: 添加外键</li><li><strong>ADD UNIQUE INDEX</strong>: 添加唯一索引</li><li><strong>ADD CHECK</strong>: 添加检查约束</li></ul></li><li><strong>DROP</strong> 关键字可用来删除列、索引、约束等，包括： <ul><li><strong>DROP [COLUMN] col_name</strong>: 删除列</li><li><strong>ADD INDEX index_name</strong>: 删除索引</li><li><strong>DROP PRIMARY KEY</strong>: 删除主键</li><li><strong>DROP FOREIGN KEY fk_symbol</strong>: 删除外键</li><li><strong>DROP CHECK symbol</strong>: 删除检查约束</li></ul></li><li><strong>MODIFY</strong> 关键字用来修改列的定义。与 <strong>CHANGE</strong> 关键字不同，它不能重命名列。例如: <strong>MODIFY [COLUMN] col_name column_definition</strong>。</li><li><strong>CHANGE</strong> 关键字用来修改列的定义。与 <strong>MODIFY</strong> 关键字不同，它可以重命名列。例如: <strong>CHANGE [COLUMN] old_col_name new_col_name column_definition</strong>。</li><li><strong>RENAME</strong> 关键字可以重命名列、索引和表。包括： <ul><li><strong>RENAME COLUMN old_col_name TO new_col_name</strong>: 重命名列。</li><li><strong>RENAME INDEX old_index_name TO new_index_name</strong>: 重命名索引。</li><li><strong>RENAME new_tbl_name</strong>: 重命名表。</li></ul></li></ul><h4 id="实例-18" tabindex="-1"><a class="header-anchor" href="#实例-18" aria-hidden="true">#</a> 实例</h4><h5 id="添加一列" tabindex="-1"><a class="header-anchor" href="#添加一列" aria-hidden="true">#</a> 添加一列</h5><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span>
<span class="token keyword">ADD</span> name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>注意，当向包含数据的表中添加列时，新添加的列不满足表的约束定义，则会返回错误。</p><h5 id="添加多列" tabindex="-1"><a class="header-anchor" href="#添加多列" aria-hidden="true">#</a> 添加多列</h5><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span>
<span class="token keyword">ADD</span> age <span class="token keyword">INT</span><span class="token punctuation">,</span>
<span class="token keyword">ADD</span> email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="重命名列" tabindex="-1"><a class="header-anchor" href="#重命名列" aria-hidden="true">#</a> 重命名列</h5><p>以下语句使用 <strong>RENAME COLUMN</strong> 关键字，将 <strong>user</strong> 表的 <strong>name</strong> 列重命名为 <strong>username</strong>。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span>
<span class="token keyword">RENAME</span> <span class="token keyword">COLUMN</span> name <span class="token keyword">TO</span> username<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="修改列定义" tabindex="-1"><a class="header-anchor" href="#修改列定义" aria-hidden="true">#</a> 修改列定义</h5><p>以下语句使用 <strong>MODIFY</strong> 关键字，将 <strong>user</strong> 表的 <strong>username</strong> 列由 <strong>varchar(20)</strong> 修改为 <strong>VARCHAR(45)</strong>。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span>
<span class="token keyword">MODIFY</span> username <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="修改列名和定义" tabindex="-1"><a class="header-anchor" href="#修改列名和定义" aria-hidden="true">#</a> 修改列名和定义</h5><p>以下语句使用 <strong>CHANGE</strong> 关键字，将 <strong>user</strong> 表的 <strong>username</strong> 列修改为 <strong>name VARCHAR(30)</strong>。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span>
CHANGE username name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="添加主键-1" tabindex="-1"><a class="header-anchor" href="#添加主键-1" aria-hidden="true">#</a> 添加主键</h5><p>以下语句使用 <strong>ADD</strong> 关键字，将 <strong>user</strong> 表的 <strong>id</strong> 列设置为主键。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span>
<span class="token keyword">ADD</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>注意，由于主键要求列的值是唯一的并且不能为 <strong>NULL</strong>，如果该列中有重复的值或者 <strong>NULL</strong> 值，则会返回错误。同样，如果你添加唯一索引，也可能会出现相同的错误。</p><h5 id="删除列" tabindex="-1"><a class="header-anchor" href="#删除列" aria-hidden="true">#</a> 删除列</h5><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span>
<span class="token keyword">DROP</span> <span class="token keyword">COLUMN</span> email<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="重命名表" tabindex="-1"><a class="header-anchor" href="#重命名表" aria-hidden="true">#</a> 重命名表</h5><p>下面语句使用 <strong>RENAME</strong> 关键字将 <strong>user</strong> 表重命名为 <strong>users</strong>。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span>
<span class="token keyword">RENAME</span> users<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">RENAME</span> <span class="token keyword">TABLE</span> table_name <span class="token keyword">TO</span> new_table_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">RENAME</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span> <span class="token keyword">TO</span> users<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="注意事项" tabindex="-1"><a class="header-anchor" href="#注意事项" aria-hidden="true">#</a> 注意事项</h5><p>重命名表是一个简单的动作，但是它可能会带来一系列的问题</p><p>如果没有同步修改那些用到此表的代码，则他们可能不能正常运行。需要同步修改的代码可能包括：</p><ol><li>那些使用了此表的存储过程。</li><li>那些使用了此表的视图</li><li>那些使用了此表的函数。</li><li>那些使用了此表的触发器</li><li>那些使用了此表的外键约束 (在较旧的 MySQL 版本中)。</li><li>那些使用了此表的应用程序。</li></ol><p>打算修改一个表名的时候，需要首先从整体上进行评估。</p><p>再决定是否进行重命名表。</p><p>一旦决定了要重命名一个表，需要把需要同步修改的地方整理清楚。</p><h3 id="清空表" tabindex="-1"><a class="header-anchor" href="#清空表" aria-hidden="true">#</a> 清空表</h3><h4 id="用法-1" tabindex="-1"><a class="header-anchor" href="#用法-1" aria-hidden="true">#</a> 用法</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">TRUNCATE</span> <span class="token punctuation">[</span><span class="token keyword">TABLE</span><span class="token punctuation">]</span> table_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>其中 <strong>TABLE</strong> 关键字是可选的。也就是说， <strong>TRUNCATE t;</strong> 和 <strong>TRUNCATE TABLE t;</strong> 是等效的。</p><p><strong>TRUNCATE TABLE</strong> 语句相当于<u><strong>先将此表删除掉，再创建一个新表</strong></u>。<strong>TRUNCATE TABLE</strong> 语句需要对操作的表具有 <strong>DROP</strong> 权限。</p><h5 id="truncate-与-delete-区别" tabindex="-1"><a class="header-anchor" href="#truncate-与-delete-区别" aria-hidden="true">#</a> TRUNCATE 与 DELETE 区别</h5><ul><li><strong>TRUNCATE</strong> 被归类为 DDL 语句，而 <strong>DELETE</strong> 被归类为 DML 语句。</li><li><strong>TRUNCATE</strong> 操作无法被回滚，而 <strong>DELETE</strong> 可以被回滚。因为它相当于删除并重建表。</li><li><strong>TRUNCATE</strong> 操作删除和重建表，它的速度比 <strong>DELETE</strong> 快得多。</li><li><strong>TRUNCATE</strong> 操作会重置表的自增值，而 <strong>DELETE</strong> 不会。</li><li><strong>TRUNCATE</strong> 操作不会激活删除触发器，而 <strong>DELETE</strong> 会。</li><li><strong>TRUNCATE</strong> 操作不返回代表删除行的数量的值，它通常返回 <strong>0 rows affected</strong>。<strong>DELETE</strong> 返回删除的行数。</li><li>如果一个表被其他表的外键引用，对此表的 <strong>TRUNCATE</strong> 操作会失败。</li></ul><blockquote><p>性能上，循环删除1000000行记录，总共耗时1s，但是使用TRUNCATE只用0.02秒</p></blockquote><h3 id="表锁" tabindex="-1"><a class="header-anchor" href="#表锁" aria-hidden="true">#</a> 表锁</h3><h4 id="lock-tables" tabindex="-1"><a class="header-anchor" href="#lock-tables" aria-hidden="true">#</a> LOCK TABLES</h4><p>要为当前会话显式地获取表锁，请按照以下语法使用 <strong>LOCK TABLES</strong> 语句：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">LOCK</span> <span class="token keyword">TABLES</span>
    table_name <span class="token punctuation">[</span><span class="token keyword">READ</span> <span class="token operator">|</span> <span class="token keyword">WRITE</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token punctuation">,</span> table_name <span class="token punctuation">[</span><span class="token keyword">READ</span> <span class="token operator">|</span> <span class="token keyword">WRITE</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>table_name</strong> 是您要获取锁的表名。</li><li><strong>READ</strong> 和 <strong>WRITE</strong> 是锁类型。 <strong>READ</strong> 锁用于共享读取表， <strong>WRITE</strong> 锁用于排斥的读写表。</li><li>您可以在一个语句中获取多个表的锁。多个表锁之间使用逗号分隔。</li><li><strong>LOCK TABLES</strong> 语句在获取新的表锁之前会隐式的释放当前会话持有的所有的表锁。</li><li>您可以使用 <strong>LOCK TABLE</strong> 代替 <strong>LOCK TABLES</strong>。</li></ul><h4 id="unlock-tables" tabindex="-1"><a class="header-anchor" href="#unlock-tables" aria-hidden="true">#</a> UNLOCK TABLES</h4><p>要释放当前会话获取的所有的表锁，请使用以下语句：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">UNLOCK</span> <span class="token keyword">TABLES</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="锁类型" tabindex="-1"><a class="header-anchor" href="#锁类型" aria-hidden="true">#</a> 锁类型</h4><p>表锁支持 <strong>READ</strong> 和 <strong>WRITE</strong> 两种类型的锁。 <strong>READ</strong> 锁用于共享读取表， <strong>WRITE</strong> 锁用于排斥的读写表，他们的特点如下：</p><h5 id="read-锁" tabindex="-1"><a class="header-anchor" href="#read-锁" aria-hidden="true">#</a> READ 锁</h5><blockquote><p>READ表锁不需要显式获取，不管有没有获取锁，都没法写数据，要等到锁被释放才行。也就是说，只要有人在读数据，READ锁被持有，就没有办法写数据</p></blockquote><ul><li>持有表锁的会话只能读取表，但不能写入表。</li><li>多个会话可以同时获取一个表的 <strong>READ</strong> 锁。</li><li>其他会话无需显式获取 <strong>READ</strong> 锁即可读取该表，但是不能写入表。其他会话的写操作会一直等待直到读锁被释放。</li></ul><h5 id="write-锁" tabindex="-1"><a class="header-anchor" href="#write-锁" aria-hidden="true">#</a> WRITE 锁</h5><ul><li>持有锁的会话可以读写表。</li><li>只有持有锁的会话才能访问该表。在释放锁之前，没有其他会话可以访问它。</li><li>持有 <strong>WRITE</strong> 锁时，其他会话对表的锁请求会阻塞。</li></ul><p>如果您没有显式地的释放表锁，当会话结束后，无论是 <strong>READ</strong> 锁还是 <strong>WRITE</strong> 锁，都会被 MySQL 释放掉。</p><h3 id="生成列" tabindex="-1"><a class="header-anchor" href="#生成列" aria-hidden="true">#</a> 生成列</h3><ul><li>虚拟生成列： <ul><li>列值不会被存储下来，当读取该列的时候，MySQL自动计算该列的值</li><li>每次读操作的时候都会被重新计算，因为时使用SELECT查询生成的</li></ul></li><li>存储生成列： <ul><li>当插入或修改数据时，MySQL自动计算该列的值并存储在磁盘上</li><li>不能直接写入或者更新生成列的值</li><li>每次插入或修改的时候被计算</li></ul></li></ul><p>如果数据经常变动，使用虚拟列，如果数据创建后不经常变动，那么使用存储生成列</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> order_item <span class="token punctuation">(</span>
  order_item_id <span class="token keyword">INT</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
  goods <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  price <span class="token keyword">DECIMAL</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  quantity <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
  goods<span class="token punctuation">,</span>
  price<span class="token punctuation">,</span>
  quantity<span class="token punctuation">,</span>
  <span class="token punctuation">(</span>price <span class="token operator">*</span> quantity<span class="token punctuation">)</span> <span class="token keyword">AS</span> total_amount  <span class="token comment">-- 虚拟生成列</span>
<span class="token keyword">FROM</span> order_item<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> order_item
<span class="token keyword">ADD</span> <span class="token keyword">COLUMN</span> total_amount <span class="token keyword">DECIMAL</span>
  GENERATED ALWAYS <span class="token keyword">AS</span> <span class="token punctuation">(</span>price <span class="token operator">*</span> quantity<span class="token punctuation">)</span> STORED<span class="token punctuation">;</span>
<span class="token comment">-- 添加一列，列的值由表中的值计算得来</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="约束" tabindex="-1"><a class="header-anchor" href="#约束" aria-hidden="true">#</a> 约束</h2><h3 id="unique" tabindex="-1"><a class="header-anchor" href="#unique" aria-hidden="true">#</a> UNIQUE</h3><p>与主键相比，主键用于表示行的唯一性，唯一键用来保证列的唯一性</p><ul><li>用户表中有登录名或电子邮件列是唯一的。</li><li>产品表中的产品编号列是唯一的。</li><li>订单表中有订单编号列是唯一的。</li><li>每天的统计报表中将 年、月、日 三个列作为组合唯一键。</li></ul><p>主键列不能包含 <code>NULL</code> 值，而唯一键列可以包含 <code>NULL</code> 值。</p><h4 id="定义一列为唯一键" tabindex="-1"><a class="header-anchor" href="#定义一列为唯一键" aria-hidden="true">#</a> 定义一列为唯一键</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> table_name<span class="token punctuation">(</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
    column_name data_type <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="定义多列为唯一键" tabindex="-1"><a class="header-anchor" href="#定义多列为唯一键" aria-hidden="true">#</a> 定义多列为唯一键</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> table_name<span class="token punctuation">(</span>
   column_name1 column_definition<span class="token punctuation">,</span>
   column_name2 column_definition<span class="token punctuation">,</span>
   <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
   <span class="token punctuation">[</span><span class="token keyword">CONSTRAINT</span> constraint_name<span class="token punctuation">]</span>
      <span class="token keyword">UNIQUE</span><span class="token punctuation">(</span>column_name1<span class="token punctuation">,</span>column_name2<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>UNIQUE</strong> 关键子后的括号中包含了逗号分隔的多个列。</li><li><strong>CONSTRAINT constraint_name</strong> 用于定义一个约束的名称。 它是可选的。如果不定义约束名称， MySQL 会自动为他生成一个。</li></ul><h4 id="添加唯一键" tabindex="-1"><a class="header-anchor" href="#添加唯一键" aria-hidden="true">#</a> 添加唯一键</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name
<span class="token keyword">ADD</span> <span class="token punctuation">[</span><span class="token keyword">CONSTRAINT</span> constraint_name<span class="token punctuation">]</span> <span class="token keyword">UNIQUE</span> <span class="token punctuation">(</span>column_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>注意，如果现有表中的要设置为唯一键的列中已有重复数据，MySQL 服务器会返回错误。</p><h4 id="删除唯一键" tabindex="-1"><a class="header-anchor" href="#删除唯一键" aria-hidden="true">#</a> 删除唯一键</h4><p>要从表上删除唯一键，你可以使用<a href="https://www.sjkjc.com/mysql/table-alter/" target="_blank" rel="noopener noreferrer">修改表<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>语句或者删除索引语句：</p><ul><li><strong>ALTER TABLE table_name DROP CONSTRAINT constraint_name</strong></li><li><strong>ALTER TABLE table_name DROP INDEX index_name</strong></li><li><strong>DROP INDEX index_name ON table_name</strong></li></ul><h3 id="not-null" tabindex="-1"><a class="header-anchor" href="#not-null" aria-hidden="true">#</a> NOT NULL</h3><p>在 MySQL 中，<code>NOT NULL</code> 用来约束列中的值不能为 <code>NULL</code> 值。</p><h4 id="定义-not-null-列" tabindex="-1"><a class="header-anchor" href="#定义-not-null-列" aria-hidden="true">#</a> 定义 NOT NULL 列</h4><p>请使用以下语法定义一个 <strong>NOT NULL</strong> 列：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> table_name <span class="token punctuation">(</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
  column_name data_type <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
  <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="添加-not-null-约束" tabindex="-1"><a class="header-anchor" href="#添加-not-null-约束" aria-hidden="true">#</a> 添加 NOT NULL 约束</h4><p>要向现有的列添加 <strong>NOT NULL</strong>约束，请使用以下语法修改列的定义：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name
<span class="token keyword">MODIFY</span> column_name data_type <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>这里，在列的定义上添加 <strong>NOT NULL</strong> 关键字。</p><h4 id="删除-not-null-约束" tabindex="-1"><a class="header-anchor" href="#删除-not-null-约束" aria-hidden="true">#</a> 删除 NOT NULL 约束</h4><p>要删除列上的 <strong>NOT NULL</strong> 约束，请使用以下语法修改列的定义：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name
<span class="token keyword">MODIFY</span> column_name data_type <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="check" tabindex="-1"><a class="header-anchor" href="#check" aria-hidden="true">#</a> CHECK</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CHECK</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><code>expr</code>：表达式，针对一行数据进行计算 <ul><li>如果为真，则允许插入；否则拒绝插入并报错</li></ul></li></ul><ul><li>如果你在列定义中使用 <strong>CHECK</strong> 约束，则 <strong>CHECK</strong> 表达式只能引用此列。</li><li>如果你在使用独立的 <strong>CHECK</strong> 约束，则 <strong>CHECK</strong> 表达式可以应用表上的所有列。</li></ul><h4 id="实例-19" tabindex="-1"><a class="header-anchor" href="#实例-19" aria-hidden="true">#</a> 实例</h4><p>下面以 age 列需要大于 0 为例，使用不同的方法添加此约束：</p><ul><li>在创建表的时候在列定义中使用 <strong>CHECK</strong> 约束</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span> <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    age <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">CHECK</span><span class="token punctuation">(</span>age <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>在创建表的时候在表上定义 <strong>CHECK</strong> 约束</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span> <span class="token punctuation">(</span>
    id <span class="token keyword">INT</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    age <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
    <span class="token keyword">CONSTRAINT</span> <span class="token keyword">CHECK</span><span class="token punctuation">(</span>age <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>使用修改表语句的为表添加 <strong>CHECK</strong> 约束</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span>
<span class="token keyword">ADD</span> <span class="token keyword">CONSTRAINT</span> <span class="token keyword">CHECK</span><span class="token punctuation">(</span>age <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="索引" tabindex="-1"><a class="header-anchor" href="#索引" aria-hidden="true">#</a> 索引</h2><h3 id="索引基础" tabindex="-1"><a class="header-anchor" href="#索引基础" aria-hidden="true">#</a> 索引基础</h3><h4 id="概念" tabindex="-1"><a class="header-anchor" href="#概念" aria-hidden="true">#</a> 概念</h4><ul><li>索引可以提高堆表的数据检索速度</li><li>索引类似于词典中的目录</li><li>索引是一种数据结构，例如B-Tree，但需要额外的写入和存储来维护索引</li><li>查询优化器可以使用索引来快速定位数据，不用针对给定查询扫描表中的每一行</li><li>使用主键或唯一键创建表，那么MySQL会自动创建一个名为PRIMARY的索引，也就是聚集索引</li><li>PRIMARY索引是特殊的，因为索引本身与数据一起存储在同一个表中，聚集索引强制执行表中行的顺序</li><li>PRIMARY索引以外的其他索引称为二级索引（非聚集索引）</li></ul><h4 id="mysql索引类型" tabindex="-1"><a class="header-anchor" href="#mysql索引类型" aria-hidden="true">#</a> MySQL索引类型</h4><ul><li>如果不指定索引类型，MySQL将创建B-Tree索引</li><li>下面是基于表存储引擎允许的索引类型</li></ul><table><thead><tr><th><strong>存储引擎</strong></th><th><strong>允许的索引类型</strong></th></tr></thead><tbody><tr><td>InnoDB</td><td><strong>BTREE</strong></td></tr><tr><td>MyISAM</td><td><strong>BTREE</strong></td></tr><tr><td>MEMORY/HEAP</td><td><strong>HASH</strong>, <strong>BTREE</strong></td></tr></tbody></table><h3 id="操作索引" tabindex="-1"><a class="header-anchor" href="#操作索引" aria-hidden="true">#</a> 操作索引</h3><h4 id="创建索引" tabindex="-1"><a class="header-anchor" href="#创建索引" aria-hidden="true">#</a> 创建索引</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token punctuation">[</span><span class="token keyword">UNIQUE</span><span class="token punctuation">]</span> <span class="token keyword">INDEX</span> index_name
<span class="token punctuation">[</span><span class="token keyword">USING</span> {<span class="token keyword">BTREE</span> <span class="token operator">|</span> <span class="token keyword">HASH</span>}<span class="token punctuation">]</span>
<span class="token keyword">ON</span> table_name <span class="token punctuation">(</span>column_list<span class="token punctuation">)</span>
<span class="token punctuation">[</span>algorithm_option <span class="token operator">|</span> lock_option<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><strong>UNIQUE</strong> 关键字表明此索引为唯一索引。它是可选的。</p></li><li><p><strong>index_name</strong> 是索引的名字。一个表中不应该出现两个相同名字的索引。</p></li><li><p><strong>table_name</strong> 是表的名字。</p></li><li><p><strong>column_list</strong> 是表中的列名。多个列名使用逗号分隔。</p></li><li><p><strong>USING</strong> 子句指定索引的类型。可选值：<strong>BTREE</strong>，<strong>HASH</strong>。 它是可选的。</p></li><li><p><strong>algorithm_option</strong> 指定删除索引的算法。<code>ALGORITHM [=] {DEFAULT | INPLACE | COPY}</code></p><ul><li><p><strong>ALGORITHM</strong> 子句是可选的。</p></li><li><p>默认为 <strong>INSTANT</strong>。如果不支持 <strong>INSTANT</strong>，则使用 <strong>INPLACE</strong>。使用 <strong>DEFAULT</strong> 和省略 <strong>ALGORITHM</strong> 子句效果相同。</p><ul><li><p><strong>COPY</strong>：对原表的副本进行操作，将原表中的表数据逐行复制到新表中。不允许并发 DML。</p></li><li><p><strong>INPLACE</strong>: 操作避免复制表数据，但可能会就地重建表。在操作的准备和执行阶段，可能会短暂地对表进行独占元数据锁定。通常，支持并发 DML。</p></li><li><p><strong>INSTANT</strong>: 操作只修改数据字典中的元数据。在操作的执行阶段，可能会短暂地对表进行独占元数据锁定。表数据不受影响，使操作瞬间完成。允许并发 DML。（在 MySQL 8.0.12 中引入）</p></li></ul></li></ul></li><li><p><strong>lock_option</strong> 指定删除索引的并发控制策略。<code>LOCK [=] {DEFAULT | NONE | SHARED | EXCLUSIVE}</code></p><ul><li><strong>LOCK</strong> 子句是可选的。以下是对各个并发策略的说明： <ul><li><strong>DEFAULT</strong>：给定 <strong>ALGORITHM</strong> 子句（如果有）和 <strong>ALTER TABLE</strong> 操作的最大并发级别：如果支持，则允许并发读取和写入。如果不是，则允许并发读取（如果支持）。如果不是，则强制执行独占访问。</li><li><strong>NONE</strong>：如果支持，允许并发读取和写入。否则，会发生错误。</li><li><strong>SHARED</strong>：如果支持，允许并发读取但阻止写入。即使存储引擎支持给<strong>GORITHM</strong> 子句（如果有）和 <strong>ALTER TABLE</strong> 操作的并发写入，写入也会被阻止。如果不支持并发读取，则会发生错误。</li><li><strong>EXCLUSIVE</strong>：强制执行独占访问。即使存储引擎支持给定 <strong>ALGORITHM</strong> 子句（如果有）和 <strong>ALTER TABLE</strong> 操作的并发读/写，也会这样做。</li></ul></li></ul></li></ul><blockquote><p>在 MySQL 内部，<strong>CREATE INDEX</strong> 语句被映射为 <code>ALTER TABLE ... ADD INDEX ...</code> 语句</p></blockquote><h4 id="实例-20" tabindex="-1"><a class="header-anchor" href="#实例-20" aria-hidden="true">#</a> 实例</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 查询名为NICK的演员</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> sakila<span class="token punctuation">.</span>actor <span class="token keyword">WHERE</span> first_name <span class="token operator">=</span> <span class="token string">&#39;NICK&#39;</span><span class="token punctuation">;</span>

<span class="token comment">-- 查看SELECT语句的语句执行计划，了解MySQL再内部如何执行此查询</span>
<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> sakila<span class="token punctuation">.</span>actor <span class="token keyword">WHERE</span> first_name <span class="token operator">=</span> <span class="token string">&#39;NICK&#39;</span><span class="token punctuation">;</span>

<span class="token comment">-- rows = 201，要扫描201行组成的整个表才能找到具有符合条件的行</span>
<span class="token operator">+</span><span class="token comment">----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+--</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span> <span class="token operator">|</span> partitions <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>  <span class="token operator">|</span> key_len <span class="token operator">|</span> ref  <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> filtered <span class="token operator">|</span> Extra       <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+--</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> actor <span class="token operator">|</span> <span class="token boolean">NULL</span>       <span class="token operator">|</span> <span class="token keyword">ALL</span>  <span class="token operator">|</span> <span class="token boolean">NULL</span>          <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>    <span class="token operator">|</span> <span class="token boolean">NULL</span> <span class="token operator">|</span>  <span class="token number">201</span> <span class="token operator">|</span>    <span class="token number">10.00</span> <span class="token operator">|</span> <span class="token keyword">Using</span> <span class="token keyword">where</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+--</span>

<span class="token comment">-- 为first_name列创建名为first_name的索引，默认为B-Tree索引，也是二级索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> first_name <span class="token keyword">ON</span> actor<span class="token punctuation">(</span>first_name<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 再次查看查询的执行计划</span>
<span class="token keyword">EXPLAIN</span> <span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> sakila<span class="token punctuation">.</span>actor <span class="token keyword">WHERE</span> first_name <span class="token operator">=</span> <span class="token string">&#39;NICK&#39;</span><span class="token punctuation">;</span>

<span class="token comment">-- rows = 3，只要从first_name指示的索引中定位其中的3行，而无需扫描整个表</span>
<span class="token operator">+</span><span class="token comment">----+-------------+-------+------------+------+---------------+------------+---------+-------+------+------</span>
<span class="token operator">|</span> id <span class="token operator">|</span> select_type <span class="token operator">|</span> <span class="token keyword">table</span> <span class="token operator">|</span> partitions <span class="token operator">|</span> <span class="token keyword">type</span> <span class="token operator">|</span> possible_keys <span class="token operator">|</span> <span class="token keyword">key</span>        <span class="token operator">|</span> key_len <span class="token operator">|</span> ref   <span class="token operator">|</span> <span class="token keyword">rows</span> <span class="token operator">|</span> filtered <span class="token operator">|</span> Extra <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+-------------+-------+------------+------+---------------+------------+---------+-------+------+------</span>
<span class="token operator">|</span>  <span class="token number">1</span> <span class="token operator">|</span> <span class="token keyword">SIMPLE</span>      <span class="token operator">|</span> actor <span class="token operator">|</span> <span class="token boolean">NULL</span>       <span class="token operator">|</span> ref  <span class="token operator">|</span> first_name    <span class="token operator">|</span> first_name <span class="token operator">|</span> <span class="token number">182</span>     <span class="token operator">|</span> const <span class="token operator">|</span>    <span class="token number">3</span> <span class="token operator">|</span>   <span class="token number">100.00</span> <span class="token operator">|</span> <span class="token boolean">NULL</span>  <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">----+-------------+-------+------------+------+---------------+------------+---------+-------+------+------</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="删除索引" tabindex="-1"><a class="header-anchor" href="#删除索引" aria-hidden="true">#</a> 删除索引</h4><p>删除索引除了因为创建了错误的索引之外，还可以是因为<strong>为了更快</strong>，<strong>在插入或更新大量的数据之前先删除索引</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> index_name
<span class="token keyword">ON</span> table_name
<span class="token punctuation">[</span>algorithm_option <span class="token operator">|</span> lock_option<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">-- 删除主键索引，主键的索引名固定为PRIMARY</span>
<span class="token keyword">DROP</span> <span class="token keyword">INDEX</span> <span class="token identifier"><span class="token punctuation">`</span>PRIMARY<span class="token punctuation">`</span></span> <span class="token keyword">ON</span> t<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>index_name</code> 是索引的名字。</li><li><code>table_name </code>是表的名字。</li><li><code>algorithm_option</code> 指定删除索引的算法。`ALGORITHM [=] {DEFAULT | INPLACE | COPY}`` <ul><li>``ALGORITHM` 子句是可选的。</li><li>默认为 <code>INPLACE</code>。如果不支持<code>**INPLACE**</code>，则使用 <code>COPY</code>。</li><li>使用 <code>DEFAULT</code> 和省略 <code>ALGORITHM</code> 子句效果相同。 <ul><li><strong>COPY</strong>：对原表的副本进行操作，将原表中的表数据逐行复制到新表中。不允许并发 DML。</li><li><strong>INPLACE</strong>: 避免复制表数据，但可能会就地重建表。在操作的准备和执行阶段，可能会短暂地对表进行独占元数据锁定。通常，支持并发 DML。</li></ul></li></ul></li><li><code>lock_option</code> 指定删除索引的并发控制策略。<code>LOCK [=] {DEFAULT | NONE | SHARED | EXCLUSIVE}</code><ul><li><strong>LOCK</strong> 子句是可选的。 <ul><li><strong>DEFAULT</strong>：给定 <strong>ALGORITHM</strong> 子句（如果有）和 <strong>ALTER TABLE</strong> 操作的最大并发级别： <ul><li>如果支持，则允许并发读取和写入。</li><li>如果不是，则允许并发读取（如果支持）。如果不是，则强制执行独占访问。</li></ul></li><li><strong>NONE</strong><ul><li>如果支持，允许并发读取和写入。否则，会发生错误。</li></ul></li><li><strong>SHARED</strong><ul><li>如果支持，允许并发读取但阻止写入。 <ul><li>即使存储引擎支持给定 <strong>ALGORITHM</strong> 子句（如果有）和 <strong>ALTER TABLE</strong> 操作的并发写入，写入也会被阻止。</li></ul></li><li>如果不支持并发读取，则会发生错误。</li></ul></li><li><strong>EXCLUSIVE</strong>：强制执行独占访问。 <ul><li>即使存储引擎支持给定 <strong>ALGORITHM</strong> 子句（如果有）和 <strong>ALTER TABLE</strong> 操作的并发读/写，也会这样做。</li></ul></li></ul></li></ul></li></ul><blockquote><p>在 MySQL 内部，<strong>DROP INDEX</strong> 语句被映射为 ALTER TABLE ... DROP INDEX ...语句</p></blockquote><h4 id="显示索引" tabindex="-1"><a class="header-anchor" href="#显示索引" aria-hidden="true">#</a> 显示索引</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> INDEXES <span class="token keyword">FROM</span> db_name<span class="token punctuation">.</span>table_name<span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> INDEXES <span class="token keyword">FROM</span> table_name <span class="token operator">IN</span> db_name<span class="token punctuation">;</span>
<span class="token keyword">SHOW</span> INDEXES <span class="token keyword">FROM</span> db_name<span class="token punctuation">.</span>table_name <span class="token keyword">WHERE</span> condition<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>db_name</code>指示数据库的名字。如果您可以选择了数据库，则它可以省略。</li><li><code>table_name</code> 指示表的名字。</li><li>关键字 <code>INDEXES</code> 可以被替换为 <code>INDEX</code> 或者 <code>KEYS</code>。</li><li>关键字 <code>IN</code> 可以被替换为 <code>FROM</code>。</li><li>关键字 <code>FROM</code>可以被替换为 <code>IN</code>。</li></ul><h4 id="索引提示" tabindex="-1"><a class="header-anchor" href="#索引提示" aria-hidden="true">#</a> 索引提示</h4><blockquote><p>索引提示指的是在SELECT查询中可以人为的指定索引来优化查询</p></blockquote><ul><li>MySQL的查询优化器是数据库服务器的一个组件，为sql语句制定最佳执行计划</li><li>查询有坏去根据索引基数进行决策，有时候创建了索引，但是sql语句不一定会使用这个索引，这是因为查询优化器做出了他认为的更优选择</li><li>虽然可以使用<code>USE INDEX</code>指定查询优化器使用什么索引来执行sql，但是有时候查询优化器仍然不适用指定的索引，这时候就可以使用<code>FORCE INDEX</code></li></ul><h5 id="use-index" tabindex="-1"><a class="header-anchor" href="#use-index" aria-hidden="true">#</a> USE INDEX</h5><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 告诉查询优化器，使用名为index_list的索引进行查询</span>
<span class="token keyword">SELECT</span> column_list
<span class="token keyword">FROM</span> table_name
<span class="token keyword">USE</span> <span class="token keyword">INDEX</span> <span class="token punctuation">(</span>index_list<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> condition<span class="token punctuation">;</span>

<span class="token comment">-- 实例</span>
<span class="token keyword">SELECT</span> <span class="token operator">*</span>
<span class="token keyword">FROM</span> customer
<span class="token keyword">USE</span> <span class="token keyword">INDEX</span> <span class="token punctuation">(</span>idx_last_name_first_name<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> last_name <span class="token operator">=</span> <span class="token string">&#39;BARBEE&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="force-index" tabindex="-1"><a class="header-anchor" href="#force-index" aria-hidden="true">#</a> FORCE INDEX</h5><ul><li>强制查询优化器使用我们指定的索引完成查询</li></ul><div class="language-SQL line-numbers-mode" data-ext="SQL"><pre class="language-SQL"><code>SELECT *
FROM table_name
FORCE INDEX (index_list)
WHERE condition;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="隐藏索引" tabindex="-1"><a class="header-anchor" href="#隐藏索引" aria-hidden="true">#</a> 隐藏索引</h4><h5 id="简介" tabindex="-1"><a class="header-anchor" href="#简介" aria-hidden="true">#</a> 简介</h5><ul><li>隐藏索引是一步操作，意思是隐藏某个索引，使其对优化器不可见</li><li>即使使用 FROCE INDEX ，查询优化器也不会使用隐藏索引</li><li>应用场景 <ul><li>测试该索引是否真的有存在的必要</li><li>删除索引前的测试</li></ul></li></ul><h5 id="用法-2" tabindex="-1"><a class="header-anchor" href="#用法-2" aria-hidden="true">#</a> 用法</h5><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 创建隐藏索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> index_name
<span class="token keyword">ON</span> table_name<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> INVISIBLE<span class="token punctuation">;</span>

<span class="token comment">-- 修改索引的可见性，不能将主键列上的索引设置为隐藏索引</span>
<span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name
<span class="token keyword">ALTER</span> <span class="token keyword">INDEX</span> index_name <span class="token punctuation">[</span>VISIBLE <span class="token operator">|</span> INVISIBLE<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">-- 查询优化器默认不使用隐藏索引，但这个默认行为是可以被改变的</span>
<span class="token comment">-- 查看当前的设置</span>
<span class="token keyword">SELECT</span> @<span class="token variable">@optimizer_switch</span><span class="token punctuation">;</span>
<span class="token comment">-- 在当前会话中修改默认的行为</span>
<span class="token keyword">SET</span> <span class="token keyword">SESSION</span> optimizer_switch<span class="token operator">=</span><span class="token string">&quot;use_invisible_indexes=on&quot;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="索引基数" tabindex="-1"><a class="header-anchor" href="#索引基数" aria-hidden="true">#</a> 索引基数</h3><h4 id="基本概念" tabindex="-1"><a class="header-anchor" href="#基本概念" aria-hidden="true">#</a> 基本概念</h4><ul><li>索引基数是指这个索引的列中唯一值的数量。他是根据统计信息生成的一个估计值，不一定是准确的。</li><li>索引技术是MySQL拆谢谢你优化器决定是否使用索引的一个重要依据</li><li>索引技术越高，使用索引越有效</li><li>如果索引的基数很低，全表扫描可能比使用索引更有效</li></ul><h4 id="查看索引基数" tabindex="-1"><a class="header-anchor" href="#查看索引基数" aria-hidden="true">#</a> 查看索引基数</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> INDEXES <span class="token keyword">FROM</span> table_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>不同的索引具有不同的索引基数</p><ul><li>PRIMARY 索引列因为是主键，索引基数的数量和行数是相同的</li><li><code>idx_fx_language_id</code>索引的记录为1，因为film表中只有<code>language_id</code>为1的影片,，整个列只有一个值。 <ul><li>MySQL查询优化器不会使用<code>idx_fk_language_id</code>索引，因为它的基数太小了。</li></ul></li></ul><h3 id="索引顺序" tabindex="-1"><a class="header-anchor" href="#索引顺序" aria-hidden="true">#</a> 索引顺序</h3><ul><li>索引顺序由升序索引和降序索引</li><li>默认情况下，索引按照升序存储</li></ul><blockquote><p>order by ASC 则使用升序索引，DESC 使用降序索引</p></blockquote><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 创建索引时指定索引的存储顺序</span>
<span class="token keyword">CREATE</span> <span class="token punctuation">[</span><span class="token keyword">UNIQUE</span><span class="token punctuation">]</span> <span class="token keyword">INDEX</span> index_name
<span class="token punctuation">[</span><span class="token keyword">USING</span> {<span class="token keyword">BTREE</span> <span class="token operator">|</span> <span class="token keyword">HASH</span>}<span class="token punctuation">]</span>
<span class="token keyword">ON</span> table_name <span class="token punctuation">(</span>column_name <span class="token punctuation">[</span><span class="token keyword">ASC</span> <span class="token operator">|</span> <span class="token keyword">DESC</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>algorithm_option <span class="token operator">|</span> lock_option<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">-- 创建表时直接创建索引，ASC为默认值</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> table_name<span class="token punctuation">(</span>
  column_list
  <span class="token keyword">INDEX</span> index_name <span class="token punctuation">(</span>column_name <span class="token punctuation">[</span><span class="token keyword">ASC</span> <span class="token operator">|</span> <span class="token keyword">DESC</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="唯一索引" tabindex="-1"><a class="header-anchor" href="#唯一索引" aria-hidden="true">#</a> 唯一索引</h3><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 给指定表的指定列创建唯一索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">UNIQUE</span> <span class="token keyword">INDEX</span> index_name
<span class="token punctuation">[</span><span class="token keyword">USING</span> {<span class="token keyword">BTREE</span> <span class="token operator">|</span> <span class="token keyword">HASH</span>}<span class="token punctuation">]</span>
<span class="token keyword">ON</span> table_name <span class="token punctuation">(</span>column_list<span class="token punctuation">)</span>
<span class="token punctuation">[</span>algorithm_option <span class="token operator">|</span> lock_option<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">-- 建表的时候设置唯一索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> table_name<span class="token punctuation">(</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
    column_name data_type <span class="token keyword">UNIQUE</span><span class="token punctuation">,</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 如果建表的时候有多列需要添加唯一索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> table_name<span class="token punctuation">(</span>
column_name1 column_definition<span class="token punctuation">,</span>
column_name2 column_definition<span class="token punctuation">,</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">,</span>
<span class="token punctuation">[</span><span class="token keyword">CONSTRAINT</span> constraint_name<span class="token punctuation">]</span>
    <span class="token keyword">UNIQUE</span><span class="token punctuation">(</span>column_name1<span class="token punctuation">,</span>column_name2<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>UNIQUE</code> 关键字表明此索引为唯一索引。</li><li><code>index_name</code> 是索引的名字。一个表中不应该出现两个相同名字的索引。</li><li><code>table_name</code> 是表的名字。</li><li><code>column_list</code> 是表中的列名。多个列名使用逗号分隔。</li><li>如果唯一键包含多个列，请使用如下语法：</li></ul><blockquote><p>在 MySQL 中，唯一键和唯一索引的意思相同。因为关键字<code>INDEX</code> 和 <code>KEY</code> 具有相同的含义。</p></blockquote><h3 id="复合索引" tabindex="-1"><a class="header-anchor" href="#复合索引" aria-hidden="true">#</a> 复合索引</h3><blockquote><p>复合索引就是给多个列添加一个索引</p></blockquote><h4 id="定义" tabindex="-1"><a class="header-anchor" href="#定义" aria-hidden="true">#</a> 定义</h4><p>定义多列索引时，要把WHERE子句中常用的列放在索引列列表开头，不常用的放后面，否则MySQL查询优化器可能不会使用索引</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> index_name
<span class="token keyword">ON</span> table_name<span class="token punctuation">(</span>column_1<span class="token punctuation">,</span> column_2<span class="token punctuation">,</span> column_3<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="复合索引查询规则" tabindex="-1"><a class="header-anchor" href="#复合索引查询规则" aria-hidden="true">#</a> 复合索引查询规则</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> index_name
<span class="token keyword">ON</span> table_name<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>上述语法中，MySQL 优化器在以下情况下会考虑使用索引：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">WHERE</span> a <span class="token operator">=</span> v1 <span class="token operator">and</span> b <span class="token operator">=</span> v2 <span class="token operator">and</span> c <span class="token operator">=</span> v3<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>或者</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">WHERE</span> a <span class="token operator">=</span> v1 <span class="token operator">and</span> b <span class="token operator">=</span> v2<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>或者</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">WHERE</span> a <span class="token operator">=</span> v1<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>但是，在以下情况下不会考虑使用索引：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">WHERE</span>  c <span class="token operator">=</span> v3<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>或者</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">WHERE</span> b <span class="token operator">=</span> v2 <span class="token operator">and</span> c <span class="token operator">=</span> v3<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>也就说，<strong>如果条件列不构成索引的最左前缀，则查询优化器无法使用索引执行查找</strong>。</p><h3 id="聚集索引" tabindex="-1"><a class="header-anchor" href="#聚集索引" aria-hidden="true">#</a> 聚集索引</h3><h4 id="基本概念-1" tabindex="-1"><a class="header-anchor" href="#基本概念-1" aria-hidden="true">#</a> 基本概念</h4><ul><li>聚集索引又叫聚簇索引</li><li>聚集索引中的键值的顺序决定了表中相应行的物理顺序</li><li>聚集索引类似于一个词典，词典的目录相当于聚集索引，目录和词语都是按照字母顺序排序的</li><li>表中的数据只能按照一种顺序进行存储，因此一个表中最多只能有一个聚集索引</li></ul><h4 id="mysql聚集索引" tabindex="-1"><a class="header-anchor" href="#mysql聚集索引" aria-hidden="true">#</a> MySQL聚集索引</h4><ul><li>聚簇索引有利于一个InnoDB表优化数据操作，比如SELECT ,INSERT ,UPDATE, DELETE</li><li>每个InnoDB表都需要一个聚集索引</li><li>如果为InnoDB表定义了主键，MySQL使用<strong>主键作为聚集索引</strong></li><li>如果表中没有主键，MySQL会用<strong>第一个所有键列都是NOT NULL的UNIQUE索引作为聚集索引</strong></li><li>如果InnoDB没有主键或合适的UNIQUE索引，MySQL会在<strong>内部生成一个隐藏的聚集索引</strong>，名称为GEN_CLUST_INDEX，<strong>该索引建立在一个包含ROW ID值的列上</strong></li><li><strong>除了聚集索引外的所有索引均成为二级索引</strong>(非聚集索引)</li><li>在InnoDB中，二级索引中的每条记录都包含该行主键列以及非聚集索引中指定的列。MySQL使用此主键在聚集索引中进行行查找</li><li>因此，主键较短时有利的，否则二级索引将占用更多的空间。通常，自增整数列用于主键列</li></ul><blockquote><p>ROW ID 是InnoDB的一个隐藏列，是一个6字节的整数，用于标识表中的每一行，当表中没有主键或唯一列时，InnoDB会自动分配一个 ROW ID，赋值给 ROW ID列</p></blockquote><h3 id="字符串前缀索引" tabindex="-1"><a class="header-anchor" href="#字符串前缀索引" aria-hidden="true">#</a> 字符串前缀索引</h3><blockquote><p>在确定前缀长度时，应该尽量让字符串前缀保持唯一性，唯一性越强，索引的效率越高</p></blockquote><h4 id="作用" tabindex="-1"><a class="header-anchor" href="#作用" aria-hidden="true">#</a> 作用</h4><ul><li>为字符串列的指定长度的前缀创建前缀索引</li><li>相比于为整个字符串列创建索引，前缀索引能够减少磁盘的使用量，并提高索引的写入速度</li></ul><h4 id="用法-3" tabindex="-1"><a class="header-anchor" href="#用法-3" aria-hidden="true">#</a> 用法</h4><ul><li>如果为 CAHR, VARCHAR, TEXT等非二进制字符类型，length 指定用于前缀索引的字符数</li><li>如果为 BINARY, VARBINARY 和 BLOB 等二进制字符类型，length指定用于前缀索引的字节</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">-- 添加前缀索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">INDEX</span> index_name
<span class="token keyword">ON</span> table_name <span class="token punctuation">(</span>column_name<span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">-- 在创建表时定义一个前缀索引</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> table_name<span class="token punctuation">(</span>
  column_list<span class="token punctuation">,</span>
  <span class="token keyword">INDEX</span><span class="token punctuation">(</span>column_name<span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="数据库管理" tabindex="-1"><a class="header-anchor" href="#数据库管理" aria-hidden="true">#</a> 数据库管理</h2><h3 id="启动-停止" tabindex="-1"><a class="header-anchor" href="#启动-停止" aria-hidden="true">#</a> 启动/停止</h3><h4 id="linux" tabindex="-1"><a class="header-anchor" href="#linux" aria-hidden="true">#</a> Linux</h4><p>根据 Linux 发行版的不同，服务的名称可能是 <strong>mysqld</strong> 也可能是 <strong>mysql</strong>。</p><p>早期的 Linux 版本中提供了 <strong>service</strong> 命令管理服务器，可以使用下面的命令控制 MySQL 服务器：</p><ul><li>启动 MySQL 服务器</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">service</span> mysqld start
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>停止 MySQL 服务器</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">service</span> mysqld stop
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>重启 MySQL 服务器</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">service</span> mysqld restart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>近期的 Linux 版本中使用 <strong>systemd</strong> 命令管理服务器，因此您可以使用下面的命令控制 MySQL 服务器：</p><ul><li>启动 MySQL 服务器</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> systemd start mysqld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>停止 MySQL 服务器</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">service</span> stop mysqld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>重启 MySQL 服务器</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">service</span> restart mysqld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>在一些 Linux 发行版中，请使用 <strong>mysql</strong> 替代上面命令中的 <strong>mysqld</strong>。</p></blockquote><h4 id="windows" tabindex="-1"><a class="header-anchor" href="#windows" aria-hidden="true">#</a> Windows</h4><ol><li>mysqld：这个可执行文件就代表着MySQL的服务器程序，运行它就可以直接启动一个服务器进程，但是这个命令不常用</li><li>以服务的方式运行服务器程序 <ul><li>将MySQL服务器程序注册称为Windows服务，让操作系统自动管理</li><li>使用net start MySQL启动</li><li>使用net stop MySQL启动</li></ul></li></ol><h3 id="用户管理" tabindex="-1"><a class="header-anchor" href="#用户管理" aria-hidden="true">#</a> 用户管理</h3><h4 id="创建用户" tabindex="-1"><a class="header-anchor" href="#创建用户" aria-hidden="true">#</a> 创建用户</h4><p>以下是 <strong>CREATE USER</strong> 语句的基本语法：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> account_name 
IDENTIFIED <span class="token keyword">BY</span> <span class="token string">&#39;password&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个语法中：</p><ul><li>在 <strong>CREATE USER</strong> 关键字后指定帐户名称。帐户名称由两部分组成： <strong>username</strong> 和 <strong>hostname</strong> ，以 <strong>@</strong> 符号分隔：</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>username<span class="token variable">@hostname</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>username</strong> 是用户的名称。而 <strong>hostname</strong> 从用户连接到 MySQL 服务器的主机名。<strong>hostname</strong> 帐户名称的部分是可选的。如果省略它，用户可以从任何主机连接。没有主机名的帐户名等效于：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>username@<span class="token operator">%</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果 <strong>username</strong> 和 <strong>hostname</strong> 中包含空格或 <strong>-</strong> 等特殊字符，则需要将用户名和主机名分别按如下方式引用：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token string">&#39;username&#39;</span><span class="token variable">@&#39;hostname&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>除了单引号 (<strong>&#39;</strong>)，您还可以使用反引号 (<strong>``</strong>) 或双引号 (<strong>&quot;</strong>)。</p><ul><li>在 <strong>IDENTIFIED BY</strong> 关键字后指定用户的密码。</li><li><strong>IF NOT EXISTS</strong> 选项仅在新用户不存在时有条件地创建新用户。</li></ul><p><strong>CREATE USER</strong> 语句创建了一个没有任何权限的新用户。要向用户授予权限，使用 GRANT语句</p><h4 id="删除用户" tabindex="-1"><a class="header-anchor" href="#删除用户" aria-hidden="true">#</a> 删除用户</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">USER</span> <span class="token punctuation">[</span><span class="token keyword">IF</span> <span class="token keyword">EXISTS</span><span class="token punctuation">]</span> account_name <span class="token punctuation">[</span><span class="token punctuation">,</span>account_name2<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>在 <strong>DROP USER</strong> 关键字后指定要删除的用户帐户的名称。</li><li>如果要一次删除多个用户帐户，在 <strong>DROP USER</strong> 子句中指定以逗号分隔的用户帐户列表。</li><li>如果删除不存在的用户帐户，MySQL 将发出错误。 <ul><li>可以使用 <strong>IF EXISTS</strong> 子句仅在用户存在时有条件地删除用户。</li><li>不过 MySQL 5.7.8+ 以上的版本才支持 <strong>IF EXISTS</strong> 子句。</li></ul></li><li><strong>DROP USER</strong> 语句不但删除用户帐户，而且从所有授权表中删除用户的所有权限。</li></ul><blockquote><p>注意：如果删除的用户在删除之前已经登录了一个会话，删除后并不会影响此会话，直到会话结束</p></blockquote><h4 id="重命名用户" tabindex="-1"><a class="header-anchor" href="#重命名用户" aria-hidden="true">#</a> 重命名用户</h4><ul><li>此用户账户已经被泄露</li><li>将用户名改为一个更有意义的用户名</li></ul><p>要从 MySQL 服务器中重命名一个或者多个已有的用户账户，请使用 <strong>RENAME USER</strong> 语句。</p><p><strong>RENAME USER</strong> 语句重命名一个或多个现有帐户。以下是 <strong>RENAME USER</strong> 语句的基本语法：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">RENAME</span> <span class="token keyword">USER</span>
    user_account <span class="token keyword">TO</span> new_user_account
    <span class="token punctuation">[</span><span class="token punctuation">,</span> user_account2 <span class="token keyword">TO</span> new_user_account2<span class="token punctuation">]</span>
    <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在这个语法中：</p><ul><li>在 <strong>TO</strong> 关键字之前指定要重命名的现有用户账户。</li><li>在 <strong>TO</strong> 关键字之后指定新用户账户。</li></ul><p>不能使用一个已有的用户账户作为新的用户账户，否则将收到错误消息。</p><p><strong>RENAME USER</strong> 将旧用户的所有权限转移给新用户。但是，它不会删除或使依赖于旧用户的数据库对象无效。</p><ul><li>例如，假设您有一个存储过程，其 <strong>DEFINER</strong> 属性指定了旧用户。</li><li>这个存储过程在定义者安全上下文中执行。如果重命名旧用户，则执行存储过程时会出现错误。</li></ul><h4 id="修改密码" tabindex="-1"><a class="header-anchor" href="#修改密码" aria-hidden="true">#</a> 修改密码</h4><p>改 MySQL 用户帐户的密码是一个常用的操作，但是在更改 MySQL 用户帐户的密码之前 ，您应该考虑以下重要问题：</p><ul><li>要更改哪个用户帐户的密码？</li><li>哪个应用程序正在使用正在更改密码的用户帐户？ <ul><li>​ 如果更改密码了而没有更改使用该用户帐户的应用程序的连接字符串，该应用程序将无法连接到数据库服务器。</li></ul></li></ul><h5 id="update-1" tabindex="-1"><a class="header-anchor" href="#update-1" aria-hidden="true">#</a> UPDATE</h5><p>使用 <strong>UPDATE</strong> 语句更新 <strong>mysql</strong> 数据库中的 <strong>user</strong> 表。</p><p>执行完 <strong>UPDATE</strong> 语句后，还需要执行 <strong>FLUSH PRIVILEGES</strong> 语句从 <strong>mysql</strong> 数据库中的 <strong>grant</strong> 表中重新加载权限。</p><p>假设您要更改来自主机 <strong>localhost</strong> 连接的用户 <strong>dbadmin</strong> 的密码为 <strong>Db123654</strong>，则需要按步骤执行以下语句：</p><ol><li>选择 <strong>mysql</strong> 数据库：</li></ol><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">USE</span> mysql<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>更新密码：</li></ol><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> <span class="token keyword">user</span>
<span class="token keyword">SET</span> password <span class="token operator">=</span> PASSWORD<span class="token punctuation">(</span><span class="token string">&#39;Db123654&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> <span class="token keyword">user</span> <span class="token operator">=</span> <span class="token string">&#39;dbadmin&#39;</span> <span class="token operator">AND</span>
      host <span class="token operator">=</span> <span class="token string">&#39;localhost&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>刷新权限：</li></ol><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>FLUSH <span class="token keyword">PRIVILEGES</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>请注意，从 MySQL 5.7.6 开始，用户表使用列 <strong>authentication_string</strong> 来存储密码。并且，它删除了 <strong>password</strong> 列。</p><p>因此，如果您使用 MySQL 5.7.6+，则必须修改 <strong>UPDATE</strong> 语句中的 <strong>authentication_string</strong> 列：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> <span class="token keyword">user</span>
<span class="token keyword">SET</span> authentication_string <span class="token operator">=</span> PASSWORD<span class="token punctuation">(</span><span class="token string">&#39;Db123654&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> <span class="token keyword">user</span> <span class="token operator">=</span> <span class="token string">&#39;dbadmin&#39;</span> <span class="token operator">AND</span>
      host <span class="token operator">=</span> <span class="token string">&#39;localhost&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>PASSWORD()</strong> 函数根据纯文本计算哈希值。</p><h5 id="set-password" tabindex="-1"><a class="header-anchor" href="#set-password" aria-hidden="true">#</a> SET PASSWORD</h5><p>使用 <strong>SET PASSWORD</strong> 语句</p><p>可以使用 <strong>user@host</strong> 格式的用户帐户来更新密码。</p><p>如果需要更改其他帐户的密码，您的帐户至少需要有 <strong>UPDATE</strong> 权限。</p><p>通过使用该 <strong>SET PASSWORD</strong> 语句，无需执行 <strong>FLUSH PRIVILEGES</strong> 语句即可从授权表重新加载权限。</p><p>以下语句使用 <strong>SET PASSWORD</strong> 语句更改用户帐户 <strong>dbadmin</strong> 的密码：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> PASSWORD <span class="token keyword">FOR</span> <span class="token string">&#39;dbadmin&#39;</span><span class="token variable">@&#39;localhost&#39;</span> <span class="token operator">=</span> PASSWORD<span class="token punctuation">(</span><span class="token string">&#39;Db123654&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>请注意，从 5.7.6 版开始，您不需要在 <strong>SET PASSWORD</strong> 语句中使用 <strong>PASSWORD()</strong>，而是直接使用明文密码</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SET</span> PASSWORD <span class="token keyword">FOR</span> <span class="token string">&#39;dbadmin&#39;</span><span class="token variable">@&#39;localhost&#39;</span> <span class="token operator">=</span> <span class="token string">&#39;Db123654&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="alter-user" tabindex="-1"><a class="header-anchor" href="#alter-user" aria-hidden="true">#</a> ALTER USER</h5><p>使用 <strong>ALTER USER</strong> 带有 <strong>IDENTIFIED BY</strong> 子句的语句。</p><p>以下 <strong>ALTER USER</strong> 语句将 <strong>dbadmin</strong> 用户的密码更改 为 <strong>Db123654</strong> ：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">USER</span> dbadmin<span class="token variable">@localhost</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">&#39;Db123654&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果想重置 MySQL <strong>root</strong> 帐户的密码，则需要在不使用授权表验证的情况下强制 MySQL 数据库服务器停止并重新启动。</p><h4 id="列出用户" tabindex="-1"><a class="header-anchor" href="#列出用户" aria-hidden="true">#</a> 列出用户</h4><p>要列出 MySQL 服务器的所有用户，必须以管理员身份登录 MySQL 数据库服务器。</p><p>在 mysql 客户端中，我们可以按照如下操作：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysql <span class="token parameter variable">-u</span> root <span class="token parameter variable">-p</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>输入 <strong>root</strong> 帐户的密码并按 <strong>Enter</strong> ：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Enter password: ********
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>使用下面的 SELECT语句 从 <strong>mysql</strong> 数据库中的 <strong>user</strong> 表中查询所有的用户：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">user</span><span class="token punctuation">,</span> host <span class="token keyword">FROM</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>下面是我所在的 MySQL 服务器中的输出：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+------------------+-----------+
| user             | host      |
+------------------+-----------+
| root             | %         |
| sqliz            | %         |
| test_role1       | %         |
| test_role2       | %         |
| test_user1_new   | %         |
| test_user2_new   | %         |
| test_user3_new   | %         |
| testuser         | %         |
| mysql.infoschema | localhost |
| mysql.session    | localhost |
| mysql.sys        | localhost |
| root             | localhost |
+------------------+-----------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 <strong>mysql.user</strong> 表中有很多列，分别保存了用户的各种各样的信息，比如密码，密码有效期，是否锁定 和 各种权限等。</p><p>这里，我们只输出了 <strong>user</strong> 和 <strong>host</strong> 两列</p><ul><li>其中 <strong>user</strong> 列保存了用户账户的用户名</li><li><strong>host</strong> 列保存了用户账户允许登录的主机（它一般是主机名或者 IP 地址）</li></ul><p>要获取有关 <strong>user</strong> 表的更多信息，可以使用以下命令输出所有 <strong>user</strong> 表的所有的列：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DESC</span> mysql<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="显示当前用户" tabindex="-1"><a class="header-anchor" href="#显示当前用户" aria-hidden="true">#</a> 显示当前用户</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token keyword">current_user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- 获取有关当前用户的认证的信息</span>
<span class="token keyword">SELECT</span> <span class="token keyword">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">-- 获取有关当前用户的信息</span>
<span class="token keyword">SHOW</span> PROCESSLIST<span class="token punctuation">;</span> <span class="token comment">-- 显示当前登录的用户</span>

<span class="token comment">-- 要列出当前登录MySQL数据库服务器的所有用户</span>
<span class="token keyword">SELECT</span> <span class="token keyword">user</span><span class="token punctuation">,</span> host<span class="token punctuation">,</span> db<span class="token punctuation">,</span> command
<span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>processlist<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="权限管理" tabindex="-1"><a class="header-anchor" href="#权限管理" aria-hidden="true">#</a> 权限管理</h3><h4 id="授权" tabindex="-1"><a class="header-anchor" href="#授权" aria-hidden="true">#</a> 授权</h4><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">GRANT</span> privilege_type <span class="token punctuation">[</span><span class="token punctuation">,</span>privilege_type<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">ON</span> privilege_object
<span class="token keyword">TO</span> user_account<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><strong>privilege_type</strong>：权限类型。</p><ul><li>要赋予给用户的权限。</li><li>常用的包括： <strong>ALL</strong>, <strong>SELECT</strong>, <strong>UPDATE</strong>, <strong>DELETE</strong>, <strong>ALTER</strong>, <strong>DROP</strong> 以及 <strong>INSERT</strong> 等。</li><li>更详细的内容去看官方文档：<a href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_all" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html#priv_all<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></li><li><p><strong>privilege_object</strong>权限对象。</p><ul><li>可以是所有对象，也可以是某个数据库中的所有对象，表 等。</li><li>常用的包括： ****<em>, <em><strong>.</strong></em>, <strong>db_name.</strong></em>, <strong>db_name.table_name</strong>, <strong>table_name</strong> 等。</li></ul></li><li><p><strong>user_account</strong>：用户账户。</p><ul><li>使用 <strong>username@host</strong> 的形式。</li></ul></li></ul><blockquote><p><strong>几种常用的情况</strong></p></blockquote><ul><li>分配全局权限</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> sqliz<span class="token variable">@localhost</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这里将全部数据库全部对象的全部权限分配给了用户 <strong>sqliz@localhost</strong></p><ul><li>分配数据库全部对象的全部权限</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">ON</span> sqliz<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> sqliz<span class="token variable">@localhost</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这里将 <strong>sqliz</strong> 数据库全部对象的全部权限分配给了用户 <strong>sqliz@localhost</strong></p><ul><li>分配数据库中某个表的的查询和插入权限</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span><span class="token punctuation">,</span> <span class="token keyword">INSERT</span> <span class="token keyword">ON</span> sqliz<span class="token punctuation">.</span>test_table <span class="token keyword">TO</span> sqliz<span class="token variable">@localhost</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这里将 <strong>sqliz</strong> 数据库中的 <strong>test_table</strong> 表的 <strong>SELECT</strong> 和 <strong>INSERT</strong> 权限分配给了用户 <strong>sqliz@localhost</strong></p><h4 id="撤销权限" tabindex="-1"><a class="header-anchor" href="#撤销权限" aria-hidden="true">#</a> 撤销权限</h4><h5 id="撤销一项或多项权限" tabindex="-1"><a class="header-anchor" href="#撤销一项或多项权限" aria-hidden="true">#</a> 撤销一项或多项权限</h5><p><strong>REVOKE</strong> 撤销用户帐户的一项或多项权限</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">REVOKE</span>
   priv1 <span class="token punctuation">[</span><span class="token punctuation">,</span> priv2 <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token punctuation">]</span>
<span class="token keyword">ON</span> <span class="token punctuation">[</span>object_type<span class="token punctuation">]</span> privilege_level
<span class="token keyword">FROM</span> user1 <span class="token punctuation">[</span><span class="token punctuation">,</span> user2 <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>在 <strong>REVOKE</strong> 关键字后指定要从用户帐户中撤销的以逗号分隔的权限列表</li><li>在 <strong>ON</strong> 关键字后指定权限的对象类型和权限级别</li><li>在 <strong>FROM</strong> 子句中指定一个或多个您要撤销其权限的用户帐户</li></ul><blockquote><p>请注意，要执行这种形式的 <strong>REVOKE</strong> 语句，您必须具有 <strong>GRANT OPTION</strong> 权限或必须具有您要撤销的权限。</p></blockquote><p>撤销用户 <strong>sqliz</strong> 的在 <strong>sqlizdb</strong> 数据库中的 <strong>UPDATE</strong> 和 <strong>DELETE</strong> 权限</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">REVOKE</span> <span class="token keyword">UPDATE</span><span class="token punctuation">,</span> <span class="token keyword">DELETE</span>
<span class="token keyword">ON</span> sqlizdb<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">FROM</span> <span class="token string">&#39;sqliz&#39;</span><span class="token variable">@&#39;%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="撤销所有权限" tabindex="-1"><a class="header-anchor" href="#撤销所有权限" aria-hidden="true">#</a> 撤销所有权限</h5><p><strong>REVOKE ALL</strong>撤消用户的所有权限</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">REVOKE</span>
    <span class="token keyword">ALL</span> <span class="token punctuation">[</span><span class="token keyword">PRIVILEGES</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">GRANT</span> <span class="token keyword">OPTION</span>
<span class="token keyword">FROM</span> user1 <span class="token punctuation">[</span><span class="token punctuation">,</span> user2<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>撤销用户 <strong>sqliz</strong> 的所有权限</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">REVOKE</span>
    <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span><span class="token punctuation">,</span>
    <span class="token keyword">GRANT</span> <span class="token keyword">OPTION</span>
<span class="token keyword">FROM</span> <span class="token string">&#39;sqliz&#39;</span><span class="token variable">@&#39;%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>要执行 <strong>REVOKE ALL</strong> 语句，您必须具有全局 <strong>CREATE USER</strong> 权限或系统数据库 <strong>mysql</strong> 的 <strong>UPDATE</strong> 权限。</p></blockquote><h5 id="撤销代理" tabindex="-1"><a class="header-anchor" href="#撤销代理" aria-hidden="true">#</a> 撤销代理</h5><p><strong>REVOKE PROXY</strong> 撤销代理用户</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">REVOKE</span> PROXY
<span class="token keyword">ON</span> proxied_user
<span class="token keyword">FROM</span> proxy_user1 <span class="token punctuation">[</span><span class="token punctuation">,</span> proxy_user1 <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>代理用户是 MySQL 中可以模拟另一个用户的有效用户</strong>，因此，代理用户拥有它模拟的用户的所有权限。</p><p>在撤销用户的权限之前，使用 <strong>SHOW GRANTS</strong> 语句显示用户帐户的权限</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> GRANTS <span class="token keyword">FOR</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="revoke-生效时机" tabindex="-1"><a class="header-anchor" href="#revoke-生效时机" aria-hidden="true">#</a> REVOKE 生效时机</h5><blockquote><p><strong>REVOKE</strong> 语句的生效时机取决于权限级别：</p></blockquote><ul><li><strong>全局</strong>: 当用户帐户在后续会话中连接到 MySQL 服务器时，更改生效。更改不会应用于所有当前连接的用户。</li><li><strong>数据库级别</strong>: 更改在下 <strong>USE</strong> 一条语句后生效。</li><li><strong>表和列级别</strong>: 更改对所有后续查询生效。</li></ul><h4 id="角色" tabindex="-1"><a class="header-anchor" href="#角色" aria-hidden="true">#</a> 角色</h4><p>对于一个线上的 MySQL 数据库服务器来说，它可能有很多使用者。其中某些用户可能具有相同的权限。</p><p>作为一个数据库管理员或者运维人员，可能要对多个用户赋予相同的权限。</p><p>这个过程很耗时，也很容易带来错误。</p><p>MySQL 中的角色可以简化授权的过程。</p><p>您只需要为权限相同的用户创建一个角色，并将角色赋予这些用户即可。</p><p>您还可以创建多个角色，授权给不同的用户。您也可以为一个用户赋予多个不同的角色。</p><h5 id="mysql-角色用法" tabindex="-1"><a class="header-anchor" href="#mysql-角色用法" aria-hidden="true">#</a> MySQL 角色用法</h5><p>如果要将同一组权限授予多个用户，请执行以下步骤：</p><ul><li>首先，创建一个新角色。</li><li>其次，为角色授予权限。</li><li>第三，将角色授予用户。</li></ul><h5 id="创建角色语法" tabindex="-1"><a class="header-anchor" href="#创建角色语法" aria-hidden="true">#</a> 创建角色语法</h5><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> ROLE role_name1 <span class="token punctuation">[</span><span class="token punctuation">,</span> role_name2 <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>角色名称类似于用户帐户，由两部分组成：名称和主机。</p><p>如果省略主机部分，则默认为 <strong>%</strong>，表示任何主机。</p><p>如果需要在一个语句中创建多个角色，使用逗号分隔不同的角色名。</p><h5 id="删除角色语法" tabindex="-1"><a class="header-anchor" href="#删除角色语法" aria-hidden="true">#</a> 删除角色语法</h5><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> ROLE role_name1 <span class="token punctuation">[</span><span class="token punctuation">,</span> role_name2 <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果需要在一个语句中删除多个角色，使用逗号分隔不同的角色名。</p><h5 id="为角色授权语法" tabindex="-1"><a class="header-anchor" href="#为角色授权语法" aria-hidden="true">#</a> 为角色授权语法</h5><p><strong>GRANT</strong> 语句为角色授权</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">GRANT</span> privilege_type <span class="token punctuation">[</span><span class="token punctuation">,</span>privilege_type<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token keyword">ON</span> privilege_object
<span class="token keyword">TO</span> role_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="撤销角色的权限语法" tabindex="-1"><a class="header-anchor" href="#撤销角色的权限语法" aria-hidden="true">#</a> 撤销角色的权限语法</h5><p><strong>REVOKE</strong> 语句撤销授予角色的权限</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">REVOKE</span>
   priv1 <span class="token punctuation">[</span><span class="token punctuation">,</span> priv2 <span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token punctuation">]</span>
<span class="token keyword">ON</span> privilege_object
<span class="token keyword">FROM</span> role_name<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="为用户分配角色" tabindex="-1"><a class="header-anchor" href="#为用户分配角色" aria-hidden="true">#</a> 为用户分配角色</h5><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token operator">-</span> 开发者用户
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> sqlizdb_dev_user1<span class="token variable">@&#39;%&#39;</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">&#39;SqLiZ9879123!&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- 只读用户</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> sqlizdb_read_user1<span class="token variable">@&#39;%&#39;</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">&#39;SqLiZ9879123!&#39;</span><span class="token punctuation">;</span>
<span class="token comment">-- 读写用户</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> sqlizdb_write_user1<span class="token variable">@&#39;%&#39;</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">&#39;SqLiZ9879123!&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> sqlizdb_write_user2<span class="token variable">@&#39;%&#39;</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">&#39;SqLiZ9879123!&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>GRANT</strong> 语句为用户分配角色</p><blockquote><p>分别为 4 个用户授予角色</p></blockquote><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">GRANT</span> sqlizdb_dev <span class="token keyword">TO</span> sqlizdb_dev_user1<span class="token variable">@&#39;%&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> sqlizdb_read <span class="token keyword">TO</span> sqlizdb_read_user1<span class="token variable">@&#39;%&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> sqlizdb_read<span class="token punctuation">,</span> sqlizdb_write
<span class="token keyword">TO</span> sqlizdb_write_user1<span class="token variable">@&#39;%&#39;</span><span class="token punctuation">,</span> sqlizdb_write_user2<span class="token variable">@&#39;%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>SHOW GRANTS</strong>语句验证角色分配</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> GRANTS <span class="token keyword">FOR</span> sqlizdb_dev_user1<span class="token variable">@&#39;%&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="维护数据库" tabindex="-1"><a class="header-anchor" href="#维护数据库" aria-hidden="true">#</a> 维护数据库</h3><p>定期的维护数据表是一个很好的习惯。对提高数据库的性能很有帮助。</p><p>MySQL 提供了几个维护数据库表的语句：</p><ul><li><strong>ANALYZE TABLE</strong>: 分析表</li><li><strong>OPTIMIZE TABLE</strong>: 优化表</li><li><strong>CHECK TABLE</strong>: 检查表</li><li><strong>REPAIR TABLE</strong>: 修复表</li></ul><h4 id="分析表" tabindex="-1"><a class="header-anchor" href="#分析表" aria-hidden="true">#</a> 分析表</h4><p>MySQL 使用 <strong>ANALYZE TABLE</strong> 语句分析表，它用于分析和存储键的分布。</p><p>分析表的结果将可以使得系统得到准确的统计信息，使得 SQL 能够生成正确的执行计划。</p><p>典型的，在一个表中进行了大量数据插入，更新或者删除操作后，键分布可能是不准确的。</p><p>如果键分布不准确，查询优化器可能会选择错误的查询执行计划，这可能会导致严重的性能问题。</p><p>如果你感觉实际执行计划并不是预期的执行计划，执行一次分析表可能会解决问题。</p><p>以下语句分析 Sakila 示例数据库中的 actor表:</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ANALYZE</span> <span class="token keyword">TABLE</span> sakila<span class="token punctuation">.</span><span class="token keyword">user</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+-------------+---------+----------+----------+
| Table       | Op      | Msg_type | Msg_text |
+-------------+---------+----------+----------+
| sakila.user | analyze | status   | OK       |
+-------------+---------+----------+----------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>还可以一个语句中分析多个表</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ANALYZE</span> <span class="token keyword">TABLE</span> sakila<span class="token punctuation">.</span>actor<span class="token punctuation">,</span> sakila<span class="token punctuation">.</span>film<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+--------------+---------+----------+----------+
| Table        | Op      | Msg_type | Msg_text |
+--------------+---------+----------+----------+
| sakila.actor | analyze | status   | OK       |
| sakila.film  | analyze | status   | OK       |
+--------------+---------+----------+----------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="优化表" tabindex="-1"><a class="header-anchor" href="#优化表" aria-hidden="true">#</a> 优化表</h4><p>MySQL 使用 <strong>OPTIMIZE TABLE</strong> 语句优化表，它的主要作用是消除更新或者删除造成空间浪费。</p><p>典型的，在一个表中进行了大量数据更新或者删除操作后，表的物理存储可能变得碎片化。</p><p>最总导致数据库服务器的性能下降。</p><p>以下语句优化 Sakila 示例数据库中的 film 表:</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">OPTIMIZE</span> <span class="token keyword">TABLE</span> sakila<span class="token punctuation">.</span>actor<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+-------------+----------+----------+----------+
| Table       | Op       | Msg_type | Msg_text |
+-------------+----------+----------+----------+
| sakila.film | optimize | status   | OK       |
+-------------+----------+----------+----------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果一个表不支持优化，MySQL 会给出一个 note 提示</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>Table does not support optimize, doing recreate + analyze instead。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h5 id="检查表" tabindex="-1"><a class="header-anchor" href="#检查表" aria-hidden="true">#</a> 检查表</h5><p>数据库服务器可能发生一些错误，例如服务器意外关闭、向硬盘写入数据时出错等。</p><p>这些情况可能导致数据库运行不正确，最坏的情况可能是崩溃。</p><p>MySQL 允许您使用 <strong>CHECK TABLE</strong> 语句检查数据库表的完整性。</p><p>以下语句检查 Sakila 示例数据库中的 <strong>actor</strong> 表:</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CHECK</span> <span class="token keyword">TABLE</span> sakila<span class="token punctuation">.</span>actor<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+--------------+-------+----------+----------+
| Table        | Op    | Msg_type | Msg_text |
+--------------+-------+----------+----------+
| sakila.actor | check | status   | OK       |
+--------------+-------+----------+----------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>CHECK TABLE</strong> 语句仅检测数据库表中的问题，但不会修复它们。</p><p>要修复表，使用 <strong>REPAIR TABLE</strong> 语句。</p><h5 id="修复表" tabindex="-1"><a class="header-anchor" href="#修复表" aria-hidden="true">#</a> 修复表</h5><p><strong>REPAIR TABLE</strong> 语句允许您修复数据库表中发生的一些错误。</p><p>MySQL 不保证 <strong>REPAIR TABLE</strong> 语句可以修复表可能存在的所有错误。</p><p><strong>REPAIR TABLE</strong> 只支持 MyISAM 引擎。否则会给出提示</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>The storage engine for the table doesn’t support repair。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>以下语句检查 Sakila 示例数据库中的 <strong>actor</strong> 表:</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>REPAIR <span class="token keyword">TABLE</span> sakila<span class="token punctuation">.</span>actor<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+--------------+--------+----------+---------------------------------------------------------+
| Table        | Op     | Msg_type | Msg_text                                                |
+--------------+--------+----------+---------------------------------------------------------+
| sakila.actor | repair | note     | The storage engine for the table doesn&#39;t support repair |
+--------------+--------+----------+---------------------------------------------------------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里，由于数据引擎为 <strong>InnoDB</strong>，因此 MySQL 返回了提示。</p><h3 id="备份数据库" tabindex="-1"><a class="header-anchor" href="#备份数据库" aria-hidden="true">#</a> 备份数据库</h3><p>以下命令使用 mysqldump <strong>从 MySQL 服务器备份单个数据库</strong>：</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>mysqldump <span class="token comment">--user=&lt;username&gt; --password=&lt;password&gt; --result-file=&lt;path_to_backup_file&gt; --databases &lt;database_name&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li><strong><code>&lt;username&gt;</code></strong> 是登录到 MySQL 服务器的用户帐户。</li><li><strong><code>&lt;password&gt;</code></strong> 是 <strong><code>&lt;username&gt;</code></strong> 的密码。</li><li><strong><code>&lt;path_to_backup_file&gt;</code></strong> 是备份文件的路径。</li><li><strong><code>&lt;database_name&gt;</code></strong> 是你要备份的数据库的名称。如果要备份多个数据库，请用逗号分隔多个数据库的名字。</li></ul><p><strong>mysqldump</strong> 工具提供了许多选项以支持各种不同的导出需求。</p><h4 id="mysqldump-命令常用选项" tabindex="-1"><a class="header-anchor" href="#mysqldump-命令常用选项" aria-hidden="true">#</a> mysqldump 命令常用选项</h4><ul><li><p><strong>--user</strong>：登录用户名。</p></li><li><p><strong>--password</strong>：登录用户名的密码。</p></li><li><p><strong>--host</strong>：MySQL 数据库服务器的 IP 地址或主机名。默认为 <strong>127.0.0.1</strong> 或 <strong>localhost</strong>。</p></li><li><p><strong>--port</strong>：MySQL 数据库服务器的端口号。默认为 <strong>3306</strong>。</p></li><li><p><strong>--add-drop-table</strong>：为数据库中的每个表包括一条 <strong>DROP TABLE</strong> 语句。</p></li><li><p><strong>--add-locks</strong>：在每个 <strong>INSERT</strong>语句之前和之后分别包含<strong>LOCK TABLES和UNLOCK TABLES</strong>语句。</p><ul><li>它提高了从转储文件恢复数据的速度。</li></ul></li><li><p><strong>--all-databases</strong>：创建 MySQL 服务器上所有数据库的转储。</p></li><li><p><strong>--create-options</strong>：在每个表的<strong>CREATE TABLE</strong>语句中包含 <strong>ENGINE</strong> 和 <strong>CHARSET</strong> 选项。</p></li><li><p><strong>--databases</strong>：定制要导出的一个或多个数据库。</p></li><li><p><strong>--disable-keys</strong>：指示 MySQL 在 MyISAM 表的数据加载期间禁用索引更新。</p><ul><li>MySQL 将在 mysqldump 完成加载数据后创建索引。此选项可提高恢复速度。</li></ul></li><li><p><strong>--extended-insert</strong>：将插入单行的 <strong>INSERT</strong> 语句组合成一个插入多个表行的语句；</p><ul><li>此选项还有助于加快数据恢复速度。</li></ul></li><li><p><strong>--flush-logs</strong>：在转储数据之前刷新服务器日志。这在与增量备份结合使用时很有用。</p></li><li><p><strong>--lock-tables</strong>：通过在转储期间锁定数据库中的所有表，确保转储是一致的快照。</p></li><li><p><strong>--no-data</strong>：仅生成重新创建数据库结构所需的语句（仅 CREATE DATABASE, CREATE TABLE …）</p><ul><li>不包含插入数据的语句（<strong>INSERT</strong> 语句）</li></ul></li><li><p><strong>--opt</strong>：<strong>mysqldump</strong> 工具默认使用的选项。</p><ul><li><p><strong>--opt</strong> 选项启用了下列选项</p><ul><li><strong>--add-drop-table</strong></li><li><strong>--add-locks</strong></li><li><strong>--create-options</strong></li><li><strong>--disable-keys</strong></li><li><strong>--extended-insert</strong></li><li><strong>--lock-tables</strong></li><li><strong>--quick</strong></li><li><strong>--set-charset</strong></li></ul></li><li><p>要禁用此选项，使用 <strong>skip-opt</strong></p></li><li><p>如果要跳过每个单独的选项，请使用 <strong>skip-&lt;option_name&gt;</strong></p><ul><li>例如，要跳过 <strong>disable-keys</strong> 选项，请使用 <strong>skip-disable-keys</strong>。</li></ul></li></ul></li><li><p><strong>--quick</strong>：指示 mysqldump 在写入文件之前不在内存中缓冲表。此选项可加快大表的转储速度。</p></li><li><p><strong>--result-file</strong>：指定输出转储文件的路径。</p></li><li><p><strong>--set-charset</strong>：指定数据库的字符集。</p></li><li><p><strong>--tables</strong>：创建一个或多个表的转储。</p></li><li><p><strong>--where</strong>：仅转储满足 WHERE子句中条件的行。</p></li></ul><h4 id="mysqldump-实例" tabindex="-1"><a class="header-anchor" href="#mysqldump-实例" aria-hidden="true">#</a> mysqldump 实例</h4><ol><li>使用 <strong>mysqldump</strong> 备份全部数据库</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">--user</span><span class="token operator">=</span>root <span class="token parameter variable">--password</span><span class="token operator">=</span>password <span class="token parameter variable">--all_databases</span> --result-file<span class="token operator">=</span>/bak/all.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>这里将全部数据库备份到 <strong>/bak/all.sql</strong> 文件中。</p></blockquote><ol start="2"><li>使用 <strong>mysqldump</strong> 备份单个数据库</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">--user</span><span class="token operator">=</span>root <span class="token parameter variable">--password</span><span class="token operator">=</span>password <span class="token parameter variable">--databases</span> sakila --result-file<span class="token operator">=</span>/bak/sakila.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>这里将 <strong>sakila</strong> 数据库备份到 <strong>/bak/sakila.sql</strong> 文件中。</p></blockquote><ol start="3"><li>使用 <strong>mysqldump</strong> 备份多个数据库</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">--user</span><span class="token operator">=</span>root <span class="token parameter variable">--password</span><span class="token operator">=</span>password <span class="token parameter variable">--databases</span> sakila sqlizdb --result-file<span class="token operator">=</span>/bak/sakila_sqlizdb.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>这里将 <strong>sakila</strong> 和 <strong>sqlizdb</strong> 数据库备份到 <strong>/bak/sakila_sqlizdb.sql</strong> 文件中。</p></blockquote><ol start="4"><li>使用 <strong>mysqldump</strong> 备份数据库的结构</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysqldump <span class="token parameter variable">--user</span><span class="token operator">=</span>root <span class="token parameter variable">--password</span><span class="token operator">=</span>password --no-data <span class="token parameter variable">--databases</span> sakila --result-file<span class="token operator">=</span>/bak/sakila.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>这里将 <strong>sakila</strong> 数据库的结构备份到 <strong>/bak/sakila.sql</strong> 文件中。</p><p>同样，如果您只需要备份数据，请使用 <strong>--no-create-info</strong> 代替 <strong>--no-data</strong> 选项。</p></blockquote><h3 id="恢复数据库" tabindex="-1"><a class="header-anchor" href="#恢复数据库" aria-hidden="true">#</a> 恢复数据库</h3><p>恢复备份的SQL文件到MySQL数据库服务器中。</p><p>在执行恢复之前，已将数据备份到<code>/bak/skila.sql</code>文件中</p><h4 id="使用source恢复" tabindex="-1"><a class="header-anchor" href="#使用source恢复" aria-hidden="true">#</a> 使用SOURCE恢复</h4><ol><li>运行以下 <strong>SOURCE</strong> 命令恢复 sakila 数据库：</li></ol><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code>SOURCE <span class="token operator">/</span>bak<span class="token operator">/</span>sakila<span class="token punctuation">.</span><span class="token keyword">sql</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="2"><li>使用 <strong>SHOW DATABASES</strong> 语句查看数据库列表来检查是否已经重新创建数据库：</li></ol><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span> <span class="token keyword">DATABASES</span> <span class="token operator">LIKE</span> <span class="token string">&#39;sakila&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>+-------------------+
| Database (sakila) |
+-------------------+
| sakila            |
+-------------------+
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="使用mysql命令恢复" tabindex="-1"><a class="header-anchor" href="#使用mysql命令恢复" aria-hidden="true">#</a> 使用mysql命令恢复</h4><p><strong>SOURCE</strong> 命令需要登录后才能运行，而 <strong>mysql</strong> 本身就支持直接导入数据。</p><p>使用如下 <strong>mysql</strong> 命令恢复数据库：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mysql <span class="token parameter variable">--user</span><span class="token operator">=</span>root <span class="token parameter variable">--password</span><span class="token operator">=</span><span class="token operator">&lt;</span>password<span class="token operator">&gt;</span> <span class="token operator">&lt;</span> /bak/sakila.sql
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>运行完成后，可以使用 <strong>SHOW DATABASES</strong> 和 <strong>SHOW TABLES</strong> 验证数据库是否已经恢复。</p><hr></div><!--[--><!----><!--]--><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/lgy8888/my_blog.git/edit/main/src/backEnd/MySQL/SQL基础.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><!----><a aria-label="SQL原理" class="vp-link nav-link next nav-link next" href="/my_blog/backEnd/MySQL/SQL%E5%8E%9F%E7%90%86.html"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">SQL原理<span class="font-icon icon iconfont icon-write" style=""></span></div></a></nav><div id="comment" class="giscus-wrapper input-top" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">林光远的个人笔记网站</div><div class="vp-copyright">Copyright © 2024 LGYNB</div></footer></div><!--]--><!----><!--]--></div>
    <script type="module" src="/my_blog/assets/app-OTaO6_y0.js" defer></script>
  </body>
</html>
